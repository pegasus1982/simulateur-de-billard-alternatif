{"version":3,"sources":["lib/kozoom-3d-simulator/src/CaromSimulator/viewSelector.js","lib/kozoom-3d-simulator/src/CaromSimulator/constants.js","lib/kozoom-3d-simulator/src/CaromSimulator/sceneManager/OriginSimulatorEngine/son.js","lib/kozoom-3d-simulator/src/CaromSimulator/sceneManager/OriginSimulatorEngine/evt.js","lib/kozoom-3d-simulator/src/CaromSimulator/sceneManager/OriginSimulatorEngine/simul.js","lib/kozoom-3d-simulator/src/CaromSimulator/sceneManager/OriginSimulatorEngine/parametres.js","lib/kozoom-3d-simulator/src/CaromSimulator/sceneManager/OriginSimulatorEngine/cBillard.js","lib/kozoom-3d-simulator/src/CaromSimulator/sceneManager/index.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/gameevent.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/eventtype.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/utils/utils.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/aimevent.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/input.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/stationaryevent.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/physics/constants.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/physics/physics.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/view/ballmesh.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/ball.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/physics/knuckle.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/physics/pocket.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/view/tablegeometry.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/physics/cushion.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/physics/collision.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/view/cue.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/model/table.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/view/camera.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/view/view.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/utils/rack.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/container.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/controller.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/beginevent.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/end.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/watchaim.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/playshot.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/aim.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/controller/init.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulator/events/keyboard.js","lib/kozoom-3d-simulator/src/CaromSimulator/simulatorEngine.js","lib/kozoom-3d-simulator/src/CaromSimulator/controller/slider.js","lib/kozoom-3d-simulator/src/CaromSimulator/index.js","lib/kozoom-3d-simulator/src/CaromSimulator/controller/index.js","App.js","serviceWorker.js","index.js"],"names":["Component","fileTableModel","fileBatModel","TABLE_LENGTH","BALL_SIZE","INDEX_WHITE_X","INDEX_WHITE_Y","INDEX_YELLOW_X","INDEX_YELLOW_Y","INDEX_TARGET_X","INDEX_TARGET_Y","INDEX_SPEED","INDEX_CUEANGLE","INDEX_CUELINE","INDEX_SIDEENGLISH","INDEX_TOPSPIN","son","Object","classCallCheck","this","played","evt","Simul","param1","param2","_this","delta_fgpas","RSG","fgpas","EPSILON","frpas","QCQ","Rfppas","f1","f2","Rfp","fbille","pas","fp1","ARRET","TSP","fg","fr","choc_bande","_loc_2","NaN","X","XMIN","XMAX","Y","YMIN","YMAX","Vx","Vy","choc12","choc13","_loc_3","_loc_4","nbandes","nb_b_avant","etat","Rp","Rq","VQy","VQx","init_pars","VMz","VT","VRr","VN0","VN","deltaVN","intens","beta_adh","Math","sqrt","VRq","beta_gliss","abs","alpha_bande","PI","atan","VRp","choc_adh","choc_gliss","recup_pars","fin_parcours","_loc_1","Rr","Calcul","console","log","_loc_5","_loc_6","_loc_8","nb_clefs","nb_max_clefs","evts","nb_sons","nb_max_sons","evts_son","Xinit","Yinit","RAp","RApInit","RAq","RAqInit","RAr","RArInit","add_clef","el","er","alph","alphaQ","beta","betaQ","vqueue","Vqueue","calculs_finis","done","distance13","first_bille_choquee","deltaclef","resolution","date","Vinit","cos","R","_loc_7","sin","Vx0","Vy0","_loc_9","p0","q0","r0","temps","intensite","type_choc","choc_billes","_loc_10","mise_a_jour","X0","Y0","RAp0","deltaclefRot","RAq0","RAr0","Xfin","Yfin","RApfin","RAqfin","RArfin","duree","nb3","d13","effet","sorties","parseInt","tan","e_s","eff_s","time","_loc_11","_loc_12","_loc_13","_loc_14","_loc_15","_loc_16","_loc_17","_loc_18","_loc_19","_loc_20","_loc_21","_loc_22","_loc_23","_loc_25","_loc_26","_loc_27","D","_loc_29","_loc_30","RendementChoc","parametres","HBande","direction_beta","param3","asin","atanjimi","ToucheBandeX","long_billard","Quantite","NBILLES","bille_visee","noba","quant","ToucheBandeZ","larg_billard","AlphaQmin","ToucheBille","CBillard","param4","mode_jeu","ralenti","largeur_bandes","change_billard","arret_son","myTimer","stop","taille","bitmap_Bandes_310","visible","bitmap_Billard_310","bitmap_Bandes_280","bitmap_Billard_280","bitmap_Bandes_260","bitmap_Billard_260","ctrl","XC","Ech","longueur","YC","largeur","Params","xmax","ymax","Simulateur","tracer_grille","tracer_lines","Placer_billes_hasard","init_point","afficher_billes","aff_parametres","placer_queue","dq0","queue","calculs_faits","aff_trajets","trajets","graphics","clear","tracer_ligne_visee","ligne_visee","update_modejeu","Vqmax","Simuler","taille_billard","Rb","type","ombre","tous_trajets","trajet_bille_joueur","trajet_bille_visee","billes","ecl","alphamin","ind_last_clef","ampl_recul_max","SceneManager","size","modelStorePath","currentView","ballPositions","controlOptions","drawBallPath","value","res","pathData","length","pathCueWhite","dispose","pathCueYellow","pathTargetBall","whiteBallPoints","i","push","BABYLON","ballRadius","CreateLines","points","scene","yellowBallPoints","colorYellow","colors","redBallPoints","colorRed","configCameras","_self","cameras","arcCam","Zero","attachControl","canvas","upperBetaLimit","wheelPrecision","upperRadiusLimit","lowerRadiusLimit","topCam","lowerBetaLimit","upperAlphaLimit","lowerAlphaLimit","mode","ORTHOGRAPHIC_CAMERA","orthoTop","orthoBottom","orthoLeft","orthoRight","changeView","loadModels","ImportMesh","newMeshes","objects","bat","position","y","z","batLookatPoint","CreateSphere","diameter","visibility","table","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","obj","name","material","bumpTexture","err","return","configCueBalls","updateBat","updateControlOptions","data","cueLine","cueAngle","sideEnglish","topSpin","_this$objects","directionLine","cueBallWhite","deltaSideEnglish","deltaTopSpin","x","rotation","lookAtPoint","assign","lookAt","generateReflectionMaterial","root","others","probe","index","renderList","reflectionTexture","cubeTexture","reflectivityColor","reflectionFresnelParameters","bias","attachToMesh","carpet","rail","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_this$ballPositions","posCueBallWhite","posCueBallYellow","posTargetBall","matCueBallWhite","diffuseTexture","cueBallYellow","matCueBallYellow","targetBall","matTargetBall","ray","rayHelper","localMeshDirection","configGrids","color","gridPoints","grids","toggleGrids","initializeScene","clearColor","Up","getEngine","runRenderLoop","render","animateBalls","addEventListener","onPointerDown","onPointerUp","onPointerMove","getGroundPosition","pickinfo","pick","pointerX","pointerY","mesh","hit","pickedPoint","button","pickInfo","currentMesh","pickedMesh","startingPoint","setTimeout","detachControl","current","moveAndRotateBall","t","tmp","t0","Rx","Ry","Rz","rotate","WORLD","Z","_this$objects2","Date","getTime","res1","res2","res3","playSimulation","initBallPosition","_this$objects3","billard","speed","batContactLine","timerCount","view","activeCamera","GameEvent","createClass","key","controller","EventType","BEGIN","WATCHAIM","AIM","HIT","STATIONARY","CHAT","ABORT","REPOSITION","zero","Vector3","up","vec","v","upCross","clone","cross","norm","normalize","passesThroughZero","dv","add","dot","AimEvent","pos","dir","verticalOffset","sideOffset","angle","power","handleAim","fromJson","json","event","Input","StationaryEvent","_GameEvent","possibleConstructorReturn","getPrototypeOf","call","inherits","handleStationary","_","mu","g","m","Mz","Mxy","e","surfaceVelocity","w","setZ","sin_a","cos_a","sin_a2","cos_a2","s0","c0","A","B","bounceWithoutSlipX","dw","set","s","k","BallMesh","lineColor","random","initialiseMesh","LineBasicMaterial","linewidth","geometry","Geometry","vertices","line","Line","parent","copy","rvel","Matrix4","identity","makeRotationAxis","applyMatrix","arrow","setDirection","setLength","IcosahedronGeometry","MeshPhongMaterial","emissive","Mesh","castShadow","receiveShadow","ArrowHelper","State","Stationary","Rolling","Sliding","Falling","InPocket","Ball","vel","state","transition","updatePosition","updateVelocity","updateRotation","addScaledVector","inMotion","isRolling","updateVelocityRolling","updateVelocitySliding","sub","multiplyScalar","mag","rollingFull","setStationary","va","sign","sliding","onTable","updateFromSerialised","b","Knuckle","radius","ball","kb","velDotCenters","Cushion","elasticity","knuckle","futurePosition","distanceTo","TableGeometry","knuckles","find","willBounce","Pocket","pocket","pocketCenters","p","willFall","addCushions","cylinder","depth","CylinderGeometry","forEach","pocketCylinder","plane","h","lengthN","pockets","pocketNW","knuckleNE","pocketN","knuckleNW","lengthE","knuckleSW","pocketSW","d","BoxGeometry","tableX","tableY","PX","PY","knuckleInset","knuckleRadius","middleKnuckleInset","middleKnuckleRadius","cornerRadius","middleRadius","pocketS","knuckleSE","pocketNE","pocketSE","wireframe","flatShading","willBounceLongSegment","willBounceShortSegment","left","right","top","bottom","bounceIn","theta","f","applyAxisAngle","rotateApplyUnrotate","Collision","a","updateVelocities","ab","aDotCenters","bDotCenters","Cue","limit","maxPower","aim","initialise","tip","but","makeTranslation","delta","Math2","clamp","min","offset","swing","moveTo","origin","balls","direction","Raycaster","intersectObjects","map","Table","cue","outcome","initialiseBalls","pairs","prepareAdvanceAll","Error","update","_this2","some","pair","prepareAdvancePair","willCollide","collide","bounce","willBounceAny","willFallAny","fall","every","serialise","fromSerialised","Camera","aspectRatio","topView","topViewPoint","camera","PerspectiveCamera","lerp","cueBallPos","View","element","Scene","renderer","WebGLRenderer","initialiseScene","offsetWidth","offsetHeight","addCamera","addLights","addTable","width","height","setSize","shadowMap","enabled","PCFSoftShadowMap","appendChild","domElement","light","DirectionalLight","shadow","near","far","mapSize","AmbientLight","addToScene","Rack","noise","across","gap","diagonal","diamond","cueBall","jitter","cushion3","Container","inputQueue","eventQueue","last","performance","now","step","addMesh","updateController","Init","elapsed","steps","max","floor","stateBefore","allStationary","advance","input","shift","handleInput","applyToController","timestamp","processEvents","requestAnimationFrame","animate","constructor","Controller","container","BeginEvent","handleBegin","End","_Controller","apply","arguments","WatchAim","scale","PlayShot","isWatch","Aim","pendingState","aimView","rotateAim","adjustHeight","adjustSide","adjustPower","Keyboard","pressed","released","keydown","window","code","stopImmediatePropagation","keyup","addHandlers","keys","filter","test","control","result","document","SimulatorEngine","props","meshPicked","board","onSceneMount","componentDidMount","simulatorDom","controller1","text","keyboard","lastTime","sampleInputs","getEvents","showPath","React","createRef","option","react_default","createElement","ref","style","display","InputSlider","componentWillReceiveProps","setState","updateValue","onUpdate","itemKey","onChangeValue","target","onMinusPressed","currentValue","_this$props","onPlusPressed","_this$props2","_this$props3","containerClass","label","unitDom","className","index_es","icon","faMinus","onClick","flex","textAlign","faPlus","onChange","CaromSimulator","componentWillMount","updateSimulateInfo","info","parseFloat","viewSelectorItemClicked","item","simulator","onToggleShowGrid","showGrid","onToggleShowPath","onPlayPressed","onControlOptionsUpdated","_this$state","simulatorEngine","App","src_CaromSimulator","Boolean","location","hostname","match","ReactDOM","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"oVAE0CA,wBCD7BC,EAAiB,gBACjBC,EAAe,cACfC,EAAe,IAIfC,EAAY,MAiCZC,EAAgB,EAChBC,EAAgB,EAChBC,EAAiB,EACjBC,EAAiB,EACjBC,EAAiB,GACjBC,EAAiB,GACjBC,EAAc,GACdC,EAAiB,GACjBC,EAAgB,GAChBC,EAAoB,GACpBC,EAAgB,GClDRC,EAMjB,SAAAA,IAAgBC,OAAAC,EAAA,EAAAD,CAAAE,KAAAH,GACZG,KAAKC,QAAS,GCPDC,EAQjB,SAAAA,IAAgBJ,OAAAC,EAAA,EAAAD,CAAAE,KAAAE,ICLCC,EAkGjB,SAAAA,EAAaC,EAAQC,GACrB,IAAAC,EAAAN,KAAAF,OAAAC,EAAA,EAAAD,CAAAE,KAAAG,GAAAH,KAlGAO,YAAc,QAkGdP,KAtFAQ,IAAM,EAsFNR,KA9EAS,MAAQ,OA8ERT,KA5EAU,QAAU,IA4EVV,KAtEAW,MAAQ,KAsERX,KArDAY,IAAM,EAqDNZ,KAnDAa,OAAS,MAmDTb,KAlDAc,GAAK,IAkDLd,KAjDAe,GAAK,IAiDLf,KA3CAgB,IAAM,IA2CNhB,KAzCAiB,OAAS,IAyCTjB,KAvCAkB,IAAM,KAuCNlB,KArCAmB,IAAM,GAqCNnB,KA/BAoB,MAAQ,EA+BRpB,KA9BAqB,IAAM,EA8BNrB,KAtBAsB,GAAK,IAsBLtB,KAnBAuB,GAAK,IAmBLvB,KAgHAwB,WAAa,SAACpB,GACV,IAAIqB,EAASC,IACb,GAAIpB,EAAKqB,EAAEvB,GAAUE,EAAKsB,MAAQtB,EAAKqB,EAAEvB,GAAUE,EAAKuB,MAAQvB,EAAKwB,EAAE1B,GAAUE,EAAKyB,MAAQzB,EAAKwB,EAAE1B,GAAUE,EAAK0B,KAEhH,OAAO,EAEX,GAAI1B,EAAKqB,EAAEvB,GAAUE,EAAKsB,MAAQtB,EAAK2B,GAAG7B,GAAU,EAEhD,OAAO,EAEX,GAAIE,EAAKqB,EAAEvB,GAAUE,EAAKuB,MAAQvB,EAAK2B,GAAG7B,GAAU,EAEhD,OAAO,EAEX,GAAIE,EAAKwB,EAAE1B,GAAUE,EAAK0B,MAAQ1B,EAAK4B,GAAG9B,GAAU,EAEhD,OAAO,EAEX,GAAIE,EAAKwB,EAAE1B,GAAUE,EAAKyB,MAAQzB,EAAK4B,GAAG9B,GAAU,EAEhD,OAAO,EAEX,GAAc,GAAVA,KAEKE,EAAK6B,SAAW7B,EAAK8B,QAC1B,CACI,IAAIC,EAAS/B,EACTgC,EAAShC,EAAKiC,QAAU,EAE5B,GADAF,EAAOE,QAAUD,GACZhC,EAAK6B,SAAW7B,EAAK8B,OAC1B,CACQC,EAAS/B,EACTgC,EAAShC,EAAKkC,WAAa,EAC/BH,EAAOG,WAAaF,GA6DhC,OAzDIhC,EAAKmC,KAAKrC,IAAWE,EAAKE,KAE1BF,EAAKoC,GAAGtC,IAAWE,EAAK4B,GAAG9B,GAC3BE,EAAKqC,GAAGvC,GAAUE,EAAK2B,GAAG7B,IAErBE,EAAKmC,KAAKrC,IAAWE,EAAKM,MAE/BN,EAAKoC,GAAGtC,IAAWE,EAAK4B,GAAG9B,GAAUE,EAAKsC,IAAIxC,GAC9CE,EAAKqC,GAAGvC,GAAUE,EAAK2B,GAAG7B,GAAUE,EAAKuC,IAAIzC,IAEjDE,EAAKwC,UAAU1C,GACfE,EAAKyC,IAAMzC,EAAK0C,GAAK1C,EAAK2C,IAC1B3C,EAAK4C,KAAO5C,EAAK6C,GACjB7C,EAAK6C,GAAK7C,EAAK6C,IAAO7C,EAAKI,QAC3BJ,EAAK8C,QAAU9C,EAAK4C,IAAM5C,EAAK6C,GAC/B7C,EAAK+C,OAAS/C,EAAK4C,IAAM,GACrB5C,EAAK+C,OAAS,IAEd/C,EAAK+C,OAAS,GAElB/C,EAAKgD,SAAW,EAAI,EAAIC,KAAKC,KAAKlD,EAAKyC,IAAMzC,EAAKyC,IAAMzC,EAAKmD,IAAMnD,EAAKmD,KACxEnD,EAAKoD,WAAapD,EAAKQ,GAAKR,EAAK8C,QAC7BG,KAAKI,IAAIrD,EAAKyC,KAAO,KAErBzC,EAAKsD,YAAcL,KAAKM,GAAK,EAI7BvD,EAAKsD,YAAcL,KAAKI,IAAIJ,KAAKO,KAAKxD,EAAKmD,IAAMnD,EAAKyC,MAE1DtB,EAAS8B,KAAKI,IAAIrD,EAAKa,IAAMb,EAAK8C,SAC9BG,KAAKI,IAAIrD,EAAKyD,KAAOtC,EAErBnB,EAAKyD,IAAM,EAENzD,EAAKyD,IAAM,EAEhBzD,EAAKyD,IAAMzD,EAAKyD,IAAMtC,EAItBnB,EAAKyD,IAAMzD,EAAKyD,IAAMtC,EAE1BA,EAAS8B,KAAKI,IAAIrD,EAAKS,GAAKT,EAAK8C,SACjC9C,EAAKmD,IAAMnD,EAAKmD,IAAMhC,EAClBnB,EAAKoD,WAAapD,EAAKgD,SAEvBhD,EAAK0D,SAAS5D,GAIdE,EAAK2D,WAAW7D,GAEpBE,EAAK4D,WAAW9D,GAChBE,EAAKuC,IAAIzC,GAAUE,EAAK2B,GAAG7B,GAAUE,EAAKqC,GAAGvC,GAC7CE,EAAKsC,IAAIxC,GAAUE,EAAK4B,GAAG9B,GAAUE,EAAKoC,GAAGtC,GAC7CE,EAAKmC,KAAKrC,GAAUE,EAAKM,KAClB,GA9MXZ,KAiNAmE,aAAe,WACX,IAAIC,EAAS,EAEb,IADAA,EAAS,EACFA,EAAS,GAChB,CACI,GAAI9D,EAAKmC,KAAK2B,IAAW9D,EAAKc,MAC9B,CACI,KAAId,EAAK2B,GAAGmC,GAAU9D,EAAK2B,GAAGmC,GAAU9D,EAAK4B,GAAGkC,GAAU9D,EAAK4B,GAAGkC,GAAU9D,EAAKK,MAAQL,EAAKK,OAqB1F,OAAO,EAnBP,KAAI4C,KAAKI,IAAIrD,EAAK+D,GAAGD,IAAW9D,EAAKO,QAcjC,OADAP,EAAKmC,KAAK2B,GAAU9D,EAAKe,KAClB,EAZPf,EAAKmC,KAAK2B,GAAU9D,EAAKc,MACzB,IAAIK,EAAS,EACbnB,EAAK4B,GAAGkC,GAAU,EAClB9D,EAAK2B,GAAGmC,GAAU3C,EACdA,EAAS,EACbnB,EAAK+D,GAAGD,GAAU,EAClB9D,EAAKqC,GAAGyB,GAAU3C,EAClBnB,EAAKoC,GAAG0B,GAAU3C,EAa9B2C,IAEJ,OAAO,GAlPXpE,KAqPAsE,OAAS,SAAClE,GACNmE,QAAQC,IAAI,YAAapE,GACzB,IAEIqE,EACAC,EAHAjD,EAAS,EACTY,EAAS,EAGTsC,EAASjD,IACTY,EAAS,GAEb,IADAb,EAAS,EACFA,EAAS,GAChB,CAII,IAFAnB,EAAKsE,SAASnD,GAAU,EACxBY,EAAS,EACFA,EAAS/B,EAAKuE,cAGjBvE,EAAKwE,KAAKxE,EAAKuE,aAAepD,EAASY,GAAU,KACjDA,IAEJZ,IAIJ,IAFAnB,EAAKyE,QAAU,EACftD,EAAS,EACFA,EAASnB,EAAK0E,aAGjB1E,EAAK2E,SAASxD,GAAU,KACxBA,IAGJ,IADAA,EAAS,EACFA,EAAS,GAGZnB,EAAKqB,EAAEF,GAAUrB,EAAO8E,MAAMzD,GAC9BnB,EAAKwB,EAAEL,GAAUrB,EAAO+E,MAAM1D,GAC9BnB,EAAK8E,IAAI3D,GAAUrB,EAAOiF,QAAQ5D,GAClCnB,EAAKgF,IAAI7D,GAAUrB,EAAOmF,QAAQ9D,GAClCnB,EAAKkF,IAAI/D,GAAUrB,EAAOqF,QAAQhE,GAClCnB,EAAKoF,SAASjE,GACdA,IAEJnB,EAAKqF,GAAKvF,EAAOuF,GACjBrF,EAAKsF,GAAKxF,EAAOwF,GACjBtF,EAAKuF,KAAOzF,EAAO0F,OACnBxF,EAAKyF,KAAO3F,EAAO4F,MACnB1F,EAAK2F,OAAS7F,EAAO8F,OACrB5F,EAAK6F,eAAgB,EACrB7F,EAAKiC,QAAU,EACfjC,EAAK8F,MAAO,EACZ9F,EAAK+F,WAAa,EAClB/F,EAAKgG,oBAAsB,EAC3BhG,EAAK6B,QAAS,EACd7B,EAAK8B,QAAS,EACd9B,EAAK8F,MAAO,EACZ9F,EAAKiG,UAAYjG,EAAKkG,WACtBlG,EAAKmG,KAAO,EACZnG,EAAKyF,KAAOzF,EAAKyF,KAAOxC,KAAKM,GAC7BvD,EAAKoG,MAAQ,IAAMpG,EAAK2F,OAAS1C,KAAKoD,IAAIrG,EAAKuF,KAAO,KACtDpB,GAAU,EAAInE,EAAKoG,MAAQnD,KAAKoD,IAAIrG,EAAKuF,KAAO,KAAOvF,EAAKsF,GAAKtF,EAAKsG,EAEtE,IAAIC,EAAStD,KAAKM,GAAK,GAGnBc,EAFArE,EAAKuF,KAAOgB,EAEHtD,KAAKM,GAAK,GAAKN,KAAKM,GAAK,EAAIgD,IAAWvG,EAAKuF,KAAOgB,GAIpD,EAEbnC,EAAS,EAAIpE,EAAK2F,OAAS1C,KAAKuD,IAAInC,GAAUrE,EAAKqF,GAAKrF,EAAKsG,EAE7DtG,EAAK2B,GAAG,GAAK3B,EAAKoG,MAAQnD,KAAKoD,IAAIrG,EAAKyF,MACxCzF,EAAKyG,IAAMzG,EAAK2B,GAAG,GACnB3B,EAAK4B,GAAG,GAAK5B,EAAKoG,MAAQnD,KAAKuD,IAAIxG,EAAKyF,MACxCzF,EAAK0G,IAAM1G,EAAK4B,GAAG,GACnB,IAAI+E,EAASxC,EAASlB,KAAKuD,IAAIxG,EAAKyF,MAAQrB,EAASnB,KAAKoD,IAAIrG,EAAKyF,MACnEzF,EAAKoC,GAAG,GAAK+B,EAASlB,KAAKuD,IAAIxG,EAAKyF,MAAQrB,EAASnB,KAAKoD,IAAIrG,EAAKyF,MACnEzF,EAAK4G,GAAKD,EACNA,GAAWxC,EAAUlB,KAAKoD,IAAIrG,EAAKyF,MAAQrB,EAASnB,KAAKuD,IAAIxG,EAAKyF,MACtEzF,EAAKqC,GAAG,IAAO8B,EAAUlB,KAAKoD,IAAIrG,EAAKyF,MAAQrB,EAASnB,KAAKuD,IAAIxG,EAAKyF,MACtEzF,EAAK6G,GAAKF,EACNA,EAAS,EAAI3G,EAAKqF,GAAKrF,EAAKsG,EAAItG,EAAKoG,MASzC,IARApG,EAAK+D,GAAG,GAAK,EAAI/D,EAAKqF,GAAKrF,EAAKsG,EAAItG,EAAKoG,MACzCpG,EAAK8G,GAAKH,EAEV3G,EAAKuC,IAAI,GAAKvC,EAAK2B,GAAG,GAAK3B,EAAKqC,GAAG,GACnCrC,EAAKsC,IAAI,GAAKtC,EAAK4B,GAAG,GAAK5B,EAAKoC,GAAG,GACnCpC,EAAKmC,KAAK,GAAKnC,EAAKM,IAEpBa,EAAS,EACFA,EAAS,GAGZnB,EAAK2B,GAAGR,GAAU,EAClBnB,EAAK4B,GAAGT,GAAU,EAClBnB,EAAKuC,IAAIpB,GAAU,EACnBnB,EAAKsC,IAAInB,GAAU,EACnBnB,EAAKoC,GAAGjB,GAAU,EAClBnB,EAAKqC,GAAGlB,GAAU,EAClBnB,EAAK+D,GAAG5C,GAAU,EAClBnB,EAAKmC,KAAKhB,GAAUnB,EAAKc,MACzBd,EAAKoF,SAASjE,GACdA,IAgBJ,IAdAnB,EAAK2E,SAAS3E,EAAKyE,SAAW,IAAIlF,EAClCS,EAAK2E,SAAS3E,EAAKyE,SAAS9E,QAAS,EACrCK,EAAK2E,SAAS3E,EAAKyE,SAASsC,MAAQ,EACpC/G,EAAK2E,SAAS3E,EAAKyE,SAASuC,UAAYhH,EAAKoG,MAAQ,IAEjDpG,EAAKuF,KAAOtC,KAAKM,GAAK,EAEtBvD,EAAK2E,SAAS3E,EAAKyE,SAASwC,UAAY,EAIxCjH,EAAK2E,SAAS3E,EAAKyE,SAASwC,UAAY,GAGpCjH,EAAK6D,gBAOT,IALA7D,EAAKmG,MAAQ,EACTnG,EAAKkH,YAAYlF,GAGrBb,EAAS,EACFA,EAAS,GAChB,CACI,GAAInB,EAAKmC,KAAKhB,IAAWnB,EAAKc,MAC9B,CACI,GAAId,EAAKkB,WAAWC,GACpB,CACInB,EAAKoF,SAASjE,GACdnB,EAAK2E,SAAS3E,EAAKyE,SAAW,IAAIlF,EAClCS,EAAK2E,SAAS3E,EAAKyE,SAAS9E,QAAS,EACrCK,EAAK2E,SAAS3E,EAAKyE,SAASsC,MAAQ/G,EAAKmG,KAAOnG,EAAKY,IACrDZ,EAAK2E,SAAS3E,EAAKyE,SAASuC,UAAYhH,EAAK+C,OAC7C/C,EAAK2E,SAAS3E,EAAKyE,SAASwC,UAAY,EACpCN,EAAS3G,EAAb,IACImH,EAAUnH,EAAKyE,QAAU,EAC7BkC,EAAOlC,QAAU0C,EAEjBnH,EAAKoH,YAAYjG,IAEjBnB,EAAKoF,SAASjE,IAGlB8B,KAAKI,IAAIrD,EAAKqB,EAAEF,GAAUnB,EAAKqH,GAAGlG,IAAWnB,EAAKiG,WAAahD,KAAKI,IAAIrD,EAAKwB,EAAEL,GAAUnB,EAAKsH,GAAGnG,IAAWnB,EAAKiG,WAAahD,KAAKI,IAAIrD,EAAK8E,IAAI3D,GAAUnB,EAAKuH,KAAKpG,IAAWnB,EAAKwH,cAAgBvE,KAAKI,IAAIrD,EAAKgF,IAAI7D,GAAUnB,EAAKyH,KAAKtG,IAAWnB,EAAKwH,cAAgBvE,KAAKI,IAAIrD,EAAKkF,IAAI/D,GAAUnB,EAAK0H,KAAKvG,IAAWnB,EAAKwH,eAEhUxH,EAAKoF,SAASjE,GAElBA,IAGR,GAAInB,EAAK6D,eACT,CACI7D,EAAK6F,eAAgB,EACrB,IAAS1E,EAAS,EAAGA,EAAS,EAAGA,IAG7BnB,EAAK2H,KAAKxG,GAAUnB,EAAKqB,EAAEF,GAC3BnB,EAAK4H,KAAKzG,GAAUnB,EAAKwB,EAAEL,GAC3BnB,EAAK6H,OAAO1G,GAAUnB,EAAK8E,IAAI3D,GAC/BnB,EAAK8H,OAAO3G,GAAUnB,EAAKgF,IAAI7D,GAC/BnB,EAAK+H,OAAO5G,GAAUnB,EAAKkF,IAAI/D,GAC/BnB,EAAKoF,SAASjE,GAElBnB,EAAKgI,MAAQhI,EAAKmG,KAAOnG,EAAKY,SAI9B,IAAKO,EAAS,EAAGA,EAAS,EAAGA,IAEzBnB,EAAKoF,SAASjE,GAItB,OAAOnB,EAAKwE,MAtahB9E,KAyaA0H,YAAc,SAACtH,GACX,IAAIqB,EAASC,IACTW,EAASX,IACTY,EAASZ,IACT+C,EAAS/C,IACTgD,EAAShD,IAWb,GATgC,GAA5BpB,EAAKgG,sBAELhG,EAAKiI,IAAM,EAAIjI,EAAKgG,oBACpBhG,EAAKkI,IAAMjF,KAAKC,MAAMlD,EAAKqB,EAAE,GAAKrB,EAAKqB,EAAErB,EAAKiI,OAASjI,EAAKqB,EAAE,GAAKrB,EAAKqB,EAAErB,EAAKiI,OAASjI,EAAKwB,EAAE,GAAKxB,EAAKwB,EAAExB,EAAKiI,OAASjI,EAAKwB,EAAE,GAAKxB,EAAKwB,EAAExB,EAAKiI,OAC7IjI,EAAKkI,IAAMlI,EAAK+F,aAEhB/F,EAAK+F,WAAa/F,EAAKkI,MAG3BlI,EAAKmC,KAAKrC,IAAWE,EAAKE,IAC9B,CAEI,IADAiB,EAAS8B,KAAKC,KAAKlD,EAAK2B,GAAG7B,GAAUE,EAAK2B,GAAG7B,GAAUE,EAAK4B,GAAG9B,GAAUE,EAAK4B,GAAG9B,KACpEE,EAAKK,MAClB,CACI,IAAIgE,EAAS,EACbrE,EAAK4B,GAAG9B,GAAU,EAClBE,EAAK2B,GAAG7B,GAAUuE,EACdA,EAAS,EAGb,GAFArE,EAAKqC,GAAGvC,GAAU,EAClBE,EAAKoC,GAAGtC,GAAUuE,EACdpB,KAAKI,IAAIrD,EAAK+D,GAAGjE,IAAWE,EAAKO,OAKjC,OAHAP,EAAKmC,KAAKrC,GAAUE,EAAKc,MACzBd,EAAK+D,GAAGjE,GAAU,EAClBE,EAAKoF,SAAStF,IACP,EAEXE,EAAKmC,KAAKrC,GAAUE,EAAKe,IAEzBf,EAAKmC,KAAKrC,IAAWE,EAAKe,MAE1BgB,EAAS,EAAI/B,EAAKK,MAAQc,EAC1BnB,EAAK2B,GAAG7B,GAAUE,EAAK2B,GAAG7B,GAAUiC,EACpC/B,EAAK4B,GAAG9B,GAAUE,EAAK4B,GAAG9B,GAAUiC,EACpC/B,EAAKoC,GAAGtC,IAAWE,EAAK4B,GAAG9B,GAC3BE,EAAKqC,GAAGvC,GAAUE,EAAK2B,GAAG7B,IAE1BmD,KAAKI,IAAIrD,EAAK+D,GAAGjE,IAAWE,EAAKO,OAEjCP,EAAK+D,GAAGjE,GAAU,EAEbE,EAAK+D,GAAGjE,GAAU,EAEvBE,EAAK+D,GAAGjE,GAAUE,EAAK+D,GAAGjE,GAAUE,EAAKO,OAIzCP,EAAK+D,GAAGjE,GAAUE,EAAK+D,GAAGjE,GAAUE,EAAKO,OAmCjD,GAhCIP,EAAKmC,KAAKrC,IAAWE,EAAKM,OAE1B0B,EAASiB,KAAKC,KAAKlD,EAAKuC,IAAIzC,GAAUE,EAAKuC,IAAIzC,GAAUE,EAAKsC,IAAIxC,GAAUE,EAAKsC,IAAIxC,KACxEE,EAAKC,YAEdD,EAAKmC,KAAKrC,GAAUE,EAAKE,KAIzBiE,GAAWnE,EAAKG,MAASH,EAAKuC,IAAIzC,GAAUkC,EAC5CoC,GAAWpE,EAAKG,MAASH,EAAKsC,IAAIxC,GAAUkC,EAC5ChC,EAAK2B,GAAG7B,GAAUE,EAAK2B,GAAG7B,GAAUqE,EACpCnE,EAAK4B,GAAG9B,GAAUE,EAAK4B,GAAG9B,GAAUsE,EACpCrC,EAAS,EAAI/B,EAAKC,YAAc+B,EAChChC,EAAKuC,IAAIzC,GAAUE,EAAKuC,IAAIzC,GAAUiC,EACtC/B,EAAKsC,IAAIxC,GAAUE,EAAKsC,IAAIxC,GAAUiC,GAE1C/B,EAAKoC,GAAGtC,IAAWE,EAAK4B,GAAG9B,GAAUE,EAAKsC,IAAIxC,GAC9CE,EAAKqC,GAAGvC,GAAUE,EAAK2B,GAAG7B,GAAUE,EAAKuC,IAAIzC,GACzCmD,KAAKI,IAAIrD,EAAK+D,GAAGjE,IAAWE,EAAKO,OAEjCP,EAAK+D,GAAGjE,GAAU,EAEbE,EAAK+D,GAAGjE,GAAU,EAEvBE,EAAK+D,GAAGjE,GAAUE,EAAK+D,GAAGjE,GAAUE,EAAKO,OAIzCP,EAAK+D,GAAGjE,GAAUE,EAAK+D,GAAGjE,GAAUE,EAAKO,QAG7CP,EAAKmC,KAAKrC,IAAWE,EAAKe,IAC9B,CACQsD,EAAS,EACbrE,EAAK4B,GAAG9B,GAAU,EAClBE,EAAK2B,GAAG7B,GAAUuE,EACdA,EAAS,EAGb,GAFArE,EAAKqC,GAAGvC,GAAU,EAClBE,EAAKoC,GAAGtC,GAAUuE,EACdpB,KAAKI,IAAIrD,EAAK+D,GAAGjE,IAAWE,EAAKO,OAIjC,OAFAP,EAAK+D,GAAGjE,GAAU,EAClBE,EAAKmC,KAAKrC,GAAUE,EAAKc,OAClB,EAEPd,EAAK+D,GAAGjE,GAAU,EAElBE,EAAK+D,GAAGjE,GAAUE,EAAK+D,GAAGjE,GAAU,EAAIE,EAAKO,OAI7CP,EAAK+D,GAAGjE,GAAUE,EAAK+D,GAAGjE,GAAU,EAAIE,EAAKO,OAQrD,OALAP,EAAKqB,EAAEvB,GAAUE,EAAKqB,EAAEvB,GAAUE,EAAK2B,GAAG7B,GAAUE,EAAKY,IACzDZ,EAAKwB,EAAE1B,GAAUE,EAAKwB,EAAE1B,GAAUE,EAAK4B,GAAG9B,GAAUE,EAAKY,IACzDZ,EAAK8E,IAAIhF,GAAUE,EAAK8E,IAAIhF,GAAUE,EAAKoC,GAAGtC,GAAUE,EAAKY,IAC7DZ,EAAKgF,IAAIlF,GAAUE,EAAKgF,IAAIlF,GAAUE,EAAKqC,GAAGvC,GAAUE,EAAKY,IAC7DZ,EAAKkF,IAAIpF,GAAUE,EAAKkF,IAAIpF,GAAUE,EAAK+D,GAAGjE,GAAUE,EAAKY,KACtD,GA9hBXlB,KAiiBAiE,WAAa,SAAC7D,GACNE,EAAKyC,IAAM,GAEXzC,EAAK0C,GAAK1C,EAAK0C,GAAK1C,EAAKoD,WAAaH,KAAKoD,IAAIrG,EAAKsD,aACpDtD,EAAK2C,IAAM3C,EAAK2C,IAAM,IAAM3C,EAAKoD,WAAaH,KAAKoD,IAAIrG,EAAKsD,eAI5DtD,EAAK0C,GAAK1C,EAAK0C,GAAK1C,EAAKoD,WAAaH,KAAKoD,IAAIrG,EAAKsD,aACpDtD,EAAK2C,IAAM3C,EAAK2C,IAAM,IAAM3C,EAAKoD,WAAaH,KAAKoD,IAAIrG,EAAKsD,eA1iBpE5D,KA+iBAgE,SAAW,SAAC5D,GACR,IAMIuE,EACAsC,EAPAxF,EAASC,IACTW,EAASX,IACTY,EAASZ,IAETgD,EAAShD,IACTmF,EAASnF,IAGT+F,EAAU,EAGVhG,EAFA8B,KAAKI,IAAIrD,EAAK0C,IAAM,KAEX,GAIA,IAAMO,KAAKM,GAAKN,KAAKO,KAAKxD,EAAK4C,IAAM5C,EAAK0C,IAEvD1C,EAAKmI,MAAQ,IAAMnI,EAAKsG,EAAI,EAAItG,EAAK2C,IAAMM,KAAKC,KAAKlD,EAAK4C,IAAM5C,EAAK4C,IAAM5C,EAAK0C,GAAK1C,EAAK0C,IACtF1C,EAAKmI,QAAU,IAEfnI,EAAKmI,OAAS,MAETnI,EAAKmI,MAAQ,MAElBnI,EAAKmI,MAAQ,OAEblF,KAAKI,IAAIrD,EAAK0C,IAAM,KAIhBX,EAFA/B,EAAKmI,MAAQ,EAEJnI,EAAKoI,QAAQ,KAAcpI,EAAKoI,QAAQ,IAAapI,EAAKoI,QAAQ,MAAepI,EAAKmI,MAAQ,KAI9FnI,EAAKoI,QAAQ,KAAUpI,EAAKoI,QAAQ,IAAapI,EAAKoI,QAAQ,MAAWpI,EAAKmI,MAAQ,KAAO,KAK1GhH,EAAS,IAAM8B,KAAKM,GAAKN,KAAKO,KAAKxD,EAAK4C,IAAM5C,EAAK0C,IACnDyE,EAAUkB,SAASlH,EAAS,IAiB5BY,GAdIC,EAFAhC,EAAKmI,MAAQ,EAEJnI,EAAKoI,QAAQ,EAAIjB,EAAU,IAAMnH,EAAKoI,QAAQ,EAAIjB,EAAU,GAAKnH,EAAKoI,QAAQ,EAAIjB,EAAU,KAAOnH,EAAKmI,MAAQ,KAIhHnI,EAAKoI,QAAQ,EAAIjB,EAAU,IAAMnH,EAAKoI,QAAQ,EAAIjB,EAAU,GAAKnH,EAAKoI,QAAQ,EAAIjB,EAAU,KAAOnH,EAAKmI,MAAQ,KAAO,OAEhInI,EAAKmI,MAAQ,EAEJnI,EAAKoI,QAAQ,GAAKjB,EAAU,GAAK,IAAMnH,EAAKoI,QAAQ,GAAKjB,EAAU,GAAK,GAAKnH,EAAKoI,QAAQ,GAAKjB,EAAU,GAAK,KAAOnH,EAAKmI,MAAQ,KAIlInI,EAAKoI,QAAQ,GAAKjB,EAAU,GAAK,IAAMnH,EAAKoI,QAAQ,GAAKjB,EAAU,GAAK,GAAKnH,EAAKoI,QAAQ,GAAKjB,EAAU,GAAK,KAAOnH,EAAKmI,MAAQ,KAAO,KAE1HnG,GAAU,IAAMb,EAAS,GAAKgG,IAE1DlE,KAAKI,IAAItB,EAAS,IAAM,KAExB/B,EAAK0C,GAAK,EAIV1C,EAAK0C,GAFAX,EAAS,GAEJ/B,EAAK6C,GAAKI,KAAKqF,IAAIvG,EAAS,IAAMkB,KAAKM,KAIrCvD,EAAK6C,GAAMI,KAAKqF,KAAKvG,EAAS,IAAM,IAAMkB,KAAKM,IAE3DN,KAAKI,IAAIrD,EAAK0C,IAAM,KAEhB1C,EAAKmI,MAAQ,EAEbnI,EAAKuI,IAAMvI,EAAKwI,MAAM,KAAcxI,EAAKwI,MAAM,IAAaxI,EAAKwI,MAAM,MAAexI,EAAKmI,MAAQ,KAInGnI,EAAKuI,IAAMvI,EAAKwI,MAAM,KAAcxI,EAAKwI,MAAM,IAAaxI,EAAKwI,MAAM,MAAexI,EAAKmI,MAAQ,KAAO,KAK1GnI,EAAKmI,MAAQ,GAEb/D,EAASpE,EAAKwI,MAAM,EAAIrB,EAAU,IAAMnH,EAAKwI,MAAM,EAAIrB,EAAU,GAAKnH,EAAKwI,MAAM,EAAIrB,EAAU,KAAOnH,EAAKmI,MAAQ,KACnH5B,EAASvG,EAAKwI,MAAM,GAAKrB,EAAU,GAAK,IAAMnH,EAAKwI,MAAM,GAAKrB,EAAU,GAAK,GAAKnH,EAAKwI,MAAM,GAAKrB,EAAU,GAAK,KAAOnH,EAAKmI,MAAQ,OAIrI/D,EAASpE,EAAKwI,MAAM,EAAIrB,EAAU,IAAMnH,EAAKwI,MAAM,EAAIrB,EAAU,GAAKnH,EAAKwI,MAAM,EAAIrB,EAAU,KAAOnH,EAAKmI,MAAQ,KAAO,IAC1H5B,EAASvG,EAAKwI,MAAM,GAAKrB,EAAU,GAAK,IAAMnH,EAAKwI,MAAM,GAAKrB,EAAU,GAAK,GAAKnH,EAAKwI,MAAM,GAAKrB,EAAU,GAAK,KAAOnH,EAAKmI,MAAQ,KAAO,KAEhJnI,EAAKuI,IAAMnE,GAAUmC,EAASnC,GAAU,IAAMjD,EAAS,GAAKgG,IAEhER,GAAU,EAAI3G,EAAK6C,GAAK,EAAI7C,EAAKmD,KAAO,EACxCkB,GAAU,EAAIrE,EAAK0C,GAAK,EAAI1C,EAAKyD,KAAO,EACxCzD,EAAK2C,IAAM,IAAO3C,EAAKuI,IAAMvI,EAAKsG,EAAIrD,KAAKC,KAAKyD,EAASA,EAAStC,EAASA,IAlpB/E3E,KAspBAkE,WAAa,SAAC9D,GACNE,EAAKqB,EAAEvB,GAAUE,EAAKuB,MAAQvB,EAAK2B,GAAG7B,GAAU,IAEhDE,EAAK2B,GAAG7B,IAAWE,EAAK6C,GACxB7C,EAAKqC,GAAGvC,IAAWE,EAAKmD,IACpBnD,EAAK4B,GAAG9B,GAAU,GAElBE,EAAK4B,GAAG9B,GAAUE,EAAK0C,GACvB1C,EAAKoC,GAAGtC,GAAUE,EAAKyD,IACvBzD,EAAK+D,GAAGjE,IAAWE,EAAK2C,MAIxB3C,EAAK4B,GAAG9B,IAAWE,EAAK0C,GACxB1C,EAAKoC,GAAGtC,IAAWE,EAAKyD,IACxBzD,EAAK+D,GAAGjE,GAAUE,EAAK2C,MAG3B3C,EAAKqB,EAAEvB,GAAUE,EAAKsB,MAAQtB,EAAK2B,GAAG7B,GAAU,IAEhDE,EAAK2B,GAAG7B,GAAUE,EAAK6C,GACvB7C,EAAKqC,GAAGvC,GAAUE,EAAKmD,IACnBnD,EAAK4B,GAAG9B,GAAU,GAElBE,EAAK4B,GAAG9B,GAAUE,EAAK0C,GACvB1C,EAAKoC,GAAGtC,GAAUE,EAAKyD,IACvBzD,EAAK+D,GAAGjE,GAAUE,EAAK2C,MAIvB3C,EAAK4B,GAAG9B,IAAWE,EAAK0C,GACxB1C,EAAKoC,GAAGtC,IAAWE,EAAKyD,IACxBzD,EAAK+D,GAAGjE,IAAWE,EAAK2C,MAG5B3C,EAAKwB,EAAE1B,GAAUE,EAAKyB,MAAQzB,EAAK4B,GAAG9B,GAAU,IAEhDE,EAAK4B,GAAG9B,GAAUE,EAAK6C,GACvB7C,EAAKoC,GAAGtC,IAAWE,EAAKmD,IACpBnD,EAAK2B,GAAG7B,GAAU,GAElBE,EAAK2B,GAAG7B,GAAUE,EAAK0C,GACvB1C,EAAKqC,GAAGvC,IAAWE,EAAKyD,IACxBzD,EAAK+D,GAAGjE,IAAWE,EAAK2C,MAIxB3C,EAAK2B,GAAG7B,IAAWE,EAAK0C,GACxB1C,EAAKqC,GAAGvC,GAAUE,EAAKyD,IACvBzD,EAAK+D,GAAGjE,GAAUE,EAAK2C,MAG3B3C,EAAKwB,EAAE1B,GAAUE,EAAK0B,MAAQ1B,EAAK4B,GAAG9B,GAAU,IAEhDE,EAAK4B,GAAG9B,IAAWE,EAAK6C,GACxB7C,EAAKoC,GAAGtC,GAAUE,EAAKmD,IACnBnD,EAAK2B,GAAG7B,GAAU,GAElBE,EAAK2B,GAAG7B,GAAUE,EAAK0C,GACvB1C,EAAKqC,GAAGvC,IAAWE,EAAKyD,IACxBzD,EAAK+D,GAAGjE,GAAUE,EAAK2C,MAIvB3C,EAAK2B,GAAG7B,IAAWE,EAAK0C,GACxB1C,EAAKqC,GAAGvC,GAAUE,EAAKyD,IACvBzD,EAAK+D,GAAGjE,IAAWE,EAAK2C,OAxtBpCjD,KA8tBA8C,UAAY,SAAC1C,GACLE,EAAKqB,EAAEvB,GAAUE,EAAKuB,MAAQvB,EAAK2B,GAAG7B,GAAU,IAEhDE,EAAK6C,IAAM7C,EAAK2B,GAAG7B,GACnBE,EAAKmD,KAAOnD,EAAKqC,GAAGvC,GAChBE,EAAK4B,GAAG9B,GAAU,GAElBE,EAAK0C,GAAK1C,EAAK4B,GAAG9B,GAClBE,EAAKyD,IAAMzD,EAAKoC,GAAGtC,GACnBE,EAAK2C,KAAO3C,EAAK+D,GAAGjE,KAIpBE,EAAK0C,IAAM1C,EAAK4B,GAAG9B,GACnBE,EAAKyD,KAAOzD,EAAKoC,GAAGtC,GACpBE,EAAK2C,IAAM3C,EAAK+D,GAAGjE,KAGvBE,EAAKqB,EAAEvB,GAAUE,EAAKsB,MAAQtB,EAAK2B,GAAG7B,GAAU,IAEhDE,EAAK6C,GAAK7C,EAAK2B,GAAG7B,GAClBE,EAAKmD,IAAMnD,EAAKqC,GAAGvC,GACfE,EAAK4B,GAAG9B,GAAU,GAElBE,EAAK0C,GAAK1C,EAAK4B,GAAG9B,GAClBE,EAAKyD,IAAMzD,EAAKoC,GAAGtC,GACnBE,EAAK2C,IAAM3C,EAAK+D,GAAGjE,KAInBE,EAAK0C,IAAM1C,EAAK4B,GAAG9B,GACnBE,EAAKyD,KAAOzD,EAAKoC,GAAGtC,GACpBE,EAAK2C,KAAO3C,EAAK+D,GAAGjE,KAGxBE,EAAKwB,EAAE1B,GAAUE,EAAKyB,MAAQzB,EAAK4B,GAAG9B,GAAU,IAEhDE,EAAK6C,GAAK7C,EAAK4B,GAAG9B,GAClBE,EAAKmD,KAAOnD,EAAKoC,GAAGtC,GAChBE,EAAK2B,GAAG7B,GAAU,GAElBE,EAAK0C,GAAK1C,EAAK2B,GAAG7B,GAClBE,EAAKyD,KAAOzD,EAAKqC,GAAGvC,GACpBE,EAAK2C,KAAO3C,EAAK+D,GAAGjE,KAIpBE,EAAK0C,IAAM1C,EAAK2B,GAAG7B,GACnBE,EAAKyD,IAAMzD,EAAKqC,GAAGvC,GACnBE,EAAK2C,IAAM3C,EAAK+D,GAAGjE,KAGvBE,EAAKwB,EAAE1B,GAAUE,EAAK0B,MAAQ1B,EAAK4B,GAAG9B,GAAU,IAEhDE,EAAK6C,IAAM7C,EAAK4B,GAAG9B,GACnBE,EAAKmD,IAAMnD,EAAKoC,GAAGtC,GACfE,EAAK2B,GAAG7B,GAAU,GAElBE,EAAK0C,GAAK1C,EAAK2B,GAAG7B,GAClBE,EAAKyD,KAAOzD,EAAKqC,GAAGvC,GACpBE,EAAK2C,IAAM3C,EAAK+D,GAAGjE,KAInBE,EAAK0C,IAAM1C,EAAK2B,GAAG7B,GACnBE,EAAKyD,IAAMzD,EAAKqC,GAAGvC,GACnBE,EAAK2C,KAAO3C,EAAK+D,GAAGjE,MAhyBhCJ,KAsyBA0F,SAAW,SAACtF,GACR,IACIiC,EAAS/B,EAAKuE,aAAezE,EAASE,EAAKsE,SAASxE,GACxDE,EAAKwE,KAAKzC,GAAU,IAAInC,EACxBI,EAAKwE,KAAKzC,GAAQV,EAAIrB,EAAKqB,EAAEvB,GAC7BE,EAAKwE,KAAKzC,GAAQP,EAAIxB,EAAKwB,EAAE1B,GAC7BE,EAAKwE,KAAKzC,GAAQ+C,IAAM9E,EAAK8E,IAAIhF,GACjCE,EAAKwE,KAAKzC,GAAQiD,IAAMhF,EAAKgF,IAAIlF,GACjCE,EAAKwE,KAAKzC,GAAQmD,IAAMlF,EAAKkF,IAAIpF,GACjCE,EAAKwE,KAAKzC,GAAQ0G,KAAOzI,EAAKmG,KAAOnG,EAAKY,IAC1C,IAAIoB,EAAShC,EAAKsE,SACdH,EAASrE,EACTsE,EAASpC,EAAOlC,GAAU,EAC9BkC,EAAOmC,GAAUC,EACjBpE,EAAKqH,GAAGvH,GAAUE,EAAKqB,EAAEvB,GACzBE,EAAKsH,GAAGxH,GAAUE,EAAKwB,EAAE1B,GACzBE,EAAKuH,KAAKzH,GAAUE,EAAK8E,IAAIhF,GAC7BE,EAAKyH,KAAK3H,GAAUE,EAAKgF,IAAIlF,GAC7BE,EAAK0H,KAAK5H,GAAUE,EAAKkF,IAAIpF,IAxzBjCJ,KA4zBAwH,YAAc,SAACpH,GACX,IAAIiC,EAAS,EACTC,EAAS,EACToC,GAAS,EACTmC,EAASnF,IACTiD,EAASjD,IACTuF,EAASvF,IACT+F,EAAU/F,IACVsH,EAAUtH,IACVuH,EAAUvH,IACVwH,EAAUxH,IACVyH,EAAUzH,IACV0H,EAAU1H,IACV2H,EAAU3H,IACV4H,EAAU5H,IACV6H,EAAU7H,IACV8H,EAAU9H,IACV+H,EAAU/H,IACVgI,EAAUhI,IACViI,EAAUjI,IACVkI,EAAUlI,IAEVmI,EAAUnI,IACVoI,EAAUpI,IACVqI,EAAUrI,IAEVD,GAAS,EACTgD,EAAS,GAEb,IADApC,EAAS,EACFA,EAAS,GAGZoC,EAAOpC,IAAU,EACjBA,IAGJ,IADAA,EAAS,EACFA,EAAS,GAChB,CAEI,IAAKoC,EAAOpC,KAERqC,GAAS,EACTpC,GAAUD,EAAS,GAAK,GACxBwE,GAAUvG,EAAKqB,EAAEU,GAAU/B,EAAKqB,EAAEW,KAAYhC,EAAKqB,EAAEU,GAAU/B,EAAKqB,EAAEW,KAAYhC,EAAKwB,EAAEO,GAAU/B,EAAKwB,EAAEQ,KAAYhC,EAAKwB,EAAEO,GAAU/B,EAAKwB,EAAEQ,KACjIhC,EAAK0J,EAAI1J,EAAK0J,IAAM1J,EAAKmC,KAAKJ,IAAW/B,EAAKc,OAASd,EAAKmC,KAAKH,IAAWhC,EAAKc,SAErFd,EAAK2B,GAAGI,GAAU/B,EAAK2B,GAAGK,KAAYhC,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,KAAY/B,EAAK4B,GAAGG,GAAU/B,EAAK4B,GAAGI,KAAYhC,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,IAAW,IAEpJqC,GAAS,EACTjD,GAAS,EACJnB,EAAK6B,QAAW7B,EAAK8B,QAAoB,GAAVC,IAEhC/B,EAAKgG,oBAAsBhE,GAEjB,GAAVD,GAAyB,GAAVC,IAEfhC,EAAK6B,QAAS,GAEJ,GAAVE,GAAyB,GAAVC,IAEfhC,EAAK8B,QAAS,GAElBhC,EAAO,GAAKiC,EACZjC,EAAO,GAAKkC,GAGfoC,IAEDpC,GAAUD,EAAS,GAAK,GACxBwE,GAAUvG,EAAKqB,EAAEU,GAAU/B,EAAKqB,EAAEW,KAAYhC,EAAKqB,EAAEU,GAAU/B,EAAKqB,EAAEW,KAAYhC,EAAKwB,EAAEO,GAAU/B,EAAKwB,EAAEQ,KAAYhC,EAAKwB,EAAEO,GAAU/B,EAAKwB,EAAEQ,KACjIhC,EAAK0J,EAAI1J,EAAK0J,IAAM1J,EAAKmC,KAAKJ,IAAW/B,EAAKc,OAASd,EAAKmC,KAAKH,IAAWhC,EAAKc,SAErFd,EAAK2B,GAAGI,GAAU/B,EAAK2B,GAAGK,KAAYhC,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,KAAY/B,EAAK4B,GAAGG,GAAU/B,EAAK4B,GAAGI,KAAYhC,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,IAAW,IAEpJqC,GAAS,EACTjD,GAAS,EACJnB,EAAK6B,QAAW7B,EAAK8B,QAAoB,GAAVC,IAEhC/B,EAAKgG,oBAAsBhE,GAEjB,GAAVD,GAAyB,GAAVC,IAEfhC,EAAK6B,QAAS,GAEJ,GAAVE,GAAyB,GAAVC,IAEfhC,EAAK8B,QAAS,GAElBhC,EAAO,GAAKiC,EACZjC,EAAO,GAAKkC,IAIpBoC,GACJ,CACIpE,EAAKoF,SAASrD,GACd/B,EAAKoF,SAASpD,GACdmC,EAAOpC,IAAU,EACb/B,EAAKmC,KAAKJ,IAAW/B,EAAKE,MAE1BF,EAAKoC,GAAGL,IAAW/B,EAAK4B,GAAGG,GAC3B/B,EAAKqC,GAAGN,GAAU/B,EAAK2B,GAAGI,IAE1B/B,EAAKmC,KAAKJ,IAAW/B,EAAKM,MAE1BN,EAAKoC,GAAGL,IAAW/B,EAAK4B,GAAGG,GAAU/B,EAAKsC,IAAIP,GAC9C/B,EAAKqC,GAAGN,GAAU/B,EAAK2B,GAAGI,GAAU/B,EAAKuC,IAAIR,IAE7C/B,EAAKmC,KAAKJ,IAAW/B,EAAKc,QAE1Bd,EAAKoC,GAAGL,GAAU,EAClB/B,EAAKqC,GAAGN,GAAU,GAEtBoC,EAAOnC,IAAU,EACbhC,EAAKmC,KAAKH,IAAWhC,EAAKE,MAE1BF,EAAKoC,GAAGJ,IAAWhC,EAAK4B,GAAGI,GAC3BhC,EAAKqC,GAAGL,GAAUhC,EAAK2B,GAAGK,IAE1BhC,EAAKmC,KAAKH,IAAWhC,EAAKM,MAE1BN,EAAKoC,GAAGJ,IAAWhC,EAAK4B,GAAGI,GAAUhC,EAAKsC,IAAIN,GAC9ChC,EAAKqC,GAAGL,GAAUhC,EAAK2B,GAAGK,GAAUhC,EAAKuC,IAAIP,IAE7ChC,EAAKmC,KAAKH,IAAWhC,EAAKc,QAE1Bd,EAAKoC,GAAGJ,GAAU,EAClBhC,EAAKqC,GAAGL,GAAU,GAGtB2E,GADAqC,EAAUhJ,EAAK2B,GAAGI,IAAW/B,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,IAAW/B,EAAK4B,GAAGG,IAAW/B,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,MACvF/B,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,IAAWwE,EACvDY,EAAU6B,GAAWhJ,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,IAAWwE,EACxDmC,EAAU1I,EAAK2B,GAAGI,GAAU4E,EAC5BgC,EAAU3I,EAAK4B,GAAGG,GAAUoF,EAE5ByB,GADAK,EAAUjJ,EAAK2B,GAAGK,IAAWhC,EAAKqB,EAAEU,GAAU/B,EAAKqB,EAAEW,IAAWhC,EAAK4B,GAAGI,IAAWhC,EAAKwB,EAAEO,GAAU/B,EAAKwB,EAAEQ,MACtFhC,EAAKqB,EAAEU,GAAU/B,EAAKqB,EAAEW,IAAWuE,EACxDsC,EAAUI,GAAWjJ,EAAKwB,EAAEO,GAAU/B,EAAKwB,EAAEQ,IAAWuE,EACxDuC,EAAU9I,EAAK2B,GAAGK,GAAU4G,EAC5BG,EAAU/I,EAAK4B,GAAGI,GAAU6G,EAC5BM,EAAUxC,EAASiC,EACnBQ,EAAUjC,EAAU0B,EACpB7I,EAAK+C,QAAUoG,EAAUA,EAAUC,EAAUA,GAAW,EACpDpJ,EAAK+C,OAAS,IAEd/C,EAAK+C,OAAS,GAElB/C,EAAK2E,SAAS3E,EAAKyE,SAAW,IAAIlF,EAClCS,EAAK2E,SAAS3E,EAAKyE,SAAS9E,QAAS,EACrCK,EAAK2E,SAAS3E,EAAKyE,SAASsC,MAAQ/G,EAAKmG,KAAOnG,EAAKY,IACrDZ,EAAK2E,SAAS3E,EAAKyE,SAASuC,UAAYhH,EAAK+C,OAC7C/C,EAAK2E,SAAS3E,EAAKyE,SAASwC,UAAY,EACxC,IAAI0C,EAAU3J,EACV4J,EAAU5J,EAAKyE,QAAU,EAC7BkF,EAAQlF,QAAUmF,EAClBV,EAAUvC,EACVA,EAASiC,EACTA,EAAUM,EACVN,GAAoB5I,EAAK6J,cACzBlD,GAAkB3G,EAAK6J,cACvBX,EAAU/B,EACVA,EAAU0B,EACVA,EAAUK,EACVL,GAAoB7I,EAAK6J,cACzB1C,GAAoBnH,EAAK6J,cACzB7J,EAAK2B,GAAGI,GAAU4E,EAAS+B,EAC3B1I,EAAK4B,GAAGG,GAAUoF,EAAUwB,EAC5B3I,EAAKuC,IAAIR,GAAU/B,EAAK2B,GAAGI,GAAU/B,EAAKqC,GAAGN,GAC7C/B,EAAKsC,IAAIP,GAAU/B,EAAK4B,GAAGG,GAAU/B,EAAKoC,GAAGL,GACzC/B,EAAKmC,KAAKH,IAAWhC,EAAKc,QAE1Bd,EAAK2B,GAAGK,GAA4B,IAAlBhC,EAAK2B,GAAGK,GAC1BhC,EAAK4B,GAAGI,GAA4B,IAAlBhC,EAAK4B,GAAGI,GAE1BgH,GADA3E,EAASpB,KAAKC,KAAKqD,GAEnByC,EAAU/F,KAAKI,IAAI2F,GACnBQ,EAAUxJ,EAAKW,OAASqI,EACxBK,EAAUpG,KAAKI,IAAIrD,EAAKoC,GAAGL,IAAW/B,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,IAAW/B,EAAKqC,GAAGN,IAAW/B,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,KAAYsC,EAEhIkF,GADWvJ,EAAK2B,GAAGI,IAAW/B,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,IAAW/B,EAAK4B,GAAGG,IAAW/B,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,KAAYsC,EACpGrE,EAAK+D,GAAGhC,GAGxBuH,EAFArG,KAAKI,IAAIkG,GAAW,KAEVtG,KAAKM,GAAK,EAIVN,KAAKI,IAAIJ,KAAKO,KAAK6F,EAAUE,IAU3CE,GARIF,EAAU,EAEA,GAIC,GAEKC,EAAUvG,KAAKoD,IAAIiD,GACvCtJ,EAAK+D,GAAG/B,GAAU,IAAMyH,EACxBzJ,EAAK+D,GAAGhC,GAAU/B,EAAK+D,GAAGhC,GAAU,IAAM0H,EAC1CX,EAAUW,GAAWzJ,EAAKwB,EAAEQ,GAAUhC,EAAKwB,EAAEO,IAAWsC,EACxD0E,GAAYU,GAAYzJ,EAAKqB,EAAEW,GAAUhC,EAAKqB,EAAEU,IAAWsC,GAE/DrE,EAAK2B,GAAGK,GAAU4G,EAAUE,EAC5B9I,EAAK4B,GAAGI,GAAU6G,EAAUE,EAC5B/I,EAAKuC,IAAIP,GAAUhC,EAAK2B,GAAGK,GAAUhC,EAAKqC,GAAGL,GAC7ChC,EAAKsC,IAAIN,GAAUhC,EAAK4B,GAAGI,GAAUhC,EAAKoC,GAAGJ,GAC7ChC,EAAKmC,KAAKH,GAAUhC,EAAKM,IACzBN,EAAKmC,KAAKJ,GAAU/B,EAAKM,IAGjCyB,IAEJ,OAAOZ,GA7gCPzB,KAAK6B,KAAOzB,EACZJ,KAAKgC,KAAO3B,EACZL,KAAK4B,MAAQxB,EACbJ,KAAK+B,MAAQ1B,EACbL,KAAK6E,aAAe,IACpB7E,KAAK4E,SAAW,GAEhB5E,KAAK4E,SAAS,GAAK,EACnB5E,KAAK4E,SAAS,GAFD,EAGb5E,KAAK4E,SAAS,GAHD,EAKb5E,KAAK8E,KAAO,GACZ9E,KAAKgF,YAAc,GACnBhF,KAAK+E,QAAU,EACf/E,KAAKiF,SAAW,GAChBjF,KAAK0I,QAAU,GACf1I,KAAK8I,MAAQ,GACb9I,KAAKyC,KAAO,GACZzC,KAAK2H,GAAK,GACV3H,KAAK4H,GAAK,GACV5H,KAAK2B,EAAI,GACT3B,KAAK8B,EAAI,GACT9B,KAAKiI,KAAO,GACZjI,KAAKkI,KAAO,GACZlI,KAAKoF,IAAM,GACXpF,KAAKsF,IAAM,GACXtF,KAAKwF,IAAM,GACXxF,KAAK6H,KAAO,GACZ7H,KAAK+H,KAAO,GACZ/H,KAAKgI,KAAO,GACZhI,KAAKmI,OAAS,GACdnI,KAAKoI,OAAS,GACdpI,KAAKqI,OAAS,GACdrI,KAAKiC,GAAK,GACVjC,KAAKkC,GAAK,GACVlC,KAAK0C,GAAK,GACV1C,KAAK2C,GAAK,GACV3C,KAAKqE,GAAK,GACVrE,KAAK6C,IAAM,GACX7C,KAAK4C,IAAM,GACX5C,KAAKyC,KAAO,GACZzC,KAAKgK,EAAI,IACThK,KAAK4G,EAAI,IACT5G,KAAKmK,cAAgB,GACrBnK,KAAK8H,aAAe9H,KAAK4G,EAAIrD,KAAKM,GAAK,GACvC7D,KAAKwG,WAAa,IAClBxG,KAAKoG,MAAO,EACZpG,KAAK0I,QAAQ,GAAK,EAClB1I,KAAK0I,QAAQ,GAAK,EAClB1I,KAAK0I,QAAQ,GAAK,EAClB1I,KAAK0I,QAAQ,GAAK,IAClB1I,KAAK0I,QAAQ,GAAK,IAClB1I,KAAK0I,QAAQ,GAAK,IAClB1I,KAAK0I,QAAQ,GAAK,GAClB1I,KAAK0I,QAAQ,GAAK,GAClB1I,KAAK0I,QAAQ,GAAK,GAClB1I,KAAK0I,QAAQ,GAAK,GAClB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,KACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,IACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,IACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,IACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK0I,QAAQ,IAAM,GACnB1I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,GAAK,EAChB9I,KAAK8I,MAAM,GAAK,IAChB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,GAAK,GAChB9I,KAAK8I,MAAM,GAAK,IAChB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,GAAK,GAChB9I,KAAK8I,MAAM,GAAK,IAChB9I,KAAK8I,MAAM,IAAM,GACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,KAAO,GAClB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,KAAO,GAClB9I,KAAK8I,MAAM,IAAM,GACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,IAAM,EACjB9I,KAAK8I,MAAM,IAAM,GACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,IAAM,EACjB9I,KAAK8I,MAAM,IAAM,GACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,KAAO,GAClB9I,KAAK8I,MAAM,IAAM,GACjB9I,KAAK8I,MAAM,IAAM,IACjB9I,KAAK8I,MAAM,KAAO,IAClB9I,KAAK8I,MAAM,IAAM,EACjB9I,KAAK8I,MAAM,IAAM,KClNJsB,EAmBjB,SAAAA,EAAahK,EAAQC,GAAQ,IAAAC,EAAAN,KAAAF,OAAAC,EAAA,EAAAD,CAAAE,KAAAoK,GAAApK,KAf7BqF,QAAU,GAemBrF,KAd7ByF,QAAU,GAcmBzF,KAZ7BuF,QAAU,GAYmBvF,KAT7BkF,MAAQ,GASqBlF,KAR7BmF,MAAQ,GAQqBnF,KAN7BqK,OAAS,KAMoBrK,KAiD7BsK,eAAiB,SAAClK,EAAQC,EAAQkK,GAC9B,IAAIjI,EACAmC,EACAC,EAMJ,OAJAA,EAASnB,KAAKC,MAAMlD,EAAK4E,MAAM,GAAK7E,IAAWC,EAAK4E,MAAM,GAAK7E,IAAWC,EAAK6E,MAAM,GAAKoF,IAAWjK,EAAK6E,MAAM,GAAKoF,IACrHnK,GAAe,IACfkC,EAASiB,KAAKiH,KAAKpK,EAASsE,IAC5BD,EAASnE,EAAKmK,SAASF,EAASjK,EAAK6E,MAAM,GAAI9E,EAASC,EAAK4E,MAAM,KACtD5C,EAASiB,KAAKM,GAEhBY,EAASnC,EAAS,EAAIiB,KAAKM,GAElCY,EAASnC,GAAUiB,KAAKM,GAEjBY,EAASnC,EAAS,EAAIiB,KAAKM,GAE/BY,EAASnC,GAlEStC,KAqE7B0K,aAAe,SAACtK,GAsBZ,IArBA,IACIiC,EAEAoC,EACAC,EACAC,EACAsC,EACAQ,EACAuB,EACAC,EACAC,EACAC,EACAC,EACAC,EAEAE,EAfA9H,EAASC,IAcT4H,EAAU5H,IAOPpB,EAAK0F,MAAQ,GAGhB1F,EAAK0F,MAAQ1F,EAAK0F,MAAQ,EAAIzC,KAAKM,GAEvC,KAAOvD,EAAK0F,OAAS,EAAIzC,KAAKM,IAG1BvD,EAAK0F,MAAQ1F,EAAK0F,MAAQ,EAAIzC,KAAKM,GAgBvC,OAdAsF,EAAU7I,EAAK0F,MACfkD,EAAU9I,EACVkJ,EAAU/F,KAAKoD,IAAIwC,GACnBI,EAAUhG,KAAKuD,IAAIqC,GACnBC,EAAU7F,KAAKoD,IAAIuC,GACnBG,EAAU9F,KAAKuD,IAAIoC,GAEnBjC,IADAgC,EAAU1F,KAAKC,KAAKqD,KAAkBvG,EAAKsF,GAAKtF,EAAKsF,GAAKtF,EAAKqF,GAAKrF,EAAKqF,KACrDyD,EAAU9I,EAAKsF,GAAKyD,GAAWC,EAAUhJ,EAAKqF,GAAK4D,EACvE9B,EAAUwB,EAAUI,EAAU/I,EAAKsF,GAAKwD,EACxCJ,GAAWC,EAAUG,EAAU9I,EAAKsF,GAAKyD,GAAWE,EAAUjJ,EAAKqF,GAAK2D,EACxE7H,EAASnB,EAAK4E,MAAM,GAAK+B,EACzB5E,EA1Ba,IA0BKoF,EACTnH,EAAK6E,MAAM,GAAK6D,EACzBtE,EAASpE,EAAKqK,aAAe,IACzBpH,KAAKI,IAAI2F,GA5BC,QAgCVH,EAAU5F,KAAKM,GAAK,GAAKsF,EAAU,EAAI5F,KAAKM,GAAK,IAEjDyF,GAAWA,EACX7H,GAAUA,MAEdkD,GAAUD,EAASjD,GAAU6H,GApCf,OAyCd7E,EAxCc,KAwCK,KAzCL,IAyCqCE,EAASyE,IACxDzE,EAAS0E,EAAUD,EAAU/G,EAAS/B,EAAK+J,OAAS5F,EAAS2E,MAlIxCpJ,KAyI7ByK,SAAW,SAACrK,EAAQC,GAChB,IAAIgC,EACJ,OAAIkB,KAAKI,IAAItD,GAAU,KAEfD,EAAS,EAEFmD,KAAKM,GAAK,GAEZN,KAAKM,GAAM,GAExBxB,EAASkB,KAAKO,KAAK1D,EAASC,GACxBA,EAAS,EAEFgC,EAEPjC,EAAS,EAEFiC,EAASkB,KAAKM,GAElBxB,EAASkB,KAAKM,KA5JI7D,KA+J7B4K,SAAW,WACP,IACInJ,EADA2C,EAAS,EAET/B,EAAS,GACTC,EAAS,GAIb,IAFAb,EAASnB,EAAK0F,MAAQzC,KAAKM,GAC3BO,EAAS,EACFA,EAAS9D,EAAKuK,SAGjBxI,EAAO+B,IAAU,GACZ9D,EAAK4E,MAAMd,GAAU9D,EAAK4E,MAAM,IAAM3B,KAAKoD,IAAIlF,IAAWnB,EAAK6E,MAAMf,GAAU9D,EAAK6E,MAAM,IAAM5B,KAAKuD,IAAIrF,GAAU,IAEpHa,EAAO8B,IAAW9D,EAAK6E,MAAMf,GAAU9D,EAAK6E,MAAM,IAAM5B,KAAKoD,IAAIlF,IAAWnB,EAAK4E,MAAMd,GAAU9D,EAAK4E,MAAM,IAAM3B,KAAKuD,IAAIrF,GACvHa,EAAO8B,GAAU,KAAc9B,EAAO8B,IAAU,MAEhD/B,EAAO+B,IAAU,IAGzBA,IAEJ9D,EAAKwK,aAAe,EACpB,IAAIpG,EAAS,IAEb,IADAN,EAAS,EACFA,EAAS9D,EAAKuK,SAGbxI,EAAO+B,KAEF9D,EAAK4E,MAAMd,GAAU9D,EAAK4E,MAAM,KAAO5E,EAAK4E,MAAMd,GAAU9D,EAAK4E,MAAM,KAAO5E,EAAK6E,MAAMf,GAAU9D,EAAK6E,MAAM,KAAO7E,EAAK6E,MAAMf,GAAU9D,EAAK6E,MAAM,IAAMT,IAE5JpE,EAAKwK,YAAc1G,EACnBM,GAAUpE,EAAK4E,MAAMd,GAAU9D,EAAK4E,MAAM,KAAO5E,EAAK4E,MAAMd,GAAU9D,EAAK4E,MAAM,KAAO5E,EAAK6E,MAAMf,GAAU9D,EAAK6E,MAAM,KAAO7E,EAAK6E,MAAMf,GAAU9D,EAAK6E,MAAM,KAGvKf,IAYJ,OAVyB,GAArB9D,EAAKwK,aAELxK,EAAKyK,MAAO,EACZzK,EAAK0K,MAAQ1I,EAAOhC,EAAKwK,aAAe,EApC/B,MAwCTxK,EAAKyK,MAAO,EACZzK,EAAK0K,MAAQ,GAEV1K,EAAK0K,OA/MahL,KAkN7BiL,aAAe,SAAC7K,GAuBZ,IAtBA,IACIiC,EAEAoC,EAEAoC,EACAI,EACAQ,EACAuB,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAbAjH,EAASZ,IAcT8H,EAAU9H,IAMPpB,EAAK0F,MAAQ,GAGhB1F,EAAK0F,MAAQ1F,EAAK0F,MAAQ,EAAIzC,KAAKM,GAEvC,KAAOvD,EAAK0F,OAAS,EAAIzC,KAAKM,IAG1BvD,EAAK0F,MAAQ1F,EAAK0F,MAAQ,EAAIzC,KAAKM,GAgBvC,OAdAuF,EAAU9I,EAAK0F,MACfmD,EAAU/I,EACVmJ,EAAUhG,KAAKoD,IAAIyC,GACnBI,EAAUjG,KAAKuD,IAAIsC,GACnBC,EAAU9F,KAAKoD,IAAIwC,GACnBG,EAAU/F,KAAKuD,IAAIqC,GAEnB1B,IADAyB,EAAU3F,KAAKC,KAAKmB,KAAkBrE,EAAKsF,GAAKtF,EAAKsF,GAAKtF,EAAKqF,GAAKrF,EAAKqF,KACpD0D,EAAU/I,EAAKsF,GAAK0D,GAAWC,EAAUjJ,EAAKqF,GAAK6D,EACxER,EAAUE,EAAUI,EAAUhJ,EAAKsF,GAAKyD,EACxCJ,GAAWC,EAAUG,EAAU/I,EAAKsF,GAAK0D,GAAWE,EAAUlJ,EAAKqF,GAAK4D,EAC/DjJ,EAAK4E,MAAM,GAAKuC,EACzBpF,EA1Ba,IA0BK2G,EAClB1G,EAAShC,EAAK6E,MAAM,GAAK8D,EACzBpC,EAASvG,EAAK4K,aAAe,IACzB3H,KAAKI,IAAI6F,GA5BC,QAgCVJ,EAAU7F,KAAKM,KAEf2F,GAAWA,EACXlH,GAAUA,MAEd2E,GAAUJ,EAASvE,GAAUkH,GApCf,OAyCd/E,EAxCc,KAwCK,KAzCL,IAyCqCwC,EAASoC,IACxDpC,EAASqC,EAAUD,EAAUhH,EAAS/B,EAAK+J,OAAS5F,EAAS4E,MAhRxCrJ,KAuR7BmL,UAAY,WAER,IADA,IAAI/G,EAAS,EACN9D,EAAK2K,aAAa7G,IAAW9D,EAAKoK,aAAatG,IAAW9D,EAAK8K,YAAYhH,IAG9EA,GAAkBb,KAAKM,GAAK,GAEhC,OAAOO,GA9RkBpE,KAiS7BoL,YAAc,SAAChL,GACX,IAAIqB,EAASC,IACTW,EAASX,IACTY,EAASZ,IACT+C,EAAS/C,IACTgD,EAAShD,IACTiD,EAASjD,IACTuF,EAASvF,IACT+F,EAAU/F,IAEVyH,EAAUzH,IACV0H,EAAU1H,IACV2H,EAAU3H,IACViI,EAAU,EAOVF,EAAUrJ,EACVsJ,EAAUpJ,EAAK0F,MAEnB,IADA2D,EAAU,EACHA,EAAUrJ,EAAKuK,SACtB,CASI,IAPApJ,EAASnB,EAAK4E,MAAM,GAVV,KAUyB3B,KAAKoD,IAAI+C,GAAWnG,KAAKoD,IAAI8C,GAAWnJ,EAAKqF,GAAKpC,KAAKuD,IAAI4C,GAAWpJ,EAAKsF,GAAKrC,KAAKuD,IAAI2C,GAAWlG,KAAKoD,IAAI+C,GAChJrH,EAAS,IAXC,KAWgBkB,KAAKuD,IAAI2C,GAAWnJ,EAAKsF,GAAKrC,KAAKoD,IAAI8C,GACjEnH,EAAShC,EAAK6E,MAAM,GAZV,KAYyB5B,KAAKuD,IAAI4C,GAAWnG,KAAKoD,IAAI8C,GAAWnJ,EAAKqF,GAAKpC,KAAKoD,IAAI+C,GAAWpJ,EAAKsF,GAAKrC,KAAKuD,IAAI2C,GAAWlG,KAAKuD,IAAI4C,GAChJ/E,EAASrE,EAAK4E,MAAMyE,GACpB1C,EAAS,IACTQ,EAAUnH,EAAK6E,MAAMwE,GACrBjF,EAAS,EACFA,EAhBG,KAiBV,CAOI,GALAD,EAlBM,KAkBa,KAnBb,IAmB6CC,IACnDyE,EAAU1H,EAASiD,EAASnB,KAAKoD,IAAI8C,GAAWlG,KAAKoD,IAAI+C,IAGpC/E,IAAWwE,EAAUxE,KAF1CyE,EAAU/G,EAASqC,EAASnB,KAAKuD,IAAI2C,IAE0BxC,IAAWmC,EAAUnC,KADpFoC,EAAU/G,EAASoC,EAASnB,KAAKoD,IAAI8C,GAAWlG,KAAKuD,IAAI4C,IACgDjC,IAAY4B,EAAU5B,IA1B1H,IA2BmBhD,EA1BlB,OADD,IA2BiDA,EA1BhD,MA4BF,OAAO,EAEXC,GAAkB,IAEtBiF,IAEJ,OAAO,GAjVP,IAAItH,EAAS,EAUb,IATArC,KAAK6K,QAAU,EACf7K,KAAK2K,aAAevK,EACpBJ,KAAKkL,aAAe7K,EACpBL,KAAKkF,MAAQ,GACblF,KAAKmF,MAAQ,GACbnF,KAAKqF,QAAU,GACfrF,KAAKuF,QAAU,GACfvF,KAAKyF,QAAU,GACfpD,EAAS,EACFA,EAAS,GAGZrC,KAAKqF,QAAQhD,GAAU,EACvBrC,KAAKuF,QAAQlD,GAAU,EACvBrC,KAAKyF,QAAQpD,GAAU,EACvBA,IAEJrC,KAAKkF,MAAM,IAAM,IACjBlF,KAAKmF,MAAM,IAAM,MACjBnF,KAAKkF,MAAM,IAAM,IACjBlF,KAAKmF,MAAM,GAAK,EAChBnF,KAAKkF,MAAM,GAAK,IAChBlF,KAAKmF,MAAM,GAAK,EAChBnF,KAAKkG,OAAS,IACdlG,KAAK2F,GAAK,EACV3F,KAAK4F,GAAK,KACV5F,KAAK8F,OAAS,EACd9F,KAAKgG,MAAQ,EAAIzC,KAAKM,GAAK,EAC3B7D,KAAKkG,OAAS,QACdlG,KAAK2F,GAAK,MACV3F,KAAK4F,GAAK,KACV5F,KAAK8F,OAAS,QACd9F,KAAKgG,MAAQ,QACbhG,KAAKkF,MAAM,GAAK,EAChBlF,KAAKmF,MAAM,GAAK,EAChBnF,KAAKkF,MAAM,IAAM,KACjBlF,KAAKmF,MAAM,GAAK,IAChBnF,KAAKkF,MAAM,GAAK,IAChBlF,KAAKmF,MAAM,GAAK,IAChBnF,KAAKkG,OAAS,GACdlG,KAAK2F,GAAK,EACV3F,KAAK4F,GAAK,EACV5F,KAAK8F,OAAS,QACd9F,KAAKgG,OAAS,EAAIzC,KAAKM,GAAK,GC5DfwH,EAwEjB,SAAAA,EAAajL,EAAQC,EAAQkK,EAAQe,GAAQ,IAAAhL,EAAAN,KAAAF,OAAAC,EAAA,EAAAD,CAAAE,KAAAqL,GAAArL,KArE7CuL,SAAW,EAqEkCvL,KA/B7CwL,QAAU,EA+BmCxL,KAhB7CyL,eAAiB,IAgB4BzL,KAuD7C0L,eAAiB,SAACtL,GAGd,GAFAE,EAAKqL,YACLrL,EAAKsL,QAAQC,OACC,GAAVzL,EACJ,CACIE,EAAKwL,OAAO,KACZ,IAAIrK,GAAS,EACbnB,EAAKyL,kBAAkBC,SAAU,EACjC1L,EAAK2L,mBAAmBD,QAAUvK,EAC9BA,GAAS,EACbnB,EAAK4L,kBAAkBF,SAAU,EACjC1L,EAAK6L,mBAAmBH,QAAUvK,EAC9BA,GAAS,EACbnB,EAAK8L,kBAAkBJ,SAAU,EACjC1L,EAAK+L,mBAAmBL,QAAUvK,OAEjC,GAAc,GAAVrB,EACT,CACIE,EAAKwL,OAAO,KACRrK,GAAS,EACbnB,EAAKyL,kBAAkBC,SAAU,EACjC1L,EAAK2L,mBAAmBD,QAAUvK,EAC9BA,GAAS,EACbnB,EAAK4L,kBAAkBF,SAAU,EACjC1L,EAAK6L,mBAAmBH,QAAUvK,EAC9BA,GAAS,EACbnB,EAAK8L,kBAAkBJ,SAAU,EACjC1L,EAAK+L,mBAAmBL,QAAUvK,OAEjC,GAAc,GAAVrB,EACT,CACIE,EAAKwL,OAAO,KACRrK,GAAS,EACbnB,EAAKyL,kBAAkBC,SAAU,EACjC1L,EAAK2L,mBAAmBD,QAAUvK,EAC9BA,GAAS,EACbnB,EAAK4L,kBAAkBF,SAAU,EACjC1L,EAAK6L,mBAAmBH,QAAUvK,EAC9BA,GAAS,EACbnB,EAAK8L,kBAAkBJ,SAAU,EACjC1L,EAAK+L,mBAAmBL,QAAUvK,EAEtCnB,EAAKgM,KAAKC,GAAKjM,EAAKkM,IAAMlM,EAAKmM,SAAW,EAC1CnM,EAAKgM,KAAKI,GAAKpM,EAAKkM,IAAMlM,EAAKqM,QAAU,EACzCrM,EAAKsM,OAAOjC,aAAsC,GAAtBrK,EAAKuM,KAAOvM,EAAKsG,GAC7CtG,EAAKsM,OAAO1B,aAAsC,GAAtB5K,EAAKwM,KAAOxM,EAAKsG,GACtB,MAAnBtG,EAAKyM,aAELzM,EAAKyM,WAAWlL,KAAOvB,EAAKuM,KAC5BvM,EAAKyM,WAAW/K,KAAO1B,EAAKwM,KAC5BxM,EAAKyM,WAAWnL,MAAQtB,EAAKuM,KAC7BvM,EAAKyM,WAAWhL,MAAQzB,EAAKwM,MAEjCxM,EAAK0M,gBACL1M,EAAK2M,eACL3M,EAAK4M,uBACL5M,EAAKsM,OAAO1G,OAAS,EACrB5F,EAAK6M,cAhHoCnN,KAoH7C2L,UAAY,aApHiC3L,KAsH7CmN,WAAa,WACT7M,EAAKqL,YACLrL,EAAKsL,QAAQC,OACbvL,EAAK8M,kBACL9M,EAAKgM,KAAKe,iBACV/M,EAAKgN,aAAahN,EAAKiN,KACvBjN,EAAKkN,MAAMxB,SAAU,EACrB1L,EAAKmN,eAAgB,EACrBnN,EAAKoN,aAAc,EACnBpN,EAAKqN,QAAQC,SAASC,QACtBvN,EAAKwN,qBACLxN,EAAKyN,YAAY/B,SAAU,GAjIchM,KAqI7CgO,eAAiB,SAAC5N,GACdE,EAAKiL,SAAWnL,EAChBE,EAAKqL,YAES,GAAVvL,IAEAE,EAAK2N,MAAQ,KAEH,GAAV7N,IAEAE,EAAK2N,MAAQ,KAEH,GAAV7N,IAEAE,EAAK2N,MAAQ,KAEH,GAAV7N,IAEAE,EAAK2N,MAAQ,KAEH,GAAV7N,IAEAE,EAAK2N,MAAQ,KAEH,GAAV7N,IAEAE,EAAK2N,MAAQ,MA/JwBjO,KAmK7CkO,QAAU,SAAC9N,EAAQC,GAKf,OAHAC,EAAKkL,QAAUpL,EAEfE,EAAKqL,YACErL,EAAKyM,WAAWzI,OAAOjE,IAxKWL,KA2K7C8L,OAAS,SAAC1L,GACNE,EAAK6N,eAAiB/N,EACR,KAAVA,IAEAE,EAAKmM,SAAW,MAEN,KAAVrM,IAEAE,EAAKmM,SAAW,MAEN,KAAVrM,IAEAE,EAAKmM,SAAW,MAEpBnM,EAAKuM,MAAQvM,EAAKmM,SAAWnM,EAAKmL,gBAAkB,EAAI,IACxDnL,EAAKwM,MAAQxM,EAAKmM,SAAWnM,EAAKmL,gBAAkB,EAAI,IACxDnL,EAAKqM,QAAU,GAAKrM,EAAKwM,KAAO,KAAQxM,EAAKmL,gBA1L7C,IAAIhH,EAAS,EACbzE,KAAKwM,IAAMjC,EACXvK,KAAK4G,EAAI,IACT5G,KAAKoO,GAAK,GACVpO,KAAKqO,KAAO,EACZrO,KAAK8L,OAAO1L,GACZJ,KAAK4M,OAAS,IAAIxC,EAAkC,GAAtBpK,KAAK6M,KAAO7M,KAAK4G,GAA+B,GAAtB5G,KAAK8M,KAAO9M,KAAK4G,IAqBzE,IAlBA5G,KAAKsO,MAAQ,GACbtO,KAAK0N,aAAc,EACnB1N,KAAKuO,cAAe,EACpBvO,KAAKwO,qBAAsB,EAC3BxO,KAAKyO,oBAAqB,EAG1BzO,KAAK0O,OAAS,GAEd1O,KAAK8K,YAAc,EACnB9K,KAAK2O,IAAM,GAEX3O,KAAKuN,IAAM,IAAMvN,KAAK4G,EAAI5G,KAAKwM,IAC/BxM,KAAK4O,UAAW,EAChB5O,KAAKiO,MAAQ,IACbjO,KAAK+M,WAAa,IAAI5M,EAAMH,KAAK6M,KAAM7M,KAAK8M,MAC5C9M,KAAK6O,cAAgB,GACrBpK,EAAS,EACFA,EAAS,GAGZzE,KAAK6O,cAAcpK,GAAUzE,KAAK+M,WAAWlI,aAAeJ,EAC5DA,IAUJ,IARAzE,KAAKyN,eAAgB,EAGrBzN,KAAK8O,eAAiB,GACtB9O,KAAK6H,KAAO,GACZ7H,KAAK+H,KAAO,GACZ/H,KAAKgI,KAAO,GACZvD,EAAS,EACFA,EAAS,GAGZzE,KAAK6H,KAAKpD,GAAU,EACpBzE,KAAK+H,KAAKtD,GAAU,EACpBzE,KAAKgI,KAAKvD,GAAU,EACpBA,IAEJzE,KAAK4O,UAAW,EAChBrK,QAAQC,IAAIxE,OCnHC+O,aACjB,SAAAA,EACIC,EACAC,EACAC,EACAC,EACAC,GACF,IAAA9O,EAAAN,KAAAF,OAAAC,EAAA,EAAAD,CAAAE,KAAA+O,GAAA/O,KAiEFqP,aAAe,SAACC,GACZ,IAAIC,EAAMjP,EAAKkP,SAEf,GAAID,GAAqB,GAAdA,EAAIE,SACZnP,EAAKoP,cACJpP,EAAKoP,aAAaC,UAGnBrP,EAAKsP,eACJtP,EAAKsP,cAAcD,UAGpBrP,EAAKuP,gBACJvP,EAAKuP,eAAeF,UAGpBL,GAAO,CAEP,IADA,IAAIQ,EAAkB,GACbC,EAAI,EAAGA,EAAI,IAAOA,IACnBR,EAAIQ,IACJD,EAAgBE,KAAK,IAAIC,UACrBjR,EAAeuQ,EAAIQ,GAAGpO,EAAIrB,EAAK0O,KAC/B1O,EAAK4P,WAAa,EAClBlR,EAAeuQ,EAAIQ,GAAGjO,EAAIxB,EAAK0O,OAI3C1O,EAAKoP,aAAeO,cAAoBE,YACpC,QACA,CACIC,OAAQN,GAEZxP,EAAK+P,OAGT,IAAIC,EAAmB,GACnBC,EAAc,GAClB,IAAKR,EAAI,IAAOA,EAAI,IAAOA,IACnBR,EAAIQ,KACJO,EAAiBN,KAAK,IAAIC,UACtBjR,EAAeuQ,EAAIQ,GAAGpO,EAAIrB,EAAK0O,KAC/B1O,EAAK4P,WAAa,EAClBlR,EAAeuQ,EAAIQ,GAAGjO,EAAIxB,EAAK0O,OAEnCuB,EAAYP,KAAK,IAAIC,SAAe,GAAK,GAAK,EAAG,KAIzD3P,EAAKsP,cAAgBK,cAAoBE,YACrC,QACA,CACIC,OAAQE,EACRE,OAAQD,GAEZjQ,EAAK+P,OAGT,IAAII,EAAgB,GAChBC,EAAW,GAEf,IAAKX,EAAI,IAAOA,EAAI,IAAOA,IACnBR,EAAIQ,KACJU,EAAcT,KAAK,IAAIC,UACnBjR,EAAeuQ,EAAIQ,GAAGpO,EAAIrB,EAAK0O,KAC/B1O,EAAK4P,WAAa,EAClBlR,EAAeuQ,EAAIQ,GAAGjO,EAAIxB,EAAK0O,OAEnC0B,EAASV,KAAK,IAAIC,SAAe,GAAK,EAAG,EAAG,KAIpD3P,EAAKuP,eAAiBI,cAAoBE,YACtC,QACA,CACIC,OAAQK,EACRD,OAAQE,GAEZpQ,EAAK+P,SA9IfrQ,KAmJF2Q,cAAgB,WACZ,IAAMC,EAAQtQ,EACdsQ,EAAMC,QAAQC,OAAS,IAAIb,kBAAwB,aAAc,KAAM,KAAM,IAAKA,UAAgBc,OAAQH,EAAMP,OAChHO,EAAMC,QAAQC,OAAOE,cAAcJ,EAAMK,QACzCL,EAAMC,QAAQC,OAAOI,eAAiB,IACtCN,EAAMC,QAAQC,OAAOK,eAAiB,GAEtCP,EAAMC,QAAQC,OAAOM,iBAAmB,IACxCR,EAAMC,QAAQC,OAAOO,iBAAmB,IAExCT,EAAMC,QAAQS,OAAS,IAAIrB,kBAAwB,cAAe1M,KAAKM,GAAG,EAAG,EAAG,IAAKoM,UAAgBc,OAAQH,EAAMP,OAEnHO,EAAMC,QAAQS,OAAOJ,eAAiB,EACtCN,EAAMC,QAAQS,OAAOC,eAAiB,EAEtCX,EAAMC,QAAQS,OAAOE,iBAAmBjO,KAAKM,GAAG,EAChD+M,EAAMC,QAAQS,OAAOG,iBAAmBlO,KAAKM,GAAG,EAEhD+M,EAAMC,QAAQS,OAAOF,iBAAmB,IACxCR,EAAMC,QAAQS,OAAOD,iBAAmB,IAExCT,EAAMC,QAAQS,OAAOI,KAAOzB,SAAe0B,oBAC3Cf,EAAMC,QAAQS,OAAOM,SAAW,IAChChB,EAAMC,QAAQS,OAAOO,aAAe,IACpCjB,EAAMC,QAAQS,OAAOQ,WAAa,IAClClB,EAAMC,QAAQS,OAAOS,WAAa,IAElCnB,EAAMoB,WAAWpB,EAAM1B,cA9KzBlP,KAiLFiS,WAAa,WACT,IAAMrB,EAAQtQ,EACN2O,EAAmB3O,EAAnB2O,eAERgB,cAAoBiC,WAAW,GAAIjD,EAAgBlQ,EAAc6R,EAAMP,MAAO,SAAU8B,GACpFvB,EAAMwB,QAAQC,IAAMF,EAAU,GAC9BvB,EAAMwB,QAAQC,IAAIC,SAASC,EAAI,GAC/B3B,EAAMwB,QAAQC,IAAIC,SAASE,EAAI,GAE/B5B,EAAMwB,QAAQK,eAAiB,IAAIxC,cAAoByC,aACnD,UACA,CACIC,SAAU,GAEd/B,EAAMP,OAIVO,EAAMwB,QAAQK,eAAeH,SAASC,EAAI,GAC1C3B,EAAMwB,QAAQK,eAAeG,YAAa,EAE1C3C,cAAoBiC,WAAW,GAAIjD,EAAgBnQ,EAAgB8R,EAAMP,MAAO,SAAU8B,GACtFvB,EAAMwB,QAAQS,MAAQV,EAD2E,IAAAW,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAEjG,QAAAC,EAAAC,EAAehB,EAAfiB,OAAAC,cAAAP,GAAAI,EAAAC,EAAAG,QAAAlN,MAAA0M,GAAA,EAAyB,KAAjBS,EAAiBL,EAAA5D,MACL,WAAbiE,EAAIC,OAEHD,EAAIE,SAASC,YAAc,IAAIzD,UAAgBhB,EAAe,kBAAmB2B,EAAMP,SALE,MAAAsD,GAAAZ,GAAA,EAAAC,EAAAW,EAAA,YAAAb,GAAA,MAAAK,EAAAS,QAAAT,EAAAS,SAAA,WAAAb,EAAA,MAAAC,GAUjGpC,EAAMiD,iBACNjD,EAAMkD,UAAUlD,EAAMxB,qBAjNhCpP,KAsNF+T,qBAAuB,SAACC,GACpB1T,EAAK8O,eAAiB4E,EACtB1T,EAAKwT,UAAUE,IAxNjBhU,KA2NF8T,UAAY,SAACE,GAAS,IAEdC,EAIAD,EAJAC,QACAC,EAGAF,EAHAE,SACAC,EAEAH,EAFAG,YACAC,EACAJ,EADAI,QAEGpF,EAAoB1O,EAApB0O,KAAMkB,EAAc5P,EAAd4P,WAPKmE,EAQyC/T,EAAK8R,QAAzDC,EARWgC,EAQXhC,IAAKI,EARM4B,EAQN5B,eAAgB6B,EARVD,EAQUC,cAAeC,EARzBF,EAQyBE,aAEvCC,EAAmBxV,EAAemV,EAAcnF,EAChDyF,EAAezV,EAAeoV,EAAUpF,EAE5CqD,EAAIC,SAASoC,EAAIH,EAAajC,SAASoC,EACpBF,EAAmBjR,KAAKuD,IAAImN,GAC5BQ,EAAelR,KAAKuD,IAAIoN,GAAY3Q,KAAKoD,IAAIsN,GAChE5B,EAAIC,SAASE,EAAI+B,EAAajC,SAASE,EACpBgC,EAAmBjR,KAAKoD,IAAIsN,GAC5BQ,EAAelR,KAAKuD,IAAIoN,GAAY3Q,KAAKuD,IAAImN,GAChE5B,EAAIC,SAASC,EAAIrC,EAAW,EACTuE,EAAelR,KAAKoD,IAAIuN,GAE3C7B,EAAIsC,SAAW,IAAI1E,UACf,GACCgE,EACD1Q,KAAKM,GAAG,EAAIqQ,GAIhB,IAAIU,EAAc9U,OAAO+U,OAAO,GAAIxC,EAAIC,UACxCsC,EAAYrC,GAAK,GAAKhP,KAAKuD,IAAIoN,GAC/BU,EAAYF,GAAK,GAAKnR,KAAKoD,IAAIuN,GAAY3Q,KAAKoD,IAAIsN,GACpDW,EAAYpC,GAAK,GAAKjP,KAAKoD,IAAIuN,GAAY3Q,KAAKuD,IAAImN,GACpDxB,EAAeH,SAAWsC,EAC1BnC,EAAeqC,OAAOzC,EAAIC,UAI1BgC,EAAchC,SAASoC,EAAIH,EAAajC,SAASoC,EACjDJ,EAAchC,SAASE,EAAI+B,EAAajC,SAASE,EACjD8B,EAAchC,SAASC,EAAIrC,EAAW,EAEtCoE,EAAcK,SAASpC,EAAIhP,KAAKM,GAAKoQ,GArQvCjU,KAyQF+U,2BAA6B,SAACC,EAAMC,GAItC,IAJiD,IACtC5E,EAAS/P,EAAT+P,MAEP6E,EAAQ,IAAIjF,kBAAwB,iBAAmB+E,EAAKxB,KAAM,IAAKnD,GAClE8E,EAAQ,EAAGA,EAAQF,EAAOxF,OAAQ0F,IAC1CD,EAAME,WAAWpF,KAAKiF,EAAOE,IAGxBH,EAAKvB,SAAS4B,kBAAoBH,EAAMI,YACxCN,EAAKvB,SAAS8B,kBAAoB,IAAItF,SAAe,GAAK,GAAK,IAErE+E,EAAKvB,SAAS+B,4BAA8B,IAAIvF,oBAC1C+E,EAAKvB,SAAS+B,4BAA4BC,KAAO,EACvDP,EAAMQ,aAAaV,IAtRfhV,KAyRF6T,eAAiB,WACb,IAQI8B,EAAQC,EARNhF,EAAQtQ,EAEV2O,EAEA3O,EAFA2O,eACAiB,EACA5P,EADA4P,WAGI2C,EAAUvS,EAAK8R,QAAfS,MAPWgD,GAQFvV,EAAKuQ,QAAfC,QARY,GAAAgF,GAAA,EAAAC,OAAA9C,EAAA,IAUnB,QAAA+C,EAAAC,EAAepD,EAAfO,OAAAC,cAAAwC,GAAAG,EAAAC,EAAA3C,QAAAlN,MAAAyP,GAAA,EAAsB,KAAdtC,EAAcyC,EAAA1G,MACD,WAAbiE,EAAIC,KACJmC,EAASpC,EACW,gBAAbA,EAAIC,OACXoC,EAAOrC,IAdI,MAAAI,GAAAmC,GAAA,EAAAC,EAAApC,EAAA,YAAAkC,GAAA,MAAAI,EAAArC,QAAAqC,EAAArC,SAAA,WAAAkC,EAAA,MAAAC,GAAA,IAAAG,EAqBf5V,EAAK6O,cAHLgH,EAlBeD,EAkBfC,gBACAC,EAnBeF,EAmBfE,iBACAC,EApBeH,EAoBfG,cAGJzF,EAAMwB,QAAQmC,aAAetE,OAAayC,aAAa,iBAAkB,GAAIxC,EAAYU,EAAMP,OAC/FO,EAAMwB,QAAQmC,aAAajC,SAASC,EAAIrC,EAAW,EACnDU,EAAMwB,QAAQmC,aAAajC,SAASoC,EAAIyB,EAAgBzB,EACxD9D,EAAMwB,QAAQmC,aAAajC,SAASE,EAAI2D,EAAgB3D,EAGxD,IAAI8D,EAAkB,IAAIrG,mBAAyB,SAAUW,EAAMP,OACnEiG,EAAgBC,eAAiB,IAAItG,UAAgBhB,EAAiB,oBAAqB2B,EAAMP,OACjGO,EAAMwB,QAAQmC,aAAad,SAAW6C,EAEtC1F,EAAMwB,QAAQoE,cAAgBvG,OAAayC,aAAa,kBAAmB,GAAIxC,EAAYU,EAAMP,OACjGO,EAAMwB,QAAQoE,cAAclE,SAASC,EAAIrC,EAAW,EACpDU,EAAMwB,QAAQoE,cAAclE,SAASoC,EAAI0B,EAAiB1B,EAC1D9D,EAAMwB,QAAQoE,cAAclE,SAASE,EAAI4D,EAAiB5D,EAE1D,IAAIiE,EAAmB,IAAIxG,mBAAyB,SAAUW,EAAMP,OACpEoG,EAAiBF,eAAiB,IAAItG,UAAgBhB,EAAiB,qBAAsB2B,EAAMP,OACnGO,EAAMwB,QAAQoE,cAAc/C,SAAWgD,EAEvC7F,EAAMwB,QAAQsE,WAAazG,OAAayC,aAAa,eAAgB,GAAIxC,EAAYU,EAAMP,OAC3FO,EAAMwB,QAAQsE,WAAWpE,SAASC,EAAIrC,EAAW,EACjDU,EAAMwB,QAAQsE,WAAWpE,SAASoC,EAAI2B,EAAc3B,EACpD9D,EAAMwB,QAAQsE,WAAWpE,SAASE,EAAI6D,EAAc7D,EAEpD,IAAImE,EAAgB,IAAI1G,mBAAyB,SAAUW,EAAMP,OACjEsG,EAAcJ,eAAiB,IAAItG,UAAgBhB,EAAiB,iBAAkB2B,EAAMP,OAC5FO,EAAMwB,QAAQsE,WAAWjD,SAAWkD,EAEpC/F,EAAMmE,2BAA2BnE,EAAMwB,QAAQmC,aAAc,CAAC3D,EAAMwB,QAAQoE,cAAe5F,EAAMwB,QAAQsE,WAAY9F,EAAMwB,QAAQC,IAAKsD,EAAQC,IAChJhF,EAAMmE,2BAA2BnE,EAAMwB,QAAQoE,cAAe,CAAC5F,EAAMwB,QAAQmC,aAAc3D,EAAMwB,QAAQsE,WAAY9F,EAAMwB,QAAQC,IAAKsD,EAAQC,IAChJhF,EAAMmE,2BAA2BnE,EAAMwB,QAAQsE,WAAY,CAAC9F,EAAMwB,QAAQmC,aAAc3D,EAAMwB,QAAQoE,cAAe5F,EAAMwB,QAAQC,IAAKsD,EAAQC,IAGhJhF,EAAMwB,QAAQwE,IAAM,IAAI3G,MACxBW,EAAMwB,QAAQyE,UAAY,IAAI5G,YAAkBW,EAAMwB,QAAQwE,KAC9D,IAAIE,EAAqB,IAAI7G,UAAgB,EAAG,EAAG,GAGnDW,EAAMwB,QAAQyE,UAAUnB,aAAa9E,EAAMwB,QAAQK,eAAgBqE,IAtVrE9W,KA0VF+W,YAAc,WAIV,IAHA,IAAMnG,EAAQtQ,EAER0W,EAAQ,CAAC,IAAI/G,SADF,SAC4C,GAAI,IAAIA,SADpD,SAC8F,IACtGF,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACzB,IAAIkH,EAAa,CACb,IAAIhH,UAA8B,GAAbjR,EAAe,GAAK+Q,EAAI/Q,EAAa,GAAI,GAAIA,EAAa,GAC/E,IAAIiR,UAA8B,GAAbjR,EAAe,GAAK+Q,EAAI/Q,EAAa,GAAI,EAAGA,EAAa,IAElF4R,EAAMsG,MAAMlH,KAAKC,cAAoBE,YAAY,QAAS,CAACC,OAAQ6G,EAAYzG,OAAQwG,GAAQpG,EAAMP,QAEzG,IAAKN,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACpB,IAAIkH,EAAa,CACb,IAAIhH,WAAiBjR,EAAa,EAAG,EAAiB,GAAbA,EAAe,GAAK+Q,EAAI/Q,EAAa,IAC9E,IAAIiR,UAAgBjR,EAAa,EAAG,EAAiB,GAAbA,EAAe,GAAK+Q,EAAI/Q,EAAa,KAEjF4R,EAAMsG,MAAMlH,KAAKC,cAAoBE,YAAY,QAAS,CAACC,OAAQ6G,EAAYzG,OAAQwG,GAAQpG,EAAMP,UA1W3GrQ,KA8WFmX,YAAc,SAACnL,GAEX,IAFuB,IAChBkL,EAAS5W,EAAT4W,MACEnH,EAAI,EAAGA,EAAImH,EAAMzH,OAAQM,IAC9BmH,EAAMnH,GAAG6C,WAAa5G,GAjX5BhM,KAqXFoX,gBAAkB,SAAC/G,EAAOY,GACtB,IAAIL,EAAQtQ,EACZsQ,EAAMP,MAAQA,EACdO,EAAMK,OAASA,EAEfL,EAAMP,MAAMgH,WAAa,IAAIpH,SAAe,IAAM,IAAM,KACxDW,EAAMwB,QAAQkC,cAAgB,IAAIrE,cAAoBE,YAClD,iBACA,CACIC,OAAQ,CACJ,IAAIH,UAAgB,EAAG,EAAG,GAC1B,IAAIA,UAAgB,IAAK,EAAG,IAEhCO,OAAQ,CACJ,IAAIP,SAAe,EAAG,EAAG,GAAK,GAC9B,IAAIA,SAAe,EAAG,EAAG,GAAK,MAK1C,IAAIA,mBAAyB,QAASA,UAAgBqH,KAAMjH,GAE5DO,EAAMD,gBACNC,EAAMqB,aACNrB,EAAMmG,cAENnG,EAAMP,MAAMkH,YAAYC,cAAc,WAC9BnH,IACAA,EAAMoH,SACN7G,EAAM8G,kBAIdzG,EAAO0G,iBAAiB,cAAe/G,EAAMgH,eAAe,GAC5D3G,EAAO0G,iBAAiB,YAAa/G,EAAMiH,aAAa,GACxD5G,EAAO0G,iBAAiB,cAAe/G,EAAMkH,eAAe,IAxZ9D9X,KA2ZF+X,kBAAoB,WAAM,IACjB1H,EAAS/P,EAAT+P,MACD2H,EAAW3H,EAAM4H,KAAK5H,EAAM6H,SAAU7H,EAAM8H,SAAU,SAAUC,GAAQ,MAAoB,UAAbA,EAAK5E,OACxF,OAAIwE,EAASK,IACFL,EAASM,YAGb,MAlaTtY,KAqaF4X,cAAgB,SAAC1X,GACb,IAAI0Q,EAAQtQ,EACP+P,EAAiB/P,EAAjB+P,MAAOY,EAAU3Q,EAAV2Q,OACZ,GAAmB,IAAf/Q,EAAIqY,OAAR,CAKA,IAAIC,EAAWnI,EAAM4H,KAAK5H,EAAM6H,SAAU7H,EAAM8H,SAAU,SAAUC,GAAO,MAAsB,mBAAdA,EAAK5E,MAA2C,oBAAd4E,EAAK5E,MAA4C,iBAAd4E,EAAK5E,OACzJgF,EAASH,MACTzH,EAAM6H,YAAcD,EAASE,WAC7B9H,EAAM+H,cAAgB/H,EAAMmH,kBAAkB7X,GAE1C0Q,EAAM+H,eACNC,WAAW,WACPhI,EAAMC,QAAQC,OAAO+H,cAAc5H,IACpC,MArbbjR,KA0bF6X,YAAc,WACV,IAAIjH,EAAQtQ,EACPqY,EAAyBrY,EAAzBqY,cAAe1H,EAAU3Q,EAAV2Q,OACpB,GAAI0H,EAIA,OAHA/H,EAAMC,QAAQC,OAAOE,cAAcC,GAAQ,GAC3CL,EAAM+H,cAAgB,UACtB/H,EAAM6H,YAAc,OAhc1BzY,KAqcF8X,cAAgB,SAAC5X,GACb,IAAI0Q,EAAQtQ,EACPqY,EAA8BrY,EAA9BqY,cAAeF,EAAenY,EAAfmY,YACpB,GAAKE,EAAL,CAIA,IAAIG,EAAUlI,EAAMmH,kBAAkB7X,GAEjC4Y,IAILL,EAAYnG,SAAWwG,EACvBL,EAAYnG,SAASC,EAAI3B,EAAMV,WAAW,EAE1CyI,EAAgBG,EAChBlI,EAAMkD,UAAUlD,EAAMxB,mBAtdxBpP,KAueF+Y,kBAAoB,SAACxF,EAAKyF,EAAGC,GACzB,IAGIlJ,EAFAoF,GAAS,EACTvE,EAAQtQ,EAEZ,IAAIyP,EAJQ,IAIJkJ,EAAclJ,EAJV,KAIekJ,EAAM,IAC1BrI,EAAMpB,SAASO,GADuBA,IAGlCa,EAAMpB,SAASO,GAAGhH,KAAQiQ,EAAIpI,EAAMsI,KACnC/D,EAAQpF,GAIpB,GAAGoF,GAAS,EAAE,CACV,GAAIA,GAASpF,EAAE,EACX,OAAO,EAEX,IAAIiE,EAAOpD,EAAMpB,SAAS2F,GAC1B5B,EAAIjB,SAASoC,EAAI1V,EAAegV,EAAKrS,EAAIiP,EAAM5B,KAC/CuE,EAAIjB,SAASE,EAAIxT,EAAegV,EAAKlS,EAAI8O,EAAM5B,KAE/C,IAAI5J,EAAMwL,EAAMpB,SAAS2F,GAAO/P,IAC5BE,EAAMsL,EAAMpB,SAAS2F,GAAO7P,IAC5BE,EAAMoL,EAAMpB,SAAS2F,GAAO3P,IAG5B2T,GAAM/T,EAAMwL,EAAM/I,KAAKoR,IADjB,IAENG,GAAM9T,EAAMsL,EAAM7I,KAAKkR,IAFjB,IAGNI,GAAM7T,EAAMoL,EAAM5I,KAAKiR,IAHjB,IAYV,OAPArI,EAAM/I,KAAKoR,GAAO7T,EAClBwL,EAAM7I,KAAKkR,GAAO3T,EAClBsL,EAAM5I,KAAKiR,GAAOzT,EAElB+N,EAAI+F,OAAOrJ,OAAatO,GAAIwX,EAAIlJ,QAAcsJ,OAC9ChG,EAAI+F,OAAOrJ,OAAanO,GAAIuX,EAAIpJ,QAAcsJ,OAC9ChG,EAAI+F,OAAOrJ,OAAauJ,GAAIJ,EAAInJ,QAAcsJ,QACvC,IA5gBbvZ,KAghBF0X,aAAe,WACX,IAAI9G,EAAQtQ,EADKmZ,EAEiCnZ,EAAK8R,QAAjDmC,EAFWkF,EAEXlF,aAAciC,EAFHiD,EAEGjD,cAAeE,EAFlB+C,EAEkB/C,WACnC,GAAI9F,EAAMpB,UAAqC,GAAzBoB,EAAMpB,SAASC,aACrBwD,GAAZrC,EAAMsI,GAAV,CACA,IAAIF,GAAI,IAAIU,MAAOC,UAAY,IAE3BC,EAAOtZ,EAAKyY,kBAAkBxE,EAAcyE,EAAG,GAC/Ca,EAAOvZ,EAAKyY,kBAAkBvC,EAAewC,EAAG,GAChDc,EAAOxZ,EAAKyY,kBAAkBrC,EAAYsC,EAAG,GACjDzU,QAAQC,IAAIoV,EAAMC,EAAMC,GACZ,GAARF,GAAyB,GAARC,GAAyB,GAARC,IAAelJ,EAAMpB,SAAW,MA3hBxExP,KA8hBF+Z,eAAiB,WACb,IAAInJ,EAAQtQ,EAEL8O,GADe9O,EAAK0Z,iBACF1Z,EAAlB8O,gBAHY6K,EAQf3Z,EAAK8R,QAHLmC,EALe0F,EAKf1F,aACAiC,EANeyD,EAMfzD,cACAE,EAPeuD,EAOfvD,WAEAnH,EAAMjP,EAAK4Z,QAAQhM,QACnB,EACA,CACIhJ,MAAO,CACH0L,EAAM5B,KAAOuF,EAAajC,SAASoC,EAAI1V,EACvC4R,EAAM5B,KAAOwH,EAAclE,SAASoC,EAAI1V,EACxC4R,EAAM5B,KAAO0H,EAAWpE,SAASoC,EAAI1V,GAEzCmG,MAAO,CACHyL,EAAM5B,KAAOuF,EAAajC,SAASE,EAAIxT,EACvC4R,EAAM5B,KAAOwH,EAAclE,SAASE,EAAIxT,EACxC4R,EAAM5B,KAAO0H,EAAWpE,SAASE,EAAIxT,GAEzCqG,QAAS,CAAC,EAAG,EAAG,GAChBE,QAAS,CAAC,EAAG,EAAG,GAChBE,QAAS,CAAC,EAAG,EAAG,GAChBE,GAAIyJ,EAAe+E,YACnBvO,GAAIwJ,EAAegF,QACnBtO,OAAQsJ,EAAe8E,SACvBlO,MAAOoJ,EAAe6E,QACtB/N,OAAOkJ,EAAe+K,QAG9B5V,QAAQC,IAAI+K,GAERA,GAAqB,GAAdA,EAAIE,SAEfnP,EAAKkP,SAAWD,EAEhBjP,EAAK4Y,IAAK,IAAIQ,MAAOC,UAAY,MAnkBjC3Z,KAAKqQ,WAAQ4C,EACbjT,KAAKiR,YAASgC,EAEdjT,KAAKgP,KAAOA,EAEZhP,KAAKkQ,WAAa,IAAMjR,GAAyB,IAAZe,KAAKgP,MAE1ChP,KAAKiP,eAAiBA,EAEtBjP,KAAKga,iBAAmB7K,EACxBnP,KAAKmP,cAAgB,CACjBgH,gBAAiB,CACbzB,EAAG1V,EAAemQ,EAAcgH,gBAAgBzB,EAAI1F,EACpDwD,EAAGxT,EAAemQ,EAAcgH,gBAAgB3D,EAAIxD,GAExDoH,iBAAkB,CACd1B,EAAG1V,EAAemQ,EAAciH,iBAAiB1B,EAAI1F,EACrDwD,EAAGxT,EAAemQ,EAAciH,iBAAiB5D,EAAIxD,GAEzDqH,cAAe,CACX3B,EAAG1V,EAAemQ,EAAckH,cAAc3B,EAAI1F,EAClDwD,EAAGxT,EAAemQ,EAAckH,cAAc7D,EAAIxD,IAI1DhP,KAAKkP,YAAcA,EAEnBlP,KAAK6Q,QAAU,CACXC,YAAQmC,EACR3B,YAAQ2B,GAGZjT,KAAKoS,QAAU,CACXS,WAAOI,EACPZ,SAAKY,EACLsB,kBAActB,EACduD,mBAAevD,EACfyD,gBAAYzD,EACZmH,oBAAgBnH,EAChBR,oBAAgBQ,EAChBqB,mBAAerB,GAGnBjT,KAAKoP,eAAiBA,EAEtBpP,KAAKkX,MAAQ,GAEblX,KAAK0P,kBAAeuD,EACpBjT,KAAK4P,mBAAgBqD,EACrBjT,KAAK6P,oBAAiBoD,EAEtBjT,KAAKka,QAAU,IAAI7O,EACf,SACA4H,EACA,KAGJjT,KAAKqa,WAAa,EAElBra,KAAK6H,KAAO,CAAC,EAAG,EAAG,GACnB7H,KAAK+H,KAAO,CAAC,EAAG,EAAG,GACnB/H,KAAKgI,KAAO,CAAC,EAAG,EAAG,0DA2ZXsS,GAGK,OAATA,GAFUta,KAGJqQ,MAAMkK,aAHFva,KAGuB6Q,QAAQS,OAH/BtR,KAIJ6Q,QAAQC,OAAO+H,cAJX7Y,KAI+BiR,QAJ/BjR,KAKJ6Q,QAAQS,OAAON,cALXhR,KAK+BiR,UAL/BjR,KAOJqQ,MAAMkK,aAPFva,KAOuB6Q,QAAQC,OAP/B9Q,KAQJ6Q,QAAQC,OAAOE,cARXhR,KAQ+BiR,QAR/BjR,KASJ6Q,QAAQS,OAAOuH,cATX7Y,KAS+BiR,kBCnfxCuJ,EAAb,WACE,SAAAA,IAAc1a,OAAAC,EAAA,EAAAD,CAAAE,KAAAwa,GADhB,OAAA1a,OAAA2a,EAAA,EAAA3a,CAAA0a,EAAA,EAAAE,IAAA,oBAAApL,MAAA,SAGoBqL,QAHpBH,EAAA,GCHaI,EAAY,CACvBC,MAAO,EACPC,SAAU,EACVC,IAAK,EACLC,IAAK,EACLC,WAAY,EACZC,KAAM,EACNC,MAAO,EACPC,WAAY,UCNDC,EAAO,IAAIC,IAAQ,EAAG,EAAG,GACzBC,EAAK,IAAID,IAAQ,EAAG,EAAG,GAE7B,SAASE,EAAIC,GAClB,OAAO,IAAIH,IAAQG,EAAE/G,EAAG+G,EAAElJ,EAAGkJ,EAAEjJ,GAG1B,SAASkJ,EAAQD,GACtB,OAAOF,EAAGI,QAAQC,MAAMH,GAGnB,SAASI,EAAKJ,GACnB,OAAOA,EAAEE,QAAQG,YAGZ,SAASC,EAAkBN,EAAGO,GACnC,OACEP,EACGE,QACAM,IAAID,GACJE,IAAIT,IAAM,ECjBV,IAAMU,EAAb,WAQE,SAAAA,IAAcrc,OAAAC,EAAA,EAAAD,CAAAE,KAAAmc,GAAAnc,KAPdoc,IAAM,IAAId,IAAQ,EAAG,EAAG,GAOVtb,KANdqc,IAAM,IAAIf,IAAQ,EAAG,EAAG,GAMVtb,KALdsc,eAAiB,EAKHtc,KAJduc,WAAa,EAICvc,KAHdwc,MAAQ,EAGMxc,KAFdyc,MAAQ,EANV,OAAA3c,OAAA2a,EAAA,EAAA3a,CAAAqc,EAAA,EAAAzB,IAAA,oBAAApL,MAAA,SAaoBqL,GAChB,OAAOA,EAAW+B,UAAU1c,QAdhC,CAAA0a,IAAA,OAAApL,MAAA,WA8BI,OADY6M,EAASQ,SAAS3c,SA7BlC,EAAA0a,IAAA,WAAApL,MAAA,SAiBkBsN,GACd,IAAIC,EAAQ,IAAIV,EAOhB,OANAU,EAAMT,IAAMZ,EAAIoB,EAAKR,KACrBS,EAAMR,IAAMb,EAAIoB,EAAKP,KACrBQ,EAAML,MAAQI,EAAKJ,MACnBK,EAAMP,eAAiBM,EAAKN,eAC5BO,EAAMN,WAAaK,EAAKL,WACxBM,EAAMJ,MAAQG,EAAKH,MACZI,MAzBXV,EAAA,GCLaW,EAIX,SAAAA,EAAY9D,EAAG0B,GAAM5a,OAAAC,EAAA,EAAAD,CAAAE,KAAA8c,GACnB9c,KAAKgZ,EAAIA,EACThZ,KAAK0a,IAAMA,GCFFqC,EAAb,SAAAC,GACE,SAAAD,IAAc,IAAAzc,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAA+c,IACZzc,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAid,GAAAI,KAAAnd,QACKqO,KAAOuM,EAAUK,WAFV3a,EADhB,OAAAR,OAAAsd,EAAA,EAAAtd,CAAAid,EAAAC,GAAAld,OAAA2a,EAAA,EAAA3a,CAAAid,EAAA,EAAArC,IAAA,oBAAApL,MAAA,SAMoBqL,GAChB,OAAOA,EAAW0C,iBAAiBrd,SAPvC,EAAA0a,IAAA,WAAApL,MAAA,SAUkBgO,GAEd,OADY,IAAIP,MAXpBA,EAAA,CAAqCvC,GCJxB+C,EAAK,KACLC,EAAI,IAEJC,EAAI,GACJC,EAAOH,EAAKE,EAAID,EAAI,EAAK,EAFnB,GAGNG,EAAO,GAAK,EAAIpa,KAAKC,KAAK,IAAO+Z,EAAKE,EAAID,EAC1CI,EAAI,GCFV,SAASC,EAAgBpC,EAAGqC,GACjC,OAAOrC,EACJE,QACAM,IAAIP,EAAQoC,IACZC,KAAK,GAgCV,IAAIC,GAAQza,KAAKuD,IAAI,KAAO,MACxBmX,GAAQ1a,KAAKoD,IAAI,KAAO,MAExBuX,GAASF,GAAQA,GACjBG,GAASF,GAAQA,GAUrB,SAASG,GAAG3C,EAAGqC,GACb,OAAO,IAAIxC,IACTG,EAAE/G,EAAIsJ,GAAQvC,EAAEjJ,EAAIyL,GAAQH,EAAEvL,GAC7BkJ,EAAElJ,EAAIuL,EAAEtL,EAAIyL,GAAQH,EAAEpJ,EAAIsJ,IAI/B,SAASK,GAAG5C,GACV,OAAOA,EAAE/G,EAAIuJ,GAAQxC,EAAEjJ,EAAIyL,GAG7B,IAAIK,GAAI,GAAK,EAAIb,GACbc,GAAI,EAAId,EAcL,SAASe,GAAmB/C,EAAGqC,EAAG9B,EAAIyC,GAC3CzC,EAAG0C,KACAjD,EAAE/G,GAAM,EAAI,EAAKwJ,IAAU,EAAIN,GAAKO,IAAW,EAAI,EAAKL,EAAEvL,EAAIyL,GAC9D,EAAI,EAAKvC,EAAElJ,EAAK,EAAI,GAAMuL,EAAEpJ,EAAIsJ,GAAQF,EAAEtL,EAAIyL,IAASxC,EAAElJ,EAC1D,GAGF,IAAIoM,EAAIP,GAAG3C,EAAGqC,GACVc,EAAK,EAAID,EAAEpM,GAAM,EAAIkL,EAAIa,IAE7BG,EAAGC,IACDE,EAAIZ,GACH,GAAK,EAAIP,KACNkB,EAAEjK,EAAI4J,GAAMN,GAAQK,GAAG5C,IAAM,EAAImC,GAAMW,IAAMN,GAAQD,KACzDY,EAAIX,IClFD,IAAMY,GAAb,WAIE,SAAAA,IAAe/e,OAAAC,EAAA,EAAAD,CAAAE,KAAA6e,GACb7e,KAAKqQ,WAAQ4C,EACbjT,KAAK8e,UAAY,CAAC,SAAU,SAAU,MAAS,SAAU,MAAU,UAAUnW,SAAyB,IAAhBpF,KAAKwb,UAAmB,GAC9G/e,KAAKgf,iBACLhf,KAAK8Y,QAAU,CAACpE,EAAG,EAAGnC,EAAG,EAAGC,EAAG,GAC/BxS,KAAKkZ,IAAK,IAAIQ,MAAOC,UATzB,OAAA7Z,OAAA2a,EAAA,EAAA3a,CAAA+e,EAAA,EAAAnE,IAAA,iBAAApL,MAAA,SAYiB8M,GACb,IAAItD,EAAU9Y,KAAKoY,KAAK9F,SAExB,GAAKwG,EAAQpE,GAAK0H,EAAI1H,GAAKoE,EAAQvG,GAAK6J,EAAI7J,GAAKuG,EAAQtG,GAAK4J,EAAI5J,EAAI,CACpE,IAAIwG,GAAI,IAAIU,MAAOC,UAEnB,GADApV,QAAQC,IAAIwU,EAAIhZ,KAAKkZ,IACjBF,EAAIhZ,KAAKkZ,IAAO,KAAM,CACxBlZ,KAAKkZ,GAAKF,EACV,IAAIvF,EAAW,IAAIwL,IAAkB,CACnCjI,MAAOhX,KAAK8e,UACZI,UAAW,KAGTC,EAAW,IAAIC,IACnBD,EAASE,SAASrP,KAChBlQ,OAAO+U,OAAO,GAAIiE,GAClBhZ,OAAO+U,OAAO,GAAIuH,IAGpB,IAAIkD,EAAO,IAAIC,IAAMJ,EAAU1L,GAC/BzT,KAAKoY,KAAKoH,OAAOvD,IAAKqD,IAG1Btf,KAAKoY,KAAK9F,SAASmN,KAAKrD,KAnC5B,CAAA1B,IAAA,iBAAApL,MAAA,SAsCiBoQ,EAAM1G,GACnB,IAAIwD,EAASkD,EAAKjQ,SAAWuJ,EAAIzV,KAAKM,GAAM,EACxC4Z,GAAI,IAAIkC,KAAUC,WAAWC,iBAAiBhE,EAAK6D,GAAOlD,GAC9Dxc,KAAKoY,KAAK+G,SAASW,YAAYrC,GAC/Bzd,KAAK+f,MAAMC,aAAanE,EAAK6D,IAC7B1f,KAAK+f,MAAMzN,SAASmN,KAAKzf,KAAKoY,KAAK9F,UACnCtS,KAAK+f,MAAME,UAA0B,EAAhBP,EAAKjQ,SAAe,MA5C7C,CAAAiL,IAAA,iBAAApL,MAAA,WAgDI,IAAI6P,EAAW,IAAIe,IAAoB,GAAK,GACxCzM,EAAW,IAAI0M,IAAkB,CACnCnJ,MAAOhX,KAAK8e,UACZsB,SAAU,KAEZpgB,KAAKoY,KAAO,IAAIiI,IAAKlB,EAAU1L,GAC/BzT,KAAKoY,KAAKkI,YAAa,EACvBtgB,KAAKoY,KAAKmI,eAAgB,EAC1BvgB,KAAKoY,KAAK5E,KAAO,OACjBxT,KAAK+f,MAAQ,IAAIS,IAAYjF,EAAIF,EAAM,EAAG,YAzD9C,CAAAX,IAAA,aAAApL,MAAA,SA4Dae,GACT9L,QAAQC,IAAI,eAAgB6L,GAC5BA,EAAM4L,IAAIjc,KAAKoY,MACf/H,EAAM4L,IAAIjc,KAAK+f,WA/DnBlB,EAAA,GCFa4B,GAAQ,CACnBC,WAAY,aACZC,QAAS,UACTC,QAAS,UACTC,QAAS,UACTC,SAAU,YAGCC,GAAb,WAUE,SAAAA,EAAY3E,GAAMtc,OAAAC,EAAA,EAAAD,CAAAE,KAAA+gB,GAAA/gB,KARlBghB,IAAM3F,EAAKM,QAQM3b,KAPjB0f,KAAOrE,EAAKM,QAOK3b,KANjBihB,MAAQR,GAAMC,WAMG1gB,KAFjBkhB,WAAa,IAGXlhB,KAAKoc,IAAMA,EAAIT,QACf3b,KAAKoY,KAAO,IAAIyG,GAZpB,OAAA/e,OAAA2a,EAAA,EAAA3a,CAAAihB,EAAA,EAAArG,IAAA,SAAApL,MAAA,SAeS0J,GACLhZ,KAAKmhB,eAAenI,GACpBhZ,KAAKohB,eAAepI,GACpBhZ,KAAKoY,KAAKiJ,eAAerhB,KAAK0f,KAAM1G,KAlBxC,CAAA0B,IAAA,iBAAApL,MAAA,SAqBiB0J,GACbhZ,KAAKoc,IAAIkF,gBAAgBthB,KAAKghB,IAAKhI,GACnChZ,KAAKoY,KAAK+I,eAAenhB,KAAKoc,OAvBlC,CAAA1B,IAAA,iBAAApL,MAAA,SA0BiB0J,GACThZ,KAAKuhB,aACHvhB,KAAKwhB,YACPxhB,KAAKyhB,sBAAsBzI,GAE3BhZ,KAAK0hB,sBAAsB1I,MA/BnC,CAAA0B,IAAA,wBAAApL,MAAA,SAoCwB0J,GFnBjB,IAAmByC,EAAGqC,EAAHrC,EEoBZzb,KAAKghB,IFpBUlD,EEoBL9d,KAAK0f,KFnB3BjE,EAAEkG,IAAI9D,EAAgBpC,EAAGqC,GAAG8D,eAAe,KAC3C9D,EAAE2B,KAAK/D,EAAQD,IEmBb,IAAIO,EAAK,IAAIV,IACTmD,EAAK,IAAInD,KF7BV,SAAqBwC,EAAG9B,EAAIyC,GACjC,IAAIoD,EAAM,IAAIvG,IAAQwC,EAAEpJ,EAAGoJ,EAAEvL,EAAG,GAAG9C,SAC/BmP,EAAM,EAAI,EAAKjB,EAAOkE,EAC1B7F,EAAG0C,KAAKE,EAAId,EAAEvL,EAAGqM,EAAId,EAAEpJ,EAAG,GAC1B+J,EAAGC,KAAKE,EAAId,EAAEpJ,GAAIkK,EAAId,EAAEvL,GAAIqM,EAAId,EAAEtL,GE0BhCsP,CAAY9hB,KAAK0f,KAAM1D,EAAIyC,GAC3BzC,EAAG4F,eAAe5I,GAClByF,EAAGmD,eAAe5I,GACd+C,EAAkB/b,KAAK0f,KAAMjB,IAAO1C,EAAkB/b,KAAKghB,IAAKhF,GAClEhc,KAAK+hB,iBAEL/hB,KAAKghB,IAAI/E,IAAID,GACbhc,KAAK0f,KAAKzD,IAAIwC,GACdze,KAAKihB,MAAQR,GAAME,WAhDzB,CAAAjG,IAAA,wBAAApL,MAAA,SAoDwB0J,GACpB,IAAIgD,EAAK,IAAIV,IACTmD,EAAK,IAAInD,KF7DV,SAAiBG,EAAGqC,EAAG9B,EAAIyC,GAChC,IAAIuD,EAAKnE,EAAgBpC,EAAGqC,GAC5B9B,EAAGyD,KAAK5D,EAAKmG,GAAIJ,gBAAgBrE,EAAKC,IACtCiB,EAAGgB,KAAK5D,EAAKH,EAAQsG,IAAKJ,eAAgB,IAASrE,EAAKC,IACxDiB,EAAGV,MAAK,IAAWL,EAAKna,KAAK0e,KAAKnE,EAAEtL,IE0DlC0P,CAAQliB,KAAKghB,IAAKhhB,KAAK0f,KAAM1D,EAAIyC,GACjCzC,EAAG4F,eAAe5I,GAClByF,EAAGmD,eAAe5I,GACd+C,EAAkB/b,KAAK0f,KAAMjB,IAAO1C,EAAkB/b,KAAKghB,IAAKhF,GAClEhc,KAAK+hB,iBAEL/hB,KAAKghB,IAAI/E,IAAID,GACbhc,KAAK0f,KAAKzD,IAAIwC,GACdze,KAAKihB,MAAQR,GAAMG,WA/DzB,CAAAlG,IAAA,gBAAApL,MAAA,WAoEItP,KAAKghB,IAAIvB,KAAKpE,GACdrb,KAAK0f,KAAKD,KAAKpE,GACfrb,KAAKihB,MAAQR,GAAMC,aAtEvB,CAAAhG,IAAA,YAAApL,MAAA,WA0EI,OACEuO,EAAgB7d,KAAKghB,IAAKhhB,KAAK0f,MAAMjQ,SAAWzP,KAAKkhB,YAChC,GAArBlhB,KAAKghB,IAAIvR,WA5Ef,CAAAiL,IAAA,UAAApL,MAAA,WAiFI,OAAOtP,KAAKihB,OAASR,GAAMI,UAjF/B,CAAAnG,IAAA,WAAApL,MAAA,WAqFI,OAAOtP,KAAKmiB,YAAmC,GAArBniB,KAAKghB,IAAIvR,UAAuC,GAAtBzP,KAAK0f,KAAKjQ,YArFlE,CAAAiL,IAAA,iBAAApL,MAAA,SAwFiB0J,GACb,OAAOhZ,KAAKoc,IAAIT,QAAQ2F,gBAAgBthB,KAAKghB,IAAKhI,KAzFtD,CAAA0B,IAAA,YAAApL,MAAA,WA6FI,MAAO,CAAE8M,IAAKpc,KAAKoc,IAAK4E,IAAKhhB,KAAKghB,IAAKtB,KAAM1f,KAAK0f,KAAMuB,MAAOjhB,KAAKihB,UA7FxE,EAAAvG,IAAA,iBAAApL,MAAA,SAgGwB0E,GACpB,OAAO+M,EAAKqB,qBAAqB,IAAIrB,EAAKvF,EAAIxH,EAAKoI,MAAOpI,KAjG9D,CAAA0G,IAAA,uBAAApL,MAAA,SAoG8B+S,EAAGrO,GAK7B,OAJAqO,EAAEjG,IAAIqD,KAAKzL,EAAKoI,KAChBiG,EAAErB,IAAIvB,KAAKjE,EAAIxH,EAAKgN,MACpBqB,EAAE3C,KAAKD,KAAKjE,EAAIxH,EAAK0L,OACrB2C,EAAEpB,MAAQjN,EAAKiN,MACRoB,MAzGXtB,EAAA,GCbauB,GAAb,WAIE,SAAAA,EAAYlG,EAAKmG,GAASziB,OAAAC,EAAA,EAAAD,CAAAE,KAAAsiB,GACxBtiB,KAAKoc,IAAMA,EACXpc,KAAKuiB,OAASA,EANlB,OAAAziB,OAAA2a,EAAA,EAAA3a,CAAAwiB,EAAA,EAAA5H,IAAA,SAAApL,MAAA,SAaSkT,GACL,IAAMC,EAAKD,EAAKpG,IACbT,QACAgG,IAAI3hB,KAAKoc,KACTN,YACC4G,EAAgBD,EAAGvG,IAAIsG,EAAKxB,KAChCwB,EAAKxB,IAAIM,gBAAgBmB,GAAK,EAAIE,GAAQC,WAAaF,MAnB3D,EAAAhI,IAAA,aAAApL,MAAA,SASoBuT,EAASC,GACzB,OAAOA,EAAeC,WAAWF,EAAQzG,KAAO,GAAMyG,EAAQN,SAVlE,CAAA7H,IAAA,gBAAApL,MAAA,SAsBuBkT,EAAMxJ,GACzB,IAAI8J,EAAiBN,EAAKM,eAAe9J,GACzC,OACEwJ,EAAKL,WACLa,GAAcC,SAASC,KAAK,SAAAtE,GAAC,OAAI0D,EAAQa,WAAWvE,EAAGkE,SA1B7DR,EAAA,GCDac,GAAb,WAIE,SAAAA,EAAYhH,EAAKmG,GAASziB,OAAAC,EAAA,EAAAD,CAAAE,KAAAojB,GACxBpjB,KAAKoc,IAAMA,EACXpc,KAAKuiB,OAASA,EANlB,OAAAziB,OAAA2a,EAAA,EAAA3a,CAAAsjB,EAAA,EAAA1I,IAAA,OAAApL,MAAA,SAaOkT,EAAMxJ,GACT,IAAMyJ,EAAKD,EAAKpG,IACbT,QACAgG,IAAI3hB,KAAKoc,KACTN,YACH0G,EAAKxB,IAAIM,gBAAgBmB,EAAI,EAAIzJ,GACjCwJ,EAAKxB,IAAIxO,GAAK,EACdgQ,EAAKvB,MAAQR,GAAMI,WApBvB,EAAAnG,IAAA,WAAApL,MAAA,SASkB+T,EAAQP,GACtB,OAAOA,EAAeC,WAAWM,EAAOjH,KAAO,GAAMiH,EAAOd,SAVhE,CAAA7H,IAAA,cAAApL,MAAA,SAuBqBkT,EAAMxJ,GACvB,IAAI8J,EAAiBN,EAAKM,eAAe9J,GACzC,OACEwJ,EAAKL,WACLa,GAAcM,cAAcJ,KAAK,SAAAK,GAAC,OAAIH,EAAOI,SAASD,EAAGT,SA3B/DM,EAAA,GCCaJ,GAAb,oBAAAA,IAAAljB,OAAAC,EAAA,EAAAD,CAAAE,KAAAgjB,GAAA,OAAAljB,OAAA2a,EAAA,EAAA3a,CAAAkjB,EAAA,OAAAtI,IAAA,aAAApL,MAAA,SA4KoBe,GAEhB2S,EAAcS,YAAYpT,KA9K9B,CAAAqK,IAAA,iBAAApL,MAAA,SA6LwB+T,EAAQhT,GAC5B2S,EAAcU,SACZL,EAAOjH,IAAIT,QAAQoC,MAAM,IACzBsF,EAAOd,OACP,GACAlS,KAlMN,CAAAqK,IAAA,WAAApL,MAAA,SAsMkB8M,EAAKmG,EAAQoB,EAAOtT,GAClC,IAAI8O,EAAW,IAAIyE,IAAiBrB,EAAQA,EAAQoB,EAAO,IACvDvL,EAAO,IAAIiI,IAAKlB,EAAU6D,EAAcvP,UAQ5C,OAPA2E,EAAK9F,SAASmN,KAAKrD,GACnBhE,EAAK+G,SAASW,aACZ,IAAIH,KACDC,WACAC,iBAAiB,IAAIvE,IAAQ,EAAG,EAAG,GAAI/X,KAAKM,GAAK,IAEtDwM,EAAM4L,IAAI7D,GACHA,IAhNX,CAAAsC,IAAA,aAAApL,MAAA,SAmNoBe,GAChB2S,EAAcM,cAAcO,QAAQ,SAAAN,GAAC,OACnCP,EAAcc,eAAeP,EAAGlT,OArNtC,CAAAqK,IAAA,cAAApL,MAAA,SAyNqBe,GAEjB2S,EAAce,MACZ,IAAIzI,IAAQ,EAAG,GAAG,KAClB,EAAI0H,EAAcrhB,EAClB,EAAIqhB,EAAclhB,EAJX,GAMPuO,GAGF,IACI2T,EAAI,IACJpG,GAAI,KACJqG,EAAU1gB,KAAKI,IACjBqf,EAAckB,QAAQC,SAASC,UAAUhI,IAAI1H,EAC3CsO,EAAckB,QAAQG,QAAQC,UAAUlI,IAAI1H,GAE5C6P,EAAUhhB,KAAKI,IACjBqf,EAAckB,QAAQC,SAASK,UAAUpI,IAAI7J,EAC3CyQ,EAAckB,QAAQO,SAASH,UAAUlI,IAAI7J,GAGjDyQ,EAAce,MACZ,IAAIzI,IAAQ0H,EAAcrhB,EAAI+iB,GAAO,EAAG9G,GAblC,EAeN2G,EACAP,EACA3T,GAEF2S,EAAce,MACZ,IAAIzI,KAAS0H,EAAcrhB,EAAI+iB,GAAO,EAAG9G,GApBnC,EAsBN2G,EACAP,EACA3T,GAGF2S,EAAce,MACZ,IAAIzI,KAAS0H,EAAcrhB,EAAI,EAAGqhB,EAAclhB,EAAI4iB,GAAO9G,GAC3DqG,EA7BM,EA+BND,EACA3T,GAEF2S,EAAce,MACZ,IAAIzI,KAAS0H,EAAcrhB,EAAI,GAAIqhB,EAAclhB,EAAI4iB,GAAO9G,GAC5DqG,EApCM,EAsCND,EACA3T,GAGF2S,EAAce,MACZ,IAAIzI,IAAQ0H,EAAcrhB,EAAI,EAAGqhB,EAAclhB,EAAI4iB,GAAO9G,GAC1DqG,EA5CM,EA8CND,EACA3T,GAEF2S,EAAce,MACZ,IAAIzI,IAAQ0H,EAAcrhB,EAAI,GAAIqhB,EAAclhB,EAAI4iB,GAAO9G,GAC3DqG,EAnDM,EAqDND,EACA3T,KAzRN,CAAAqK,IAAA,QAAApL,MAAA,SA6Re8M,EAAK1H,EAAGnC,EAAGC,EAAGnC,GACzB,IAAI8O,EAAW,IAAIwF,IAAYjQ,EAAGnC,EAAGC,GACjC4F,EAAO,IAAIiI,IAAKlB,EAAU6D,EAAcvP,UAC5C2E,EAAKmI,eAAgB,EACrBnI,EAAK9F,SAASmN,KAAKrD,GACnB/L,EAAM4L,IAAI7D,OAlSd4K,EAAA,GAAaA,GACJ4B,OAAU,GADN5B,GAEJ6B,OAAU,GAAU,EAFhB7B,GAGJrhB,EAAIqhB,GAAc4B,OAAS,GAHvB5B,GAIJlhB,EAAIkhB,GAAc6B,OAAS,GAJvB7B,GAKJ8B,GAAK9B,GAAc4B,OAAS,IALxB5B,GAMJ+B,GAAK/B,GAAc6B,OAAS,IANxB7B,GAOJgC,aAAe,EAPXhC,GAQJiC,cAAgB,GARZjC,GASJkC,mBAAqB,EATjBlC,GAUJmC,oBAAsB,GAVlBnC,GAWJoC,aAAe,EAXXpC,GAYJqC,aAAe,GAZXrC,GAaJkB,QAAU,CACfC,SAAU,CACRd,OAAQ,IAAID,GACV,IAAI9H,KAAS0H,GAAc8B,GAAI9B,GAAc+B,GAAI,GACjD/B,GAAcoC,cAEhBhB,UAAW,IAAI9B,GACb,IAAIhH,KACD0H,GAAcrhB,EAAIqhB,GAAcgC,aACjChC,GAAclhB,EAAIkhB,GAAciC,cAChC,GAEFjC,GAAciC,eAEhBT,UAAW,IAAIlC,GACb,IAAIhH,KACD0H,GAAcrhB,EAAIqhB,GAAciC,cACjCjC,GAAclhB,EAAIkhB,GAAcgC,aAChC,GAEFhC,GAAciC,gBAGlBZ,QAAS,CACPhB,OAAQ,IAAID,GACV,IAAI9H,IAAQ,EAAG0H,GAAc+B,GAAI,GACjC/B,GAAcqC,cAEhBjB,UAAW,IAAI9B,GACb,IAAIhH,IACF0H,GAAcgC,aACdhC,GAAclhB,EAAIkhB,GAAcmC,oBAChC,GAEFnC,GAAciC,eAEhBX,UAAW,IAAIhC,GACb,IAAIhH,KACD0H,GAAckC,mBACflC,GAAclhB,EAAIkhB,GAAcmC,oBAChC,GAEFnC,GAAciC,gBAGlBK,QAAS,CACPjC,OAAQ,IAAID,GACV,IAAI9H,IAAQ,GAAI0H,GAAc+B,GAAI,GAClC/B,GAAcqC,cAEhBE,UAAW,IAAIjD,GACb,IAAIhH,IACF0H,GAAcgC,cACbhC,GAAclhB,EAAIkhB,GAAcmC,oBACjC,GAEFnC,GAAciC,eAEhBT,UAAW,IAAIlC,GACb,IAAIhH,KACD0H,GAAckC,oBACdlC,GAAclhB,EAAIkhB,GAAcmC,oBACjC,GAEFnC,GAAciC,gBAGlBO,SAAU,CACRnC,OAAQ,IAAID,GACV,IAAI9H,IAAQ0H,GAAc8B,GAAI9B,GAAc+B,GAAI,GAChD/B,GAAcoC,cAEhBd,UAAW,IAAIhC,GACb,IAAIhH,IACF0H,GAAcrhB,EAAIqhB,GAAcgC,aAChChC,GAAclhB,EAAIkhB,GAAciC,cAChC,GAEFjC,GAAciC,eAEhBM,UAAW,IAAIjD,GACb,IAAIhH,IACF0H,GAAcrhB,EAAIqhB,GAAciC,cAChCjC,GAAclhB,EAAIkhB,GAAcgC,aAChC,GAEFhC,GAAciC,gBAGlBQ,SAAU,CACRpC,OAAQ,IAAID,GACV,IAAI9H,IAAQ0H,GAAc8B,IAAK9B,GAAc+B,GAAI,GACjD/B,GAAcoC,cAEhBhB,UAAW,IAAI9B,GACb,IAAIhH,IACF0H,GAAcrhB,EAAIqhB,GAAciC,eAC/BjC,GAAclhB,EAAIkhB,GAAcgC,aACjC,GAEFhC,GAAciC,eAEhBT,UAAW,IAAIlC,GACb,IAAIhH,IACF0H,GAAcrhB,EAAIqhB,GAAcgC,cAC/BhC,GAAclhB,EAAIkhB,GAAciC,cACjC,GAEFjC,GAAciC,gBAGlBR,SAAU,CACRpB,OAAQ,IAAID,GACV,IAAI9H,KAAS0H,GAAc8B,IAAK9B,GAAc+B,GAAI,GAClD/B,GAAcoC,cAEhBG,UAAW,IAAIjD,GACb,IAAIhH,KACD0H,GAAcrhB,EAAIqhB,GAAcgC,cAChChC,GAAclhB,EAAIkhB,GAAciC,cACjC,GAEFjC,GAAciC,eAEhBX,UAAW,IAAIhC,GACb,IAAIhH,KACD0H,GAAcrhB,EAAIqhB,GAAciC,eAChCjC,GAAclhB,EAAIkhB,GAAcgC,aACjC,GAEFhC,GAAciC,iBA/ITjC,GAoJJC,SAAW,CAChBD,GAAckB,QAAQC,SAASC,UAC/BpB,GAAckB,QAAQC,SAASK,UAC/BxB,GAAckB,QAAQG,QAAQC,UAC9BtB,GAAckB,QAAQG,QAAQD,UAC9BpB,GAAckB,QAAQoB,QAAQd,UAC9BxB,GAAckB,QAAQoB,QAAQC,UAC9BvC,GAAckB,QAAQsB,SAASlB,UAC/BtB,GAAckB,QAAQsB,SAASD,UAC/BvC,GAAckB,QAAQuB,SAASrB,UAC/BpB,GAAckB,QAAQuB,SAASjB,UAC/BxB,GAAckB,QAAQO,SAASc,UAC/BvC,GAAckB,QAAQO,SAASH,WAhKtBtB,GAmKJM,cAAgB,CACrBN,GAAckB,QAAQC,SAASd,OAC/BL,GAAckB,QAAQO,SAASpB,OAC/BL,GAAckB,QAAQG,QAAQhB,OAC9BL,GAAckB,QAAQoB,QAAQjC,OAC9BL,GAAckB,QAAQsB,SAASnC,OAC/BL,GAAckB,QAAQuB,SAASpC,QAzKtBL,GAkLJvP,SAAW,IAAI0M,IAAkB,CACtCnJ,MAAO,QACP0O,WAAW,EACXC,aAAa,ICrLV,IAAMhD,GAAb,oBAAAA,IAAA7iB,OAAAC,EAAA,EAAAD,CAAAE,KAAA2iB,GAAA,OAAA7iB,OAAA2a,EAAA,EAAA3a,CAAA6iB,EAAA,OAAAjI,IAAA,aAAApL,MAAA,SAGoBkT,EAAMxJ,GACtB,IAAI8J,EAAiBN,EAAKM,eAAe9J,GAEzC,OACEwJ,EAAKL,YACJQ,EAAQiD,sBACP5C,GAAckB,QAAQC,SAASC,UAAUhI,IAAI1H,EAC7CsO,GAAckB,QAAQG,QAAQC,UAAUlI,IAAI1H,EAC5CoO,IAEAH,EAAQiD,sBACN5C,GAAckB,QAAQG,QAAQD,UAAUhI,IAAI1H,EAC5CsO,GAAckB,QAAQsB,SAASlB,UAAUlI,IAAI1H,EAC7CoO,IAEFH,EAAQkD,uBACN7C,GAAckB,QAAQC,SAASK,UAAUpI,IAAI7J,EAC7CyQ,GAAckB,QAAQO,SAASH,UAAUlI,IAAI7J,EAC7CuQ,MArBV,CAAApI,IAAA,wBAAApL,MAAA,SA2BIwW,EACAC,EACAjD,GAEA,OACEA,EAAepO,EAAIoR,GACnBhD,EAAepO,EAAIqR,GACnBxiB,KAAKI,IAAImf,EAAevQ,GAAKyQ,GAAc6B,SAlCjD,CAAAnK,IAAA,yBAAApL,MAAA,SAuCI0W,EACAC,EACAnD,GAEA,OACEA,EAAevQ,EAAI0T,GACnBnD,EAAevQ,EAAIyT,GACnBziB,KAAKI,IAAImf,EAAepO,GAAKsO,GAAc4B,SA9CjD,CAAAlK,IAAA,SAAApL,MAAA,SAkDgBkT,EAAMxJ,GAClB,IAAI8J,EAAiBN,EAAKM,eAAe9J,GACrC8J,EAAepO,EAAIsO,GAAc4B,QACnCjC,EAAQuD,SAAS,EAAG1D,GAElBM,EAAepO,GAAKsO,GAAc4B,QACpCjC,EAAQuD,SAAS3iB,KAAKM,GAAI2e,GAExBM,EAAevQ,EAAIyQ,GAAc6B,QACnClC,EAAQuD,UAAU3iB,KAAKM,GAAK,EAAG2e,GAE7BM,EAAevQ,GAAKyQ,GAAc6B,QACpClC,EAAQuD,SAAS3iB,KAAKM,GAAK,EAAG2e,KA9DpC,CAAA9H,IAAA,WAAApL,MAAA,SAkEkBqF,EAAU6N,GACxB,IAAIxG,EAAK,IAAIV,IACTmD,EAAK,IAAInD,KN3BV,SAA6B6K,EAAO1K,EAAGqC,EAAG9B,EAAIyC,EAAI2H,GAGvDA,EAFS3K,EAAEE,QAAQ0K,eAAe9K,EAAI4K,GAC7BrI,EAAEnC,QAAQ0K,eAAe9K,EAAI4K,GAC5BnK,EAAIyC,GACdzC,EAAGqK,eAAe9K,GAAK4K,GACvB1H,EAAG4H,eAAe9K,GAAK4K,GMuBrBG,CACE3R,EACA6N,EAAKxB,IACLwB,EAAK9C,KACL1D,EACAyC,EACAD,IAEFgE,EAAKxB,IAAI/E,IAAID,GACbwG,EAAK9C,KAAKzD,IAAIwC,OA9ElBkE,EAAA,GAAaA,GACJC,WAAa,GCHf,IAAM2D,GAAb,oBAAAA,IAAAzmB,OAAAC,EAAA,EAAAD,CAAAE,KAAAumB,GAAA,OAAAzmB,OAAA2a,EAAA,EAAA3a,CAAAymB,EAAA,OAAA7L,IAAA,cAAApL,MAAA,SACqBkX,EAAGnE,EAAGrJ,GACvB,OACEwN,EAAErE,WACFE,EAAEF,WACFqE,EAAE1D,eAAe9J,GAAG+J,WAAWV,EAAES,eAAe9J,IAAM,IAL5D,CAAA0B,IAAA,UAAApL,MAAA,SASiBkX,EAAGnE,GAChBkE,EAAUE,iBAAiBD,EAAGnE,KAVlC,CAAA3H,IAAA,mBAAApL,MAAA,SAa0BkX,EAAGnE,GACzB,IAAMqE,EAAK7K,EAAKwG,EAAEjG,IAAIT,QAAQgG,IAAI6E,EAAEpK,MAChCuK,EAAcD,EAAGxK,IAAIsK,EAAExF,KACvB4F,EAAcF,EAAGxK,IAAImG,EAAErB,KAC3BwF,EAAExF,IAAIM,gBAAgBoF,EAAIE,GAAatF,gBAAgBoF,GAAKC,GAC5DtE,EAAErB,IAAIM,gBAAgBoF,EAAIC,GAAarF,gBAAgBoF,GAAKE,OAlBhEL,EAAA,GCWaM,GAAb,WAeE,SAAAA,IAAe/mB,OAAAC,EAAA,EAAAD,CAAAE,KAAA6mB,GAAA7mB,KAbf8mB,MAAQ,GAaM9mB,KAZd+mB,SAAW,EAYG/mB,KAVdgnB,IAAM,IAAI7K,EAUInc,KARdyP,OAAgC,EAAvBuT,GAAc4B,OASrB5kB,KAAKinB,WAAW,IAAM,IAAMjnB,KAAKyP,QAhBrC,OAAA3P,OAAA2a,EAAA,EAAA3a,CAAA+mB,EAAA,EAAAnM,IAAA,aAAApL,MAAA,SAmBa4X,EAAKC,EAAK1X,GACnB,IAAI0P,EAAW,IAAIyE,IAAiBsD,EAAKC,EAAK1X,EAAQ,IACtDzP,KAAKoY,KAAO,IAAIiI,IAAKlB,EAAU0H,EAAIpT,UACnCzT,KAAKoY,KAAKkI,YAAa,EACvBtgB,KAAKoY,KAAK+G,SACPW,aACC,IAAIH,KACDC,WACAC,iBAAiB,IAAIvE,IAAQ,EAAK,EAAK,IAAO,KAElDwE,aAAY,IAAIH,KAAUC,WAAWC,iBAAiBtE,GAAKhY,KAAKM,GAAK,IACrEic,aACC,IAAIH,KAAUC,WAAWwH,iBAAiB3X,EAAS,EAAI,EAAG,EAAG,IAEjEzP,KAAKoY,KAAKzD,SAASnC,EAAIxS,KAAKgnB,IAAIxK,QAjCpC,CAAA9B,IAAA,YAAApL,MAAA,SAoCYkN,GACRxc,KAAKgnB,IAAIxK,OAASA,EAClBxc,KAAKgnB,IAAI3K,IAAIgK,eAAe9K,EAAIiB,GAChCxc,KAAKoY,KAAKzD,SAASnC,EAAIxS,KAAKgnB,IAAIxK,QAvCpC,CAAA9B,IAAA,eAAApL,MAAA,SA0Ce+X,GACXrnB,KAAKgnB,IAAI1K,eAAiBgL,IAAMC,MAC9BvnB,KAAKgnB,IAAI1K,eAAiB+K,GACzBrnB,KAAK8mB,MACN9mB,KAAK8mB,OAEP9mB,KAAKoY,KAAK9F,SAASE,EAAIxS,KAAKgnB,IAAI1K,iBAhDpC,CAAA5B,IAAA,aAAApL,MAAA,SAmDa+X,GACTrnB,KAAKgnB,IAAIzK,WAAa+K,IAAMC,MAC1BvnB,KAAKgnB,IAAIzK,WAAa8K,GACrBrnB,KAAK8mB,MACN9mB,KAAK8mB,SAvDX,CAAApM,IAAA,cAAApL,MAAA,SA2Dc+X,GACVrnB,KAAKgnB,IAAIvK,MAAQlZ,KAAKikB,IAAIxnB,KAAK+mB,SAAU/mB,KAAKgnB,IAAIvK,MAAQ4K,KA5D9D,CAAA3M,IAAA,SAAApL,MAAA,SA+DS8M,GACLpc,KAAKgnB,IAAI5K,IAAIqD,KAAKrD,GAClBpc,KAAKoY,KAAKzD,SAASnC,EAAIxS,KAAKgnB,IAAIxK,MAChC,IAAIiL,EAAS/L,EAAQ1b,KAAKgnB,IAAI3K,KAC3BuF,eAAe5hB,KAAKgnB,IAAIzK,YACxBwB,KAAK/d,KAAKgnB,IAAI1K,gBACboL,EAAQ1nB,KAAKgnB,IAAI3K,IAAIV,QAAQiG,gBAAgB5hB,KAAKgnB,IAAIvK,MAAQ,GAClEzc,KAAKoY,KAAK9F,SAASmN,KACjBrD,EACGT,QACAM,IAAIwL,GACJxL,IAAIyL,MA1Eb,CAAAhN,IAAA,SAAApL,MAAA,SA8ESgO,GACLtd,KAAK2nB,OAAO3nB,KAAKgnB,IAAI5K,OA/EzB,CAAA1B,IAAA,qBAAApL,MAAA,SAkFqBuD,GACjB,IAAI+U,EAAS/U,EAAMgV,MAAM,GAAGzL,IACzBT,QACA2F,gBAAgBthB,KAAKgnB,IAAI3K,KAAMrc,KAAKyP,OAAS,GAChDmY,EAAOpV,EAAIxS,KAAKgnB,IAAI1K,eACpB,IAAIwL,EAAY9nB,KAAKgnB,IAAI3K,IAAIV,QAAQG,YAKrC,OAJgB,IAAIiM,IAAUH,EAAQE,EAAW,EAAG9nB,KAAKyP,OAAS,EAAI,IACxCuY,iBAC5BnV,EAAMgV,MAAMI,IAAI,SAAA5F,GAAC,OAAIA,EAAEjK,KAAKA,QAET3I,OAAS,MA5FlCoX,EAAA,GAAaA,GASJpT,SAAW,IAAI0M,IAAkB,CACtCnJ,MAAO,QACP0O,WAAW,EACXC,aAAa,IClBV,IAAMuC,GAAb,WAME,SAAAA,EAAYL,GAAQ/nB,OAAAC,EAAA,EAAAD,CAAAE,KAAAkoB,GAAAloB,KALpB6nB,MAAQ,GAKW7nB,KAJnBmoB,IAAM,IAAItB,GAIS7mB,KAFnBooB,QAAU,GAGRpoB,KAAKqoB,gBAAgBR,GAPzB,OAAA/nB,OAAA2a,EAAA,EAAA3a,CAAAooB,EAAA,EAAAxN,IAAA,kBAAApL,MAAA,SAUkBuY,GAAO,IAAAvnB,EAAAN,KACrBA,KAAK6nB,MAAQA,EACb7nB,KAAKsoB,MAAQ,GACbtoB,KAAK6nB,MAAMhE,QAAQ,SAAA2C,GACjBlmB,EAAKunB,MAAMhE,QAAQ,SAAAxB,GACbmE,GAAKnE,GACP/hB,EAAKgoB,MAAMtY,KAAK,CAAEwW,EAAGA,EAAGnE,EAAGA,UAhBrC,CAAA3H,IAAA,UAAApL,MAAA,SAsBU0J,GAEN,IADA,IAAI2K,EAAQ,GACJ3jB,KAAKuoB,kBAAkBvP,IAC7B,GAAI2K,IAAU,IACZ,MAAM,IAAI6E,MAAM,uCAGpBxoB,KAAK6nB,MAAMhE,QAAQ,SAAA2C,GACjBA,EAAEiC,OAAOzP,OA9Bf,CAAA0B,IAAA,oBAAApL,MAAA,SAkCoB0J,GAAG,IAAA0P,EAAA1oB,KACnB,OAAQA,KAAKsoB,MAAMK,KAAK,SAAAC,GAAI,OAAKF,EAAKG,mBAAmBD,EAAKpC,EAAGoC,EAAKvG,EAAGrJ,OAnC7E,CAAA0B,IAAA,qBAAApL,MAAA,SAsCqBkX,EAAGnE,EAAGrJ,GACvB,GAAIuN,GAAUuC,YAAYtC,EAAGnE,EAAGrJ,GAG9B,OAFAuN,GAAUwC,QAAQvC,EAAGnE,GACrBriB,KAAKooB,QAAQpY,KAAK,CAAE3B,KAAM,YAAamY,EAAGA,EAAGnE,EAAGA,KACzC,EAET,GAAIM,GAAQQ,WAAWqD,EAAGxN,GAGxB,OAFA2J,GAAQqG,OAAOxC,EAAGxN,GAClBhZ,KAAKooB,QAAQpY,KAAK,CAAE3B,KAAM,UAAWmY,EAAGA,KACjC,EAET,IAAI5H,EAAI0D,GAAQ2G,cAAczC,EAAGxN,GACjC,GAAI4F,EAGF,OAFAA,EAAEoK,OAAOxC,GACTxmB,KAAKooB,QAAQpY,KAAK,CAAE3B,KAAM,UAAWmY,EAAGA,KACjC,EAET,IAAIjD,EAAIH,GAAO8F,YAAY1C,EAAGxN,GAC9B,OAAIuK,IACFA,EAAE4F,KAAK3C,EAAGxN,GACVhZ,KAAKooB,QAAQpY,KAAK,CAAE3B,KAAM,MAAOmY,EAAGA,KAC7B,KA3Db,CAAA9L,IAAA,gBAAApL,MAAA,WAkEI,OAAOtP,KAAK6nB,MAAMuB,MAAM,SAAA/G,GAAC,OAAKA,EAAEd,aAAec,EAAEF,cAlErD,CAAAzH,IAAA,YAAApL,MAAA,WAsEI,MAAO,CACLuY,MAAO7nB,KAAK6nB,MAAMI,IAAI,SAAA5F,GAAC,OAAIA,EAAEgH,cAC7BrC,IAAKhnB,KAAKmoB,IAAInB,IAAIvH,UAxExB,CAAA/E,IAAA,uBAAApL,MAAA,SAkFuB0E,GACnBhU,KAAK6nB,MAAMhE,QAAQ,SAACxB,EAAGtS,GAAJ,OAAUgR,GAAKqB,qBAAqBC,EAAGrO,EAAK6T,MAAM9X,MACrE/P,KAAKmoB,IAAInB,IAAM7K,EAASQ,SAAS3I,EAAKgT,QApF1C,EAAAtM,IAAA,iBAAApL,MAAA,SA4EwB0E,GACpB,IAAInB,EAAQ,IAAIqV,EAAMlU,EAAK6T,MAAMI,IAAI,SAAA5F,GAAC,OAAItB,GAAKuI,eAAejH,MAE9D,OADAxP,EAAMsV,IAAInB,IAAM7K,EAASQ,SAAS3I,EAAKgT,KAChCnU,MA/EXqV,EAAA,GCJaqB,GAAb,WACE,SAAAA,EAAYC,GAAc1pB,OAAAC,EAAA,EAAAD,CAAAE,KAAAupB,GAAAvpB,KAK1B0R,KAAO1R,KAAKypB,QALazpB,KAOzB0pB,aAAe,IAAIpO,IAAQ,GAAI,GAAK,IANlCtb,KAAK2pB,OAAS,IAAIC,IAAkB,GAAIJ,EAAa,GAAK,KAF9D,OAAA1pB,OAAA2a,EAAA,EAAA3a,CAAAypB,EAAA,EAAA7O,IAAA,SAAApL,MAAA,SAUSgO,EAAG0J,GACRhnB,KAAK0R,KAAKsV,KAXd,CAAAtM,IAAA,UAAApL,MAAA,SAcUgO,GACNtd,KAAK2pB,OAAOrX,SAASuX,KAAK7pB,KAAK0pB,aAAc,IAC7C1pB,KAAK2pB,OAAOpO,GAAKA,EACjBvb,KAAK2pB,OAAO7U,OAAOuG,KAjBvB,CAAAX,IAAA,UAAApL,MAAA,SAoBU0X,GACNhnB,KAAK2pB,OAAOrX,SAASuX,KAAK7pB,KAAK0pB,aAAc,IAC7C1pB,KAAK2pB,OAAOpO,GAAKA,EACjBvb,KAAK2pB,OAAO7U,OAAOuG,KAvBvB,CAAAX,IAAA,eAAApL,MAAA,SAiCewa,GACX9pB,KAAK2pB,OAAOrX,SAASgP,gBAAgB/F,EAAI,KACzCvb,KAAK2pB,OAAOpO,GAAKA,EACjBvb,KAAK2pB,OAAO7U,OAAOgV,OApCvBP,EAAA,GCOaQ,GAAb,WAKE,SAAAA,EAAYC,GAAUlqB,OAAAC,EAAA,EAAAD,CAAAE,KAAA+pB,GAAA/pB,KAJtBqQ,MAAQ,IAAI4Z,SAKMhX,IAAZ+W,GACFhqB,KAAKkqB,SAAW,IAAIC,IACpBnqB,KAAKoqB,gBAAgBJ,EAASA,EAAQK,YAAaL,EAAQM,cAC3DtqB,KAAKuqB,UAAUP,EAAQK,YAAaL,EAAQM,eAE5CtqB,KAAKuqB,UAAU,EAAG,GAEpBvqB,KAAKwqB,YACLxqB,KAAKyqB,WAdT,OAAA3qB,OAAA2a,EAAA,EAAA3a,CAAAiqB,EAAA,EAAArP,IAAA,SAAApL,MAAA,SAiBS0J,EAAGgO,GACRhnB,KAAK2pB,OAAOlB,OAAOzP,EAAGgO,KAlB1B,CAAAtM,IAAA,SAAApL,MAAA,WAsBItP,KAAKkqB,SAASzS,OAAOzX,KAAKqQ,MAAOrQ,KAAK2pB,OAAOA,UAtBjD,CAAAjP,IAAA,kBAAApL,MAAA,SAyBkB0a,EAASU,EAAOC,GAC9B3qB,KAAKkqB,SAASU,QAAQF,EAAOC,GAC7B3qB,KAAKkqB,SAASW,UAAUC,SAAU,EAClC9qB,KAAKkqB,SAASW,UAAUxc,KAAO0c,IAC/Bf,EAAQgB,YAAYhrB,KAAKkqB,SAASe,cA7BtC,CAAAvQ,IAAA,YAAApL,MAAA,SAgCYob,EAAOC,GACf3qB,KAAK2pB,OAAS,IAAIJ,GAAOmB,EAAQC,KAjCrC,CAAAjQ,IAAA,YAAApL,MAAA,WAqCI,IAAIqP,EAAI,IACJuM,EAAQ,IAAIC,IAAiB,SAAU,GAC3CD,EAAM5Y,SAASoM,IAAI,IAAM,IAAM,IAC/BwM,EAAME,OAAOzB,OAAO0B,KAAO,EAC3BH,EAAME,OAAOzB,OAAO2B,IAAM,GAC1BJ,EAAME,OAAOzB,OAAO5D,MAAQ/C,GAAcrhB,EAAIgd,EAC9CuM,EAAME,OAAOzB,OAAO7D,MAAQ9C,GAAcrhB,EAAIgd,EAC9CuM,EAAME,OAAOzB,OAAO3D,IAAMhD,GAAclhB,EAAI6c,EAC5CuM,EAAME,OAAOzB,OAAO1D,QAAUjD,GAAclhB,EAAI6c,EAChDuM,EAAME,OAAOG,QAAQb,MAAQ,KAC7BQ,EAAME,OAAOG,QAAQZ,OAAS,KAC9BO,EAAM5K,YAAa,EACnBtgB,KAAKqQ,MAAM4L,IAAIiP,GACflrB,KAAKqQ,MAAM4L,IAAI,IAAIuP,IAAa,QAAU,MAlD9C,CAAA9Q,IAAA,WAAApL,MAAA,WAsDI0T,GAAcyI,WAAWzrB,KAAKqQ,SAtDlC,CAAAqK,IAAA,UAAApL,MAAA,SAyDU8I,GACNpY,KAAKqQ,MAAM4L,IAAI7D,OA1DnB2R,EAAA,GCPa2B,GAAb,oBAAAA,IAAA5rB,OAAAC,EAAA,EAAAD,CAAAE,KAAA0rB,GAAA,OAAA5rB,OAAA2a,EAAA,EAAA3a,CAAA4rB,EAAA,OAAAhR,IAAA,SAAApL,MAAA,SAKgB8M,GACZ,OAAOA,EACJT,QACAM,IACC,IAAIX,IACFoQ,EAAKC,OAASpoB,KAAKwb,SAAW,IAC9B2M,EAAKC,OAASpoB,KAAKwb,SAAW,IAC9B,MAZV,CAAArE,IAAA,UAAApL,MAAA,WAkBI,OAAO,IAAIyR,GAAK,IAAIzF,KAAS,GAAI,EAAK,MAlB1C,CAAAZ,IAAA,UAAApL,MAAA,WAsBI,IAAIsc,EAAS,IAAItQ,IAAQ,EAAGoQ,EAAKG,IAAK,GAClCC,EAAWF,EAAOjQ,QAAQ0K,eAAeqF,EAAKnQ,GAAe,EAAVhY,KAAKM,GAAU,GAClEuY,EAAM,IAAId,IAAQ0H,GAAc4B,OAAS,EAAG,EAAG,GAC/CmH,EAAU,GAqBd,OAnBAA,EAAQ/b,KAAK0b,EAAKM,WAClBD,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIH,IAAI6P,GACRC,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIuF,IAAIiK,GACRG,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIH,IAAI6P,GACRC,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIuF,IAAIiK,GACRG,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIH,IAAI2P,GACRxP,EAAIH,IAAI2P,GACRG,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIH,IAAI6P,GAAUnK,IAAIiK,GACtBG,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIuF,IAAIiK,GACRG,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAClCA,EAAIH,IAAI6P,GACRC,EAAQ/b,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAC3B2P,IA9CX,CAAArR,IAAA,WAAApL,MAAA,WAkDI,IAAIsc,EAAS,IAAItQ,IAAQ,EAAGoQ,EAAKG,IAAK,GAClCC,EAAWF,EAAOjQ,QAAQ0K,eAAeqF,EAAKnQ,GAAe,EAAVhY,KAAKM,GAAU,GAClEuY,EAAM,IAAId,IAAQ0H,GAAc4B,OAAS,EAAG,EAAG,GAC/CsH,EAAW,GAQf,OANAA,EAASlc,KAAK0b,EAAKM,WAEnBE,EAASlc,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAEnCA,EAAIH,IAAI6P,GAAUnK,IAAIiK,GACtBM,EAASlc,KAAK,IAAI+Q,GAAK2K,EAAKO,OAAO7P,KAC5B8P,MA7DXR,EAAA,GAAaA,GACJC,MAAQ,IADJD,GAEJG,IAAM,EAAM,EAAIH,GAAKC,MAFjBD,GAGJnQ,GAAK,IAAID,IAAQ,EAAG,GAAI,GCK1B,IAAM6Q,GAAb,WAcE,SAAAA,EAAYnC,EAASxlB,GAAK,IAAAlE,EAAAN,KAAAF,OAAAC,EAAA,EAAAD,CAAAE,KAAAmsB,GAAAnsB,KAT1BosB,WAAa,GASapsB,KAR1BqsB,WAAa,GAQarsB,KAN1BssB,KAAOC,YAAYC,MAMOxsB,KAL1BysB,KAAO,IAMLzsB,KAAKwE,IAAMA,EACXxE,KAAK6S,MAAQ,IAAIqV,GAAMwD,GAAKQ,YAC5BlsB,KAAKsa,KAAO,IAAIyP,GAAKC,GACrBhqB,KAAK6S,MAAMgV,MAAMhE,QAAQ,SAAAxB,GAAC,OAAI/hB,EAAKga,KAAKoS,QAAQrK,EAAEjK,KAAKA,QACvDpY,KAAKsa,KAAKoS,QAAQ1sB,KAAK6S,MAAMsV,IAAI/P,MACjCpY,KAAK2sB,iBAAiB,IAAIC,GAAK5sB,OApBnC,OAAAF,OAAA2a,EAAA,EAAA3a,CAAAqsB,EAAA,EAAAzR,IAAA,YAAApL,MAAA,eAAAoL,IAAA,UAAApL,MAAA,SA0BUud,GAGN,IAFA,IAAIC,EAAQvpB,KAAKwpB,IAAI,GAAIxpB,KAAKypB,MAAMH,EAAU7sB,KAAKysB,OAC/CQ,EAAcjtB,KAAK6S,MAAMqa,gBACpBnd,EAAI,EAAGA,EAAI+c,EAAO/c,IACzB/P,KAAK6S,MAAMsa,QAAQntB,KAAKysB,MAE1BzsB,KAAKsa,KAAKmO,OAAOqE,EAAQ9sB,KAAKysB,KAAMzsB,KAAK6S,MAAMsV,IAAInB,KACnDhnB,KAAK6S,MAAMsV,IAAIM,OAAOqE,EAAQ9sB,KAAKysB,OAC9BQ,GAAejtB,KAAK6S,MAAMqa,iBAE7BltB,KAAKqsB,WAAWrc,KAAK,IAAI+M,KApC/B,CAAArC,IAAA,gBAAApL,MAAA,WAyCI,IAAI8d,EAAQptB,KAAKosB,WAAWiB,QAC5BD,GAASptB,KAAK2sB,iBAAiB3sB,KAAK2a,WAAW2S,YAAYF,IAC3D,IAAIvQ,EAAQ7c,KAAKqsB,WAAWgB,QAC5BxQ,GAAS7c,KAAK2sB,iBAAiB9P,EAAM0Q,kBAAkBvtB,KAAK2a,eA5ChE,CAAAD,IAAA,UAAApL,MAAA,SA+CUke,GAAW,IAAA9E,EAAA1oB,KACjBA,KAAKmtB,SAASK,EAAYxtB,KAAKssB,MAAQ,KACvCtsB,KAAKsa,KAAK7C,SACVzX,KAAKssB,KAAOkB,EAEZxtB,KAAKytB,gBAELC,sBAAsB,SAAA1U,GACpB0P,EAAKiF,QAAQ3U,OAvDnB,CAAA0B,IAAA,mBAAApL,MAAA,SA2DmBqL,GACXA,GAAc3a,KAAK2a,YACrB3a,KAAKwE,IAAI,iBAAmBmW,EAAWiT,YAAYpa,MAErDxT,KAAK2a,WAAaA,MA/DtBwR,EAAA,GCEa0B,GAAb,WAGE,SAAAA,EAAYC,GAAYhuB,OAAAC,EAAA,EAAAD,CAAAE,KAAA6tB,GACtB7tB,KAAK8tB,UAAYA,EAJrB,OAAAhuB,OAAA2a,EAAA,EAAA3a,CAAA+tB,EAAA,EAAAnT,IAAA,cAAApL,MAAA,SAOcgO,GACV,OAAOtd,OARX,CAAA0a,IAAA,cAAApL,MAAA,SAUcgO,GACV,OAAOtd,OAXX,CAAA0a,IAAA,YAAApL,MAAA,SAaYgO,GACR,OAAOtd,OAdX,CAAA0a,IAAA,YAAApL,MAAA,SAgBYgO,GACR,OAAOtd,OAjBX,CAAA0a,IAAA,cAAApL,MAAA,SAmBcgO,GACV,OAAOtd,OApBX,CAAA0a,IAAA,cAAApL,MAAA,SAsBcgO,GACV,OAAOtd,OAvBX,CAAA0a,IAAA,mBAAApL,MAAA,SAyBmBgO,GACf,OAAOtd,SA1BX6tB,EAAA,GCVaE,GAAb,SAAA/Q,GACE,SAAA+Q,IAAc,IAAAztB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAA+tB,IACZztB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAiuB,GAAA5Q,KAAAnd,QACKqO,KAAOuM,EAAUC,MAFVva,EADhB,OAAAR,OAAAsd,EAAA,EAAAtd,CAAAiuB,EAAA/Q,GAAAld,OAAA2a,EAAA,EAAA3a,CAAAiuB,EAAA,EAAArT,IAAA,oBAAApL,MAAA,SAMoBqL,GAChB,OAAOA,EAAWqT,YAAYhuB,UAPlC+tB,EAAA,CAAgCvT,GCFnByT,GAAb,SAAAC,GAAA,SAAAD,IAAA,OAAAnuB,OAAAC,EAAA,EAAAD,CAAAE,KAAAiuB,GAAAnuB,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAmuB,GAAAE,MAAAnuB,KAAAouB,YAAA,OAAAtuB,OAAAsd,EAAA,EAAAtd,CAAAmuB,EAAAC,GAAAD,EAAA,CAAyBJ,ICKZQ,GAAb,SAAAH,GAGE,SAAAG,EAAYP,GAAW,IAAAxtB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAAquB,IACrB/tB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAuuB,GAAAlR,KAAAnd,KAAM8tB,KAHRQ,MAAQ,KAINhuB,EAAKwtB,UAAUjb,MAAMsV,IAAIR,OAAOrnB,EAAKwtB,UAAUjb,MAAMgV,MAAM,GAAGzL,KAC9D9b,EAAKwtB,UAAUxT,KAAKqP,OAAOjY,KAAOpR,EAAKwtB,UAAUxT,KAAKqP,OAAOF,QAHxCnpB,EAHzB,OAAAR,OAAAsd,EAAA,EAAAtd,CAAAuuB,EAAAH,GAAApuB,OAAA2a,EAAA,EAAA3a,CAAAuuB,EAAA,EAAA3T,IAAA,YAAApL,MAAA,SASYuN,GAER,OADA7c,KAAK8tB,UAAUjb,MAAMsV,IAAInB,IAAMnK,EACxB7c,OAXX,CAAA0a,IAAA,YAAApL,MAAA,SAcYuN,GAER,OADA7c,KAAK8tB,UAAUjb,MAAMuP,qBAAqBvF,EAAMD,MACzC,IAAI2R,GAASvuB,KAAK8tB,WAAW,KAhBxC,CAAApT,IAAA,cAAApL,MAAA,SAmBcgO,GACV,OAAO,IAAI2Q,GAAIjuB,KAAK8tB,eApBxBO,EAAA,CAA8BR,ICKjBU,GAAb,SAAAL,GAKE,SAAAK,EAAYT,EAAWU,GAAS,IAAAluB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAAuuB,IAC9BjuB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAyuB,GAAApR,KAAAnd,KAAM8tB,KAJRZ,eAAgB,EAKd5sB,EAAKkuB,QAAUA,EACfluB,EAAKwtB,UAAUjb,MAAMuV,QAAU,GAC/B9nB,EAAK+X,MAJyB/X,EALlC,OAAAR,OAAAsd,EAAA,EAAAtd,CAAAyuB,EAAAL,GAAApuB,OAAA2a,EAAA,EAAA3a,CAAAyuB,EAAA,EAAA7T,IAAA,YAAApL,MAAA,SAYYgO,GACR,OAAItd,KAAKktB,eACPltB,KAAK8tB,UAAUtpB,IAAI,2CACZ,IAAIiqB,GAAIzuB,KAAK8tB,aAEtB9tB,KAAK8tB,UAAUtpB,IAAI,6BACnBxE,KAAK0uB,aAAe,IAAID,GAAIzuB,KAAK8tB,WAC1B9tB,QAnBX,CAAA0a,IAAA,cAAApL,MAAA,SAsBcgO,GACV,OAAItd,KAAKktB,eACPltB,KAAK8tB,UAAUtpB,IAAI,gDACZ,IAAI6pB,GAASruB,KAAK8tB,aAE3B9tB,KAAK8tB,UAAUtpB,IAAI,kCACnBxE,KAAK0uB,aAAe,IAAIL,GAASruB,KAAK8tB,WAC/B9tB,QA7BX,CAAA0a,IAAA,mBAAApL,MAAA,SAgCmBgO,GAoBf,OAnBAtd,KAAKktB,eAAgB,EAmBd,IAAIuB,GAAIzuB,KAAK8tB,aApDxB,CAAApT,IAAA,cAAApL,MAAA,SAuDcgO,GACV,OAAO,IAAI2Q,GAAIjuB,KAAK8tB,aAxDxB,CAAApT,IAAA,MAAApL,MAAA,WA4DI,IAAIuD,EAAQ7S,KAAK8tB,UAAUjb,MACvBmU,EAAMnU,EAAMsV,IAAInB,IACpBziB,QAAQC,IAAIwiB,GACZnU,EAAMgV,MAAM,GAAG7G,IAAIvB,KAAKuH,EAAI3K,IAAIV,QAAQiG,eAAeoF,EAAIvK,QAC3DlY,QAAQC,IAAIkX,EAAQsL,EAAI3K,MACxB,IAAIqD,EAAOhE,EAAQsL,EAAI3K,KAAKuF,eACzBoF,EAAIvK,MAAQuK,EAAI1K,eAAiB,EAAK,GAEzCoD,EAAKlN,EAAuB,GAAjBwU,EAAIzK,WAAkB,EACjC1J,EAAMgV,MAAM,GAAGnI,KAAKD,KAAKC,GACzB7M,EAAMsV,IAAInB,IAAIvK,MAAQ,MAtE1B8R,EAAA,CAA8BV,ICFjBY,GAAb,SAAAP,GAGE,SAAAO,EAAYX,GAAW,IAAAxtB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAAyuB,IACrBnuB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAA2uB,GAAAtR,KAAAnd,KAAM8tB,KAHRQ,MAAQ,KAINhuB,EAAKwtB,UAAUjb,MAAMsV,IAAIR,OAAOrnB,EAAKwtB,UAAUjb,MAAMgV,MAAM,GAAGzL,KAC9D9b,EAAKwtB,UAAUjb,MAAMsV,IAAInB,IAAIvK,MAAQ,EACrCnc,EAAKwtB,UAAUxT,KAAKqP,OAAOjY,KAAOpR,EAAKwtB,UAAUxT,KAAKqP,OAAOgF,QAJxCruB,EAHzB,OAAAR,OAAAsd,EAAA,EAAAtd,CAAA2uB,EAAAP,GAAApuB,OAAA2a,EAAA,EAAA3a,CAAA2uB,EAAA,EAAA/T,IAAA,cAAApL,MAAA,SAUc8d,GACV,OAAQA,EAAM1S,KACZ,IAAK,YACH1a,KAAK8tB,UAAUjb,MAAMsV,IAAIyG,WAAWxB,EAAMpU,EAAIhZ,KAAKsuB,OACnD,MACF,IAAK,aACHtuB,KAAK8tB,UAAUjb,MAAMsV,IAAIyG,UAAUxB,EAAMpU,EAAIhZ,KAAKsuB,OAClD,MACF,IAAK,YACHtuB,KAAK8tB,UAAUjb,MAAMsV,IAAI0G,cAAczB,EAAMpU,EAAIhZ,KAAKsuB,OACtD,MACF,IAAK,UACHtuB,KAAK8tB,UAAUjb,MAAMsV,IAAI0G,aAAazB,EAAMpU,EAAIhZ,KAAKsuB,OACrD,MACF,IAAK,iBACHtuB,KAAK8tB,UAAUjb,MAAMsV,IAAI2G,WAAW1B,EAAMpU,EAAIhZ,KAAKsuB,OACnD,MACF,IAAK,kBACHtuB,KAAK8tB,UAAUjb,MAAMsV,IAAI2G,YAAY1B,EAAMpU,EAAIhZ,KAAKsuB,OACpD,MACF,IAAK,QACHtuB,KAAK8tB,UAAUjb,MAAMsV,IAAI4G,YAAY3B,EAAMpU,EAAIhZ,KAAKsuB,MAAQ,GAC5D,MACF,IAAK,UACH,OAAOtuB,KAAKqY,MACd,QACE,OAAOrY,KAEX,OAAOA,OAtCX,CAAA0a,IAAA,MAAApL,MAAA,WA0CI,OAAO,IAAIif,GAASvuB,KAAK8tB,WAAW,KA1CxC,CAAApT,IAAA,cAAApL,MAAA,SA6CcgO,GACV,OAAO,IAAI2Q,GAAIjuB,KAAK8tB,eA9CxBW,EAAA,CAAyBZ,ICGZjB,GAAb,SAAAsB,GAAA,SAAAtB,IAAA,OAAA9sB,OAAAC,EAAA,EAAAD,CAAAE,KAAA4sB,GAAA9sB,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAA8sB,GAAAuB,MAAAnuB,KAAAouB,YAAA,OAAAtuB,OAAAsd,EAAA,EAAAtd,CAAA8sB,EAAAsB,GAAApuB,OAAA2a,EAAA,EAAA3a,CAAA8sB,EAAA,EAAAlS,IAAA,cAAApL,MAAA,SACcgO,GAEV,OAAO,IAAImR,GAAIzuB,KAAK8tB,aAHxB,CAAApT,IAAA,cAAApL,MAAA,SAMcgO,GACV,OAAO,IAAI2Q,GAAIjuB,KAAK8tB,aAPxB,CAAApT,IAAA,cAAApL,MAAA,SAUcuN,GAEV,OADA7c,KAAK8tB,UAAUjb,MAAMuP,qBAAqBvF,EAAMD,MACzC,IAAIyR,GAASruB,KAAK8tB,eAZ7BlB,EAAA,CAA0BiB,ICNbmB,GAAb,WAoBE,SAAAA,IAAc,IAAA1uB,EAAAN,KAAAF,OAAAC,EAAA,EAAAD,CAAAE,KAAAgvB,GAAAhvB,KAnBdivB,QAAU,GAmBIjvB,KAlBdkvB,SAAW,GAkBGlvB,KAIdmvB,QAAU,SAAAvR,GACRA,EAAIA,GAAKwR,OAAOvS,MAChBvc,EAAK2uB,QAAQrR,EAAEyR,OAAQ,EACvBzR,EAAE0R,4BAPUtvB,KAUduvB,MAAQ,SAAA3R,GACNA,EAAIA,GAAKwR,OAAOvS,aACTvc,EAAK2uB,QAAQrR,EAAEyR,MACtB/uB,EAAK4uB,SAAStR,EAAEyR,OAAQ,EACxBzR,EAAE0R,4BAbFtvB,KAAKwvB,cArBT,OAAA1vB,OAAA2a,EAAA,EAAA3a,CAAAkvB,EAAA,EAAAtU,IAAA,YAAApL,MAAA,SAIY0J,GACR,IAAIyW,EAAO3vB,OAAO2vB,KAAKzvB,KAAKivB,SACzBS,OAAO,SAAAhV,GAAG,OAAK,YAAYiV,KAAKjV,KAChCgV,OAAO,SAAAhV,GAAG,OAAK,cAAciV,KAAKjV,KACjC2S,EAAQvtB,OAAO2vB,KAAKzvB,KAAKivB,SAAStG,KAAK,SAAAjO,GAAG,MAAI,YAAYiV,KAAKjV,KAC/DkV,EAAU9vB,OAAO2vB,KAAKzvB,KAAKivB,SAAStG,KAAK,SAAAjO,GAAG,MAAI,cAAciV,KAAKjV,KACnEmV,EAASJ,EAAKxH,IAChB,SAAAvN,GAAG,OAAI,IAAIoC,EAAM8S,EAAU5W,EAAI,EAAIA,EAAGqU,EAAQ,QAAU3S,EAAMA,KAMhE,OAJA5a,OAAO2vB,KAAKzvB,KAAKkvB,UAAUrL,QAAQ,SAAAnJ,GAAG,OACpCmV,EAAO7f,KAAK,IAAI8M,EAAM9D,EAAG0B,EAAM,SAEjC1a,KAAKkvB,SAAW,GACTW,MAjBX/vB,OAAA2a,EAAA,EAAA3a,CAAAkvB,EAAA,EAAAtU,IAAA,cAAApL,MAAA,WAsCIwgB,SAASnY,iBAAiB,UAAW3X,KAAKmvB,SAC1CW,SAASnY,iBAAiB,QAAS3X,KAAKuvB,WAvC5CP,EAAA,GC0Gee,eAvGX,SAAAA,EAAaC,GAAO,IAAA1vB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAA+vB,IAChBzvB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAiwB,GAAA5S,KAAAnd,KAAMgwB,KAoCVC,WAAa,SAAE7X,KArCK9X,EAyCpB+O,aAAe,SAACC,GACZhP,EAAK4vB,MAAM7gB,aAAaC,IA1CRhP,EA6CpB6vB,aAAe,SAAEvS,GAAO,IACZ3M,EAAkB2M,EAAlB3M,OAAQZ,EAAUuN,EAAVvN,MAChB/P,EAAK4vB,MAAM9Y,gBAAgB/G,EAAOY,IA/ClB3Q,EAsDpB6W,YAAc,SAACnL,GACX1L,EAAK4vB,MAAM/Y,YAAYnL,IAvDP1L,EA0DpByZ,eAAiB,WACbzZ,EAAK4vB,MAAMnW,kBA3DKzZ,EA8DpByT,qBAAuB,SAACC,GACpB1T,EAAK4vB,MAAMnc,qBAAqBC,IA/DhB1T,EAkEpB8vB,kBAAoB,WAChB7rB,QAAQC,IAAIlE,EAAK+vB,aAAavX,SAC9B,IAAIwX,EAAc,IAAInE,GAClB7rB,EAAK+vB,aAAavX,QAClB,SAAAyX,MAEJD,EAAYjE,WAAWrc,KAAK,IAAI+d,IAEhC,IAAIyC,EAAW,IAAIxB,GAEfyB,EAAWlE,YAAYC,OAE3B,SAASkE,IACL,IAAI1X,EAAIuT,YAAYC,MAAQiE,EAC5BA,EAAWlE,YAAYC,MACVgE,EAASG,UAAU3X,GACzB6K,QAAQ,SAAA9T,GAAC,OAAIugB,EAAYlE,WAAWpc,KAAKD,KAChD2d,sBAAsB,SAAA1U,GAClB0X,MAGRA,GACAJ,EAAY3C,QAAQpB,YAAYC,QArFhClsB,EAAK2gB,MAAQ,CACT2P,UAAU,GAGdtwB,EAAK4vB,MAAQ,IAAInhB,EACbzO,EAAK0vB,MAAMhhB,KACX1O,EAAK0vB,MAAM/gB,eACX3O,EAAK0vB,MAAM9gB,YACX,CACIiH,gBAAiB,CACbzB,EAAGpU,EAAK0vB,MAAM7Z,gBAAgBzB,EAC9BlC,EAAGlS,EAAK0vB,MAAM7Z,gBAAgB3D,GAElC4D,iBAAkB,CACd1B,EAAGpU,EAAK0vB,MAAM5Z,iBAAiB1B,EAC/BlC,EAAGlS,EAAK0vB,MAAM5Z,iBAAiB5D,GAEnC6D,cAAe,CACX3B,EAAGpU,EAAK0vB,MAAM3Z,cAAc3B,EAC5BlC,EAAGlS,EAAK0vB,MAAM3Z,cAAc7D,IAGpC,CACIyB,QAAS3T,EAAK0vB,MAAM/b,QACpBC,SAAU5T,EAAK0vB,MAAM9b,SACrBC,YAAa7T,EAAK0vB,MAAM7b,YACxBC,QAAS9T,EAAK0vB,MAAM5b,QACpB+F,MAAO7Z,EAAK0vB,MAAM7V,QAI1B7Z,EAAK+vB,aAAe,IAAIQ,IAAMC,UAlCdxwB,0EAkDRywB,GACR/wB,KAAKkwB,MAAMle,WAAW+e,oCAwCtB,OACIC,EAAAxK,EAAAyK,cAAA,OAAKC,IAAKlxB,KAAKqwB,aAAcc,MAAO,CAACxG,OAAO,OAAQD,MAAM,OAAQ0G,QAAQ,kBA7FxDP,IAAMhyB,4BCHfwyB,sBACjB,SAAAA,EAAarB,GAAO,IAAA1vB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAAqxB,IAChB/wB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAuxB,GAAAlU,KAAAnd,KAAMgwB,KAMVsB,0BAA4B,SAACtB,GAAU,IAC5B1gB,EAAS0gB,EAAT1gB,MACPhP,EAAKixB,SAAS,CAACjiB,MAAMA,KATLhP,EAYpBkxB,YAAc,SAACliB,GACXhP,EAAKixB,SAAS,CAACjiB,MAAMA,IACrBhP,EAAK0vB,MAAMyB,SAASnxB,EAAK0vB,MAAM0B,QAASpiB,IAdxBhP,EAiBpBqxB,cAAgB,SAACzxB,GACb,IAAMoP,EAAQpP,EAAI0xB,OAAOtiB,MACzBhP,EAAKkxB,YAAYliB,IAnBDhP,EAsBpBuxB,eAAiB,WACb,IAAIC,EAAexxB,EAAK2gB,MAAM3R,MADXyiB,EAECzxB,EAAK0vB,MAAnBxI,EAFauK,EAEbvK,IAAKiF,EAFQsF,EAERtF,UACExZ,IAATwZ,IAAoBA,EAAO,KAE/BqF,GAA6B,GAAbA,GADhBrF,GAAQ,KACgC,IACpBjF,IAAKsK,EAAetK,GACxClnB,EAAKkxB,YAAYM,IA7BDxxB,EAgCpB0xB,cAAgB,WACZ,IAAIF,EAAexxB,EAAK2gB,MAAM3R,MADZ2iB,EAEE3xB,EAAK0vB,MAAnBjD,EAFYkF,EAEZlF,IAAKN,EAFOwF,EAEPxF,UACExZ,IAATwZ,IAAoBA,EAAO,KAE/BqF,GAA6B,GAAbA,GADhBrF,GAAQ,KACgC,IACrBM,IAAK+E,EAAe/E,GACvCzsB,EAAKkxB,YAAYM,IArCjBxxB,EAAK2gB,MAAQ,CACT3R,MAAOhP,EAAK0vB,MAAM1gB,MAAMhP,EAAK0vB,MAAM1gB,MAAM,GAH7BhP,wEA0CV,IAEFgP,EACAtP,KAAKihB,MADL3R,MAFE4iB,EAYFlyB,KAAKgwB,MANLmC,EANED,EAMFC,eACAC,EAPEF,EAOFE,MACA5K,EARE0K,EAQF1K,IACAuF,EATEmF,EASFnF,IACAsF,EAVEH,EAUFG,QACA5F,EAXEyF,EAWFzF,KAGJ,YADaxZ,IAATwZ,IAAoBA,EAAO,IAE3BuE,EAAAxK,EAAAyK,cAAA,OAAKqB,UAAWH,GACZnB,EAAAxK,EAAAyK,cAAA,OAAKE,MAAO,CAACC,QAAQ,SACjBJ,EAAAxK,EAAAyK,cAACsB,GAAA,EAAD,CACIC,KAAMC,KACNH,UAAU,mBACVI,QAAS1yB,KAAK6xB,iBAElBb,EAAAxK,EAAAyK,cAAA,QAAME,MAAO,CAACwB,KAAK,EAAGC,UAAU,WAC3BR,EACDpB,EAAAxK,EAAAyK,cAAA,kBAAU3hB,EAAO+iB,IAErBrB,EAAAxK,EAAAyK,cAACsB,GAAA,EAAD,CACIC,KAAMK,KACNP,UAAU,mBACVI,QAAS1yB,KAAKgyB,iBAGtBhB,EAAAxK,EAAAyK,cAAA,SACI5iB,KAAK,QACLmZ,IAAKA,EACLuF,IAAKA,EACLzd,MAAOA,EACPgjB,UAAU,SACV7F,KAAMA,EACNqG,SAAU9yB,KAAK2xB,wBAlFMd,IAAMhyB,YC4LhCk0B,UCnLmClC,IAAMhyB,sBDSpD,SAAAk0B,IAAe,IAAAzyB,EAAA,OAAAR,OAAAC,EAAA,EAAAD,CAAAE,KAAA+yB,IACXzyB,EAAAR,OAAAmd,EAAA,EAAAnd,CAAAE,KAAAF,OAAAod,EAAA,EAAApd,CAAAizB,GAAA5V,KAAAnd,QAkBJgzB,mBAAqB,WACjB1yB,EAAK2yB,sBApBM3yB,EAsBf2yB,mBAAqB,WACjB,IAAIC,EAAO,CACP,yBACA,MACA,IACA,MACA,IACA,IACA,qBACA,qBACA,qBACA,qBACA,sBACA,wBACA,oBACA,oBACA,sBACA,yBACA,uBA6BAja,EAAM,CACNjK,KA5BO,IA6BPiF,QA3BUkf,WAAWD,EAAKxzB,IA4B1BwU,SA1BWif,WAAWD,EAAKzzB,IA2B3B0U,YAzBcgf,WAAWD,EAAKvzB,IA0B9ByU,QAxBU+e,WAAWD,EAAKtzB,IAyB1Bua,MAvBQgZ,WAAWD,EAAK1zB,IAwBxB2W,gBAtBkB,CAClBzB,EAAGye,WAAWD,EAAKh0B,IACnBsT,EAAG2gB,WAAWD,EAAK/zB,KAqBnBiX,iBAlBmB,CACnB1B,EAAGye,WAAWD,EAAK9zB,IACnBoT,EAAG2gB,WAAWD,EAAK7zB,KAiBnBgX,cAdgB,CAChB3B,EAAGye,WAAWD,EAAK5zB,IACnBkT,EAAG2gB,WAAWD,EAAK3zB,MAevBe,EAAKixB,SAAStY,IAjFH3Y,EAoFf8yB,wBAA0B,SAACC,GACvB/yB,EAAKixB,SAAS,CAACriB,YAAamkB,IAC5B/yB,EAAKgzB,UAAUxa,QAAQ9G,WAAWqhB,IAtFvB/yB,EAyFfizB,iBAAmB,SAACjkB,GAChBhP,EAAKixB,SAAS,CAACiC,SAAUlkB,IACzBhP,EAAKgzB,UAAUxa,QAAQ3B,YAAY7H,IA3FxBhP,EA8FfmzB,iBAAmB,SAACnkB,GAChBhP,EAAKixB,SAAS,CAACX,SAAUthB,IACzBhP,EAAKgzB,UAAUxa,QAAQzJ,aAAaC,IAhGzBhP,EAmGfozB,cAAgB,WACZpzB,EAAKgzB,UAAUxa,QAAQiB,kBApGZzZ,EAuGfqzB,wBAA0B,SAAC3f,GACvB1T,EAAKgzB,UAAUxa,QAAQ/E,qBAAqBC,IAxGjC1T,EA2Gf8vB,kBAAoB,aAxGhB9vB,EAAK2gB,MAAQ,CACT/R,YAAc,KACdskB,UAAW,EACX5C,UAAU,EACV5hB,KAAM,IACNiF,QAAS,GACTC,SAAU,EACVC,aAAc,IACdC,QAAS,IACT+F,MAAO,IACPhE,gBAAiB,GACjBC,iBAAkB,GAClBC,cAAe,IAEnB/V,EAAKgzB,UAAYzC,IAAMC,YAjBZxwB,wEA8GL,IAAAszB,EAiBF5zB,KAAKihB,MAfL/R,EAFE0kB,EAEF1kB,YAKAF,GAPE4kB,EAIFJ,SAJEI,EAKFhD,SALEgD,EAOF5kB,MACAiF,EARE2f,EAQF3f,QACAC,EATE0f,EASF1f,SACAC,EAVEyf,EAUFzf,YACAC,EAXEwf,EAWFxf,QACA+F,EAZEyZ,EAYFzZ,MAEAhE,EAdEyd,EAcFzd,gBACAC,EAfEwd,EAeFxd,iBACAC,EAhBEud,EAgBFvd,cAEJ,OACI2a,EAAAxK,EAAAyK,cAAA,OAAKqB,UAAU,uBAKXtB,EAAAxK,EAAAyK,cAAC4C,GAAD,CACI5kB,eAAgBjP,KAAKgwB,MAAM/gB,eAC3BiiB,IAAKlxB,KAAKszB,UAEVtkB,KAAMA,EACNE,YAAaA,EACb+E,QAAWA,EACXC,SAAYA,EACZC,YAAeA,EACfC,QAAWA,EACX+F,MAASA,EAEThE,gBAAmBA,EACnBC,iBAAoBA,EACpBC,cAAiBA,YArJRwa,IAAMhyB,YERpBi1B,OAVf,WACE,OACE9C,EAAAxK,EAAAyK,cAAA,OAAKqB,UAAU,uBACbtB,EAAAxK,EAAAyK,cAAC8C,GAAD,CACE9kB,eAAe,gBCGH+kB,QACW,cAA7B5E,OAAO6E,SAASC,UAEe,UAA7B9E,OAAO6E,SAASC,UAEhB9E,OAAO6E,SAASC,SAASC,MACvB,2DCZNC,IAAS3c,OAAOuZ,EAAAxK,EAAAyK,cAACoD,GAAD,MAASvE,SAASwE,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,KAAK,SAAAC,GACjCA,EAAaC","file":"static/js/main.924962ea.chunk.js","sourcesContent":["import React, { Component } from 'react'\r\nimport './styles.css';\r\nexport default class ViewSelector extends Component {\r\n    constructor (props) {\r\n        super(props);\r\n        this.viewSelectorItemClicked = this.viewSelectorItemClicked.bind(this);\r\n    }\r\n\r\n    viewSelectorItemClicked (item) {\r\n        if(typeof this.props.viewSelectorItemClicked === 'function'){\r\n            this.props.viewSelectorItemClicked(item);\r\n        }\r\n    }\r\n\r\n    render () {\r\n        let _self = this;\r\n        let str2Dclass = \"view-selector-item\";\r\n        let str3Dclass = \"view-selector-item\";\r\n\r\n        if (this.props.currentView === '2d') {\r\n            str2Dclass += \" active\";\r\n        } else {\r\n            str3Dclass += \" active\";\r\n        }\r\n        return (\r\n            <div className=\"view-selector\">\r\n                <span\r\n                    className={str2Dclass}\r\n                    onClick={function () { _self.viewSelectorItemClicked('2d') }}\r\n                >2D</span>\r\n                <span\r\n                    className={str3Dclass}\r\n                    onClick={function () { _self.viewSelectorItemClicked('3d') }}\r\n                >3D</span>\r\n            </div>\r\n        )\r\n    }\r\n}","// model files\r\nexport const fileTableModel = \"table.babylon\";\r\nexport const fileBatModel = \"bat.babylon\";\r\nexport const TABLE_LENGTH = 396; //pixel\r\n// end model files\r\n\r\n// for simulator\r\nexport const BALL_SIZE = 5.715; // cm\r\n\r\nexport const ballMass = 0.17;\r\n\r\nexport const linearSpeedDampingRate = 0.9;\r\nexport const angularSpeedDampingRate = 0.9;\r\nexport const rollingRate = 0.5;\r\nexport const perpendicularForceRate = 0.3;\r\nexport const CONSTANTS_SPEED_NORMAL = {\r\n    timeStep: 0.01666,\r\n    gravityRate: 0.16,\r\n    // gravityRate: 0.72,\r\n    forceMagnitude: 0.2,\r\n\r\n    ballFriction: 0.8, //u\r\n    ballRestitution: 0.95, //e\r\n\r\n    ballNativeOptions: {\r\n\r\n    },\r\n\r\n    carpetFriction: 0.9, //u\r\n    carpetRestitution: 0.5, //e\r\n\r\n    carpetRailFriction: 0.2, // u\r\n    carpetRailRestitution: 0.98, //e\r\n}\r\n\r\nexport const maxDelta = 0.5;\r\n// end for simulator\r\n\r\n// get data from server\r\nexport const INDEX_SIZE = 3;\r\nexport const INDEX_WHITE_X = 6;\r\nexport const INDEX_WHITE_Y = 7;\r\nexport const INDEX_YELLOW_X = 8;\r\nexport const INDEX_YELLOW_Y = 9;\r\nexport const INDEX_TARGET_X = 10;\r\nexport const INDEX_TARGET_Y = 11;\r\nexport const INDEX_SPEED = 12;\r\nexport const INDEX_CUEANGLE = 13;\r\nexport const INDEX_CUELINE = 14;\r\nexport const INDEX_SIDEENGLISH = 15;\r\nexport const INDEX_TOPSPIN = 16;\r\n// end get data for server","export default class son {\r\n    played;\r\n    intensite;\r\n    type_choc;\r\n    temps;\r\n\r\n    constructor () {\r\n        this.played = false;\r\n        return;\r\n    }\r\n}","export default class evt {\r\n    RAp;\r\n    RAr;\r\n    RAq;\r\n    time;\r\n    X;\r\n    Y;\r\n\r\n    constructor () {\r\n        return;\r\n    }\r\n}","import son from './son';\r\nimport evt from './evt';\r\n\r\nexport default class Simul {\r\n    delta_fgpas = 0.004375;\r\n    Y0;\r\n    RArfin;\r\n    r0;\r\n    Yfin;\r\n    e_s;\r\n    VQx;\r\n    first_bille_choquee;\r\n    nb_sons;\r\n    RAp;\r\n    RAr;\r\n    VQy;\r\n    RSG = 1;\r\n    etat;\r\n    RAp0;\r\n    RAq;\r\n    VRp;\r\n    VRq;\r\n    VRr;\r\n    YMIN;\r\n    fgpas = 0.00125;\r\n    nb_max_sons;\r\n    EPSILON = 0.86;\r\n    YMAX;\r\n    RApfin;\r\n    R;\r\n    D;\r\n    effet;\r\n    frpas = 3e-005;\r\n    Y;\r\n    vqueue;\r\n    RAq0;\r\n    duree;\r\n    alph;\r\n    X;\r\n    Rq;\r\n    Rr;\r\n    deltaVN;\r\n    RAr0;\r\n    beta_gliss;\r\n    Rp;\r\n    VN0;\r\n    sorties;\r\n    calculs_finis;\r\n    Vinit;\r\n    QCQ = 2;\r\n    nb_max_clefs;\r\n    Rfppas = 7.5e-005;\r\n    f1 = 0.25;\r\n    f2 = 0.42;\r\n    d13;\r\n    Vx0;\r\n    done;\r\n    eff_s;\r\n    deltaclef;\r\n    Rfp = 0.15;\r\n    nb_clefs;\r\n    fbille = 0.05;\r\n    nbandes;\r\n    pas = 0.0005;\r\n    VMz;\r\n    fp1 = 0.2;\r\n    RAqfin;\r\n    intens;\r\n    resolution;\r\n    er;\r\n    alpha_bande;\r\n    ARRET = 0;\r\n    TSP = 3;\r\n    date;\r\n    el;\r\n    VN;\r\n    RendementChoc;\r\n    Vy0;\r\n    VT;\r\n    p0;\r\n    fg = 2.5;\r\n    evts_son;\r\n    Xfin;\r\n    fr = 0.06;\r\n    DateMax;\r\n    beta_adh;\r\n    distance13;\r\n    XMIN;\r\n    choc13;\r\n    X0;\r\n    choc12;\r\n    Vx;\r\n    Vy;\r\n    q0;\r\n    XMAX;\r\n    evts;\r\n    nb_b_avant;\r\n    deltaclefRot;\r\n    beta;\r\n    nb3;\r\n\r\n    constructor (param1, param2)\r\n    {\r\n        var _loc_3 = 0;\r\n        this.XMAX = param1;\r\n        this.YMAX = param2;\r\n        this.XMIN = -param1;\r\n        this.YMIN = -param2;\r\n        this.nb_max_clefs = 10000;\r\n        this.nb_clefs = [];\r\n        var _loc_4 = 0;\r\n        this.nb_clefs[2] = 0;\r\n        this.nb_clefs[1] = _loc_4;\r\n        this.nb_clefs[0] = _loc_4;\r\n        \r\n        this.evts = [];\r\n        this.nb_max_sons = 50;\r\n        this.nb_sons = 0;\r\n        this.evts_son = [];\r\n        this.sorties = [];\r\n        this.eff_s = [];\r\n        this.etat = [];\r\n        this.X0 = [];\r\n        this.Y0 = [];\r\n        this.X = [];\r\n        this.Y = [];\r\n        this.Xfin = [];\r\n        this.Yfin = [];\r\n        this.RAp = [];\r\n        this.RAq = [];\r\n        this.RAr = [];\r\n        this.RAp0 = [];\r\n        this.RAq0 = [];\r\n        this.RAr0 = [];\r\n        this.RApfin = [];\r\n        this.RAqfin = [];\r\n        this.RArfin = [];\r\n        this.Vx = [];\r\n        this.Vy = [];\r\n        this.Rp = [];\r\n        this.Rq = [];\r\n        this.Rr = [];\r\n        this.VQx = [];\r\n        this.VQy = [];\r\n        this.etat = [];\r\n        this.D = 0.06;\r\n        this.R = 0.03;\r\n        this.RendementChoc = 0.8;\r\n        this.deltaclefRot = this.R * Math.PI / 10;\r\n        this.resolution = 0.01;\r\n        this.done = false;\r\n        this.sorties[0] = 0;\r\n        this.sorties[1] = 0;\r\n        this.sorties[2] = 0;\r\n        this.sorties[3] = 7.5;\r\n        this.sorties[4] = 7.5;\r\n        this.sorties[5] = 7.5;\r\n        this.sorties[6] = 16;\r\n        this.sorties[7] = 16;\r\n        this.sorties[8] = 16;\r\n        this.sorties[9] = 33;\r\n        this.sorties[10] = 32;\r\n        this.sorties[11] = 23.5;\r\n        this.sorties[12] = 52;\r\n        this.sorties[13] = 43;\r\n        this.sorties[14] = 31;\r\n        this.sorties[15] = 72;\r\n        this.sorties[16] = 53;\r\n        this.sorties[17] = 35;\r\n        this.sorties[18] = 86;\r\n        this.sorties[19] = 60;\r\n        this.sorties[20] = 38;\r\n        this.sorties[21] = 100;\r\n        this.sorties[22] = 69;\r\n        this.sorties[23] = 44;\r\n        this.sorties[24] = 108;\r\n        this.sorties[25] = 79;\r\n        this.sorties[26] = 53;\r\n        this.sorties[27] = 120;\r\n        this.sorties[28] = 90;\r\n        this.sorties[29] = 60;\r\n        this.eff_s[0] = -1.5;\r\n        this.eff_s[1] = 0;\r\n        this.eff_s[2] = 1.5;\r\n        this.eff_s[3] = -1.5;\r\n        this.eff_s[4] = 0.5;\r\n        this.eff_s[5] = 1.2;\r\n        this.eff_s[6] = -1.3;\r\n        this.eff_s[7] = 0.7;\r\n        this.eff_s[8] = 1.3;\r\n        this.eff_s[9] = -0.5;\r\n        this.eff_s[10] = 1.3;\r\n        this.eff_s[11] = 1.2;\r\n        this.eff_s[12] = -0.5;\r\n        this.eff_s[13] = 1.3;\r\n        this.eff_s[14] = 1.1;\r\n        this.eff_s[15] = -0.3;\r\n        this.eff_s[16] = 0.8;\r\n        this.eff_s[17] = 1.2;\r\n        this.eff_s[18] = 0;\r\n        this.eff_s[19] = 0.7;\r\n        this.eff_s[20] = 1.2;\r\n        this.eff_s[21] = 0;\r\n        this.eff_s[22] = 0.5;\r\n        this.eff_s[23] = 1.5;\r\n        this.eff_s[24] = -0.6;\r\n        this.eff_s[25] = 0.2;\r\n        this.eff_s[26] = 1.5;\r\n        this.eff_s[27] = -0.65;\r\n        this.eff_s[28] = 0;\r\n        this.eff_s[29] = 1.5;\r\n        return;\r\n    }// end function\r\n\r\n    choc_bande = (param1) => {\r\n        var _loc_2 = NaN;\r\n        if (this.X[param1] > this.XMIN && this.X[param1] < this.XMAX && this.Y[param1] > this.YMIN && this.Y[param1] < this.YMAX)\r\n        {\r\n            return false;\r\n        }\r\n        if (this.X[param1] < this.XMIN && this.Vx[param1] > 0)\r\n        {\r\n            return false;\r\n        }\r\n        if (this.X[param1] > this.XMAX && this.Vx[param1] < 0)\r\n        {\r\n            return false;\r\n        }\r\n        if (this.Y[param1] > this.YMAX && this.Vy[param1] < 0)\r\n        {\r\n            return false;\r\n        }\r\n        if (this.Y[param1] < this.YMIN && this.Vy[param1] > 0)\r\n        {\r\n            return false;\r\n        }\r\n        if (param1 == 0)\r\n        {\r\n            if (!this.choc12 || !this.choc13)\r\n            {\r\n                var _loc_3 = this;\r\n                var _loc_4 = this.nbandes + 1;\r\n                _loc_3.nbandes = _loc_4;\r\n                if (!this.choc12 && !this.choc13)\r\n                {\r\n                    var _loc_3 = this;\r\n                    var _loc_4 = this.nb_b_avant + 1;\r\n                    _loc_3.nb_b_avant = _loc_4;\r\n                }\r\n            }\r\n        }\r\n        if (this.etat[param1] == this.RSG)\r\n        {\r\n            this.Rp[param1] = -this.Vy[param1];\r\n            this.Rq[param1] = this.Vx[param1];\r\n        }\r\n        else if (this.etat[param1] == this.QCQ)\r\n        {\r\n            this.Rp[param1] = -this.Vy[param1] + this.VQy[param1];\r\n            this.Rq[param1] = this.Vx[param1] - this.VQx[param1];\r\n        }\r\n        this.init_pars(param1);\r\n        this.VMz = this.VT - this.VRr;\r\n        this.VN0 = -this.VN;\r\n        this.VN = this.VN * (-this.EPSILON);\r\n        this.deltaVN = this.VN0 + this.VN;\r\n        this.intens = this.VN0 / 20;\r\n        if (this.intens > 1)\r\n        {\r\n            this.intens = 1;\r\n        }\r\n        this.beta_adh = 2 / 7 * Math.sqrt(this.VMz * this.VMz + this.VRq * this.VRq);\r\n        this.beta_gliss = this.f1 * this.deltaVN;\r\n        if (Math.abs(this.VMz) < 1e-005)\r\n        {\r\n            this.alpha_bande = Math.PI / 2;\r\n        }\r\n        else\r\n        {\r\n            this.alpha_bande = Math.abs(Math.atan(this.VRq / this.VMz));\r\n        }\r\n        _loc_2 = Math.abs(this.fp1 * this.deltaVN);\r\n        if (Math.abs(this.VRp) < _loc_2)\r\n        {\r\n            this.VRp = 0;\r\n        }\r\n        else if (this.VRp > 0)\r\n        {\r\n            this.VRp = this.VRp - _loc_2;\r\n        }\r\n        else\r\n        {\r\n            this.VRp = this.VRp + _loc_2;\r\n        }\r\n        _loc_2 = Math.abs(this.f2 * this.deltaVN);\r\n        this.VRq = this.VRq + _loc_2;\r\n        if (this.beta_gliss > this.beta_adh)\r\n        {\r\n            this.choc_adh(param1);\r\n        }\r\n        else\r\n        {\r\n            this.choc_gliss(param1);\r\n        }\r\n        this.recup_pars(param1);\r\n        this.VQx[param1] = this.Vx[param1] - this.Rq[param1];\r\n        this.VQy[param1] = this.Vy[param1] + this.Rp[param1];\r\n        this.etat[param1] = this.QCQ;\r\n        return true;\r\n    }// end function\r\n\r\n    fin_parcours = () => {\r\n        var _loc_1 = 0;\r\n        _loc_1 = 0;\r\n        while (_loc_1 < 3)\r\n        {\r\n            if (this.etat[_loc_1] != this.ARRET)\r\n            {\r\n                if (this.Vx[_loc_1] * this.Vx[_loc_1] + this.Vy[_loc_1] * this.Vy[_loc_1] < this.frpas * this.frpas)\r\n                {\r\n                    if (Math.abs(this.Rr[_loc_1]) < this.Rfppas)\r\n                    {\r\n                        this.etat[_loc_1] = this.ARRET;\r\n                        var _loc_2 = 0;\r\n                        this.Vy[_loc_1] = 0;\r\n                        this.Vx[_loc_1] = _loc_2;\r\n                        var _loc_2 = 0;\r\n                        this.Rr[_loc_1] = 0;\r\n                        this.Rq[_loc_1] = _loc_2;\r\n                        this.Rp[_loc_1] = _loc_2;\r\n                    }\r\n                    else\r\n                    {\r\n                        this.etat[_loc_1] = this.TSP;\r\n                        return false;\r\n                    }\r\n                }\r\n                else\r\n                {\r\n                    return false;\r\n                }\r\n            }\r\n            _loc_1++;\r\n        }\r\n        return true;\r\n    }// end function\r\n\r\n    Calcul = (param1) => {\r\n        console.log('parameter', param1)\r\n        var _loc_2 = 0;\r\n        var _loc_3 = 0;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_8 = NaN;\r\n        var _loc_4 = [];\r\n        _loc_2 = 0;\r\n        while (_loc_2 < 3)\r\n        {\r\n            \r\n            this.nb_clefs[_loc_2] = 0;\r\n            _loc_3 = 0;\r\n            while (_loc_3 < this.nb_max_clefs)\r\n            {\r\n                \r\n                this.evts[this.nb_max_clefs * _loc_2 + _loc_3] = null;\r\n                _loc_3++;\r\n            }\r\n            _loc_2++;\r\n        }\r\n        this.nb_sons = 0;\r\n        _loc_2 = 0;\r\n        while (_loc_2 < this.nb_max_sons)\r\n        {\r\n            \r\n            this.evts_son[_loc_2] = null;\r\n            _loc_2++;\r\n        }\r\n        _loc_2 = 0;\r\n        while (_loc_2 < 3)\r\n        {\r\n            \r\n            this.X[_loc_2] = param1.Xinit[_loc_2];\r\n            this.Y[_loc_2] = param1.Yinit[_loc_2];\r\n            this.RAp[_loc_2] = param1.RApInit[_loc_2];\r\n            this.RAq[_loc_2] = param1.RAqInit[_loc_2];\r\n            this.RAr[_loc_2] = param1.RArInit[_loc_2];\r\n            this.add_clef(_loc_2);\r\n            _loc_2++;\r\n        }\r\n        this.el = param1.el;\r\n        this.er = param1.er;\r\n        this.alph = param1.alphaQ;\r\n        this.beta = param1.betaQ;\r\n        this.vqueue = param1.Vqueue;\r\n        this.calculs_finis = false;\r\n        this.nbandes = 0;\r\n        this.done = false;\r\n        this.distance13 = 2;\r\n        this.first_bille_choquee = 0;\r\n        this.choc12 = false;\r\n        this.choc13 = false;\r\n        this.done = false;\r\n        this.deltaclef = this.resolution;\r\n        this.date = 0;\r\n        this.beta = this.beta + Math.PI;\r\n        this.Vinit = 1.4 * this.vqueue * Math.cos(this.alph / 1.2);\r\n        _loc_5 = -2 * this.Vinit / Math.cos(this.alph / 1.1) * this.er / this.R;\r\n\r\n        var _loc_7 = Math.PI / 20;\r\n        if (this.alph > _loc_7)\r\n        {\r\n            _loc_8 = Math.PI / 2 / (Math.PI / 2 - _loc_7) * (this.alph - _loc_7);\r\n        }\r\n        else\r\n        {\r\n            _loc_8 = 0;\r\n        }\r\n        _loc_6 = 4 * this.vqueue * Math.sin(_loc_8) * this.el / this.R;\r\n        \r\n        this.Vx[0] = this.Vinit * Math.cos(this.beta);\r\n        this.Vx0 = this.Vx[0];\r\n        this.Vy[0] = this.Vinit * Math.sin(this.beta);\r\n        this.Vy0 = this.Vy[0];\r\n        var _loc_9 = _loc_5 * Math.sin(this.beta) + _loc_6 * Math.cos(this.beta);\r\n        this.Rp[0] = _loc_5 * Math.sin(this.beta) + _loc_6 * Math.cos(this.beta);\r\n        this.p0 = _loc_9;\r\n        var _loc_9 = (-_loc_5) * Math.cos(this.beta) + _loc_6 * Math.sin(this.beta);\r\n        this.Rq[0] = (-_loc_5) * Math.cos(this.beta) + _loc_6 * Math.sin(this.beta);\r\n        this.q0 = _loc_9;\r\n        var _loc_9 = 2 * this.el / this.R * this.Vinit;\r\n        this.Rr[0] = 2 * this.el / this.R * this.Vinit;\r\n        this.r0 = _loc_9;\r\n\r\n        this.VQx[0] = this.Vx[0] - this.Rq[0];\r\n        this.VQy[0] = this.Vy[0] + this.Rp[0];\r\n        this.etat[0] = this.QCQ;\r\n\r\n        _loc_2 = 1;\r\n        while (_loc_2 < 3)\r\n        {\r\n            \r\n            this.Vx[_loc_2] = 0;\r\n            this.Vy[_loc_2] = 0;\r\n            this.VQx[_loc_2] = 0;\r\n            this.VQy[_loc_2] = 0;\r\n            this.Rp[_loc_2] = 0;\r\n            this.Rq[_loc_2] = 0;\r\n            this.Rr[_loc_2] = 0;\r\n            this.etat[_loc_2] = this.ARRET;\r\n            this.add_clef(_loc_2);\r\n            _loc_2++;\r\n        }\r\n        this.evts_son[this.nb_sons] = new son();\r\n        this.evts_son[this.nb_sons].played = false;\r\n        this.evts_son[this.nb_sons].temps = 0;\r\n        this.evts_son[this.nb_sons].intensite = this.Vinit / 5.4;\r\n        \r\n        if (this.alph > Math.PI / 4)\r\n        {\r\n            this.evts_son[this.nb_sons].type_choc = 0;\r\n        }\r\n        else\r\n        {\r\n            this.evts_son[this.nb_sons].type_choc = 1;\r\n        }\r\n        // this.nb_sons += 1;\r\n        while (!this.fin_parcours())\r\n        {\r\n            this.date += 1;\r\n            if (this.choc_billes(_loc_4))\r\n            {\r\n            }\r\n            _loc_2 = 0;\r\n            while (_loc_2 < 3)\r\n            {\r\n                if (this.etat[_loc_2] != this.ARRET)\r\n                {\r\n                    if (this.choc_bande(_loc_2))\r\n                    {\r\n                        this.add_clef(_loc_2);\r\n                        this.evts_son[this.nb_sons] = new son();\r\n                        this.evts_son[this.nb_sons].played = false;\r\n                        this.evts_son[this.nb_sons].temps = this.date * this.pas;\r\n                        this.evts_son[this.nb_sons].intensite = this.intens;\r\n                        this.evts_son[this.nb_sons].type_choc = 3;\r\n                        var _loc_9 = this;\r\n                        var _loc_10 = this.nb_sons + 1;\r\n                        _loc_9.nb_sons = _loc_10;\r\n                    }\r\n                    if (this.mise_a_jour(_loc_2))\r\n                    {\r\n                        this.add_clef(_loc_2);\r\n                    }\r\n                }\r\n                if (Math.abs(this.X[_loc_2] - this.X0[_loc_2]) > this.deltaclef || Math.abs(this.Y[_loc_2] - this.Y0[_loc_2]) > this.deltaclef || Math.abs(this.RAp[_loc_2] - this.RAp0[_loc_2]) > this.deltaclefRot || Math.abs(this.RAq[_loc_2] - this.RAq0[_loc_2]) > this.deltaclefRot || Math.abs(this.RAr[_loc_2] - this.RAr0[_loc_2]) > this.deltaclefRot)\r\n                {\r\n                    this.add_clef(_loc_2);\r\n                }\r\n                _loc_2++;\r\n            }\r\n        }\r\n        if (this.fin_parcours())\r\n        {\r\n            this.calculs_finis = true;\r\n            for (var _loc_2 = 0; _loc_2 < 3; _loc_2++)\r\n            {\r\n                \r\n                this.Xfin[_loc_2] = this.X[_loc_2];\r\n                this.Yfin[_loc_2] = this.Y[_loc_2];\r\n                this.RApfin[_loc_2] = this.RAp[_loc_2];\r\n                this.RAqfin[_loc_2] = this.RAq[_loc_2];\r\n                this.RArfin[_loc_2] = this.RAr[_loc_2];\r\n                this.add_clef(_loc_2);\r\n            }\r\n            this.duree = this.date * this.pas;\r\n        }\r\n        else\r\n        {\r\n            for (_loc_2 = 0; _loc_2 < 3; _loc_2++)\r\n            {\r\n                this.add_clef(_loc_2);\r\n            }\r\n        }\r\n        \r\n        return this.evts;\r\n    }\r\n\r\n    mise_a_jour = (param1) => {\r\n        var _loc_2 = NaN;\r\n        var _loc_3 = NaN;\r\n        var _loc_4 = NaN;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_7 = false;\r\n        if (this.first_bille_choquee != 0)\r\n        {\r\n            this.nb3 = 3 - this.first_bille_choquee;\r\n            this.d13 = Math.sqrt((this.X[0] - this.X[this.nb3]) * (this.X[0] - this.X[this.nb3]) + (this.Y[0] - this.Y[this.nb3]) * (this.Y[0] - this.Y[this.nb3]));\r\n            if (this.d13 < this.distance13)\r\n            {\r\n                this.distance13 = this.d13;\r\n            }\r\n        }\r\n        if (this.etat[param1] == this.RSG)\r\n        {\r\n            _loc_2 = Math.sqrt(this.Vx[param1] * this.Vx[param1] + this.Vy[param1] * this.Vy[param1]);\r\n            if (_loc_2 < this.frpas)\r\n            {\r\n                var _loc_8 = 0;\r\n                this.Vy[param1] = 0;\r\n                this.Vx[param1] = _loc_8;\r\n                var _loc_8 = 0;\r\n                this.Rq[param1] = 0;\r\n                this.Rp[param1] = _loc_8;\r\n                if (Math.abs(this.Rr[param1]) < this.Rfppas)\r\n                {\r\n                    this.etat[param1] = this.ARRET;\r\n                    this.Rr[param1] = 0;\r\n                    this.add_clef(param1);\r\n                    return true;\r\n                }\r\n                this.etat[param1] = this.TSP;\r\n            }\r\n            if (this.etat[param1] != this.TSP)\r\n            {\r\n                _loc_3 = 1 - this.frpas / _loc_2;\r\n                this.Vx[param1] = this.Vx[param1] * _loc_3;\r\n                this.Vy[param1] = this.Vy[param1] * _loc_3;\r\n                this.Rp[param1] = -this.Vy[param1];\r\n                this.Rq[param1] = this.Vx[param1];\r\n            }\r\n            if (Math.abs(this.Rr[param1]) < this.Rfppas)\r\n            {\r\n                this.Rr[param1] = 0;\r\n            }\r\n            else if (this.Rr[param1] > 0)\r\n            {\r\n                this.Rr[param1] = this.Rr[param1] - this.Rfppas;\r\n            }\r\n            else\r\n            {\r\n                this.Rr[param1] = this.Rr[param1] + this.Rfppas;\r\n            }\r\n        }\r\n        if (this.etat[param1] == this.QCQ)\r\n        {\r\n            _loc_4 = Math.sqrt(this.VQx[param1] * this.VQx[param1] + this.VQy[param1] * this.VQy[param1]);\r\n            if (_loc_4 < this.delta_fgpas)\r\n            {\r\n                this.etat[param1] = this.RSG;\r\n            }\r\n            else\r\n            {\r\n                _loc_5 = (-this.fgpas) * this.VQx[param1] / _loc_4;\r\n                _loc_6 = (-this.fgpas) * this.VQy[param1] / _loc_4;\r\n                this.Vx[param1] = this.Vx[param1] + _loc_5;\r\n                this.Vy[param1] = this.Vy[param1] + _loc_6;\r\n                _loc_3 = 1 - this.delta_fgpas / _loc_4;\r\n                this.VQx[param1] = this.VQx[param1] * _loc_3;\r\n                this.VQy[param1] = this.VQy[param1] * _loc_3;\r\n            }\r\n            this.Rp[param1] = -this.Vy[param1] + this.VQy[param1];\r\n            this.Rq[param1] = this.Vx[param1] - this.VQx[param1];\r\n            if (Math.abs(this.Rr[param1]) < this.Rfppas)\r\n            {\r\n                this.Rr[param1] = 0;\r\n            }\r\n            else if (this.Rr[param1] > 0)\r\n            {\r\n                this.Rr[param1] = this.Rr[param1] - this.Rfppas;\r\n            }\r\n            else\r\n            {\r\n                this.Rr[param1] = this.Rr[param1] + this.Rfppas;\r\n            }\r\n        }\r\n        if (this.etat[param1] == this.TSP)\r\n        {\r\n            var _loc_8 = 0;\r\n            this.Vy[param1] = 0;\r\n            this.Vx[param1] = _loc_8;\r\n            var _loc_8 = 0;\r\n            this.Rq[param1] = 0;\r\n            this.Rp[param1] = _loc_8;\r\n            if (Math.abs(this.Rr[param1]) < this.Rfppas)\r\n            {\r\n                this.Rr[param1] = 0;\r\n                this.etat[param1] = this.ARRET;\r\n                return true;\r\n            }\r\n            if (this.Rr[param1] > 0)\r\n            {\r\n                this.Rr[param1] = this.Rr[param1] - 2 * this.Rfppas;\r\n            }\r\n            else\r\n            {\r\n                this.Rr[param1] = this.Rr[param1] + 2 * this.Rfppas;\r\n            }\r\n        }\r\n        this.X[param1] = this.X[param1] + this.Vx[param1] * this.pas;\r\n        this.Y[param1] = this.Y[param1] + this.Vy[param1] * this.pas;\r\n        this.RAp[param1] = this.RAp[param1] + this.Rp[param1] * this.pas;\r\n        this.RAq[param1] = this.RAq[param1] + this.Rq[param1] * this.pas;\r\n        this.RAr[param1] = this.RAr[param1] + this.Rr[param1] * this.pas;\r\n        return false;\r\n    }\r\n\r\n    choc_gliss = (param1) => {\r\n        if (this.VMz > 0)\r\n        {\r\n            this.VT = this.VT - this.beta_gliss * Math.cos(this.alpha_bande);\r\n            this.VRr = this.VRr + 2.5 * this.beta_gliss * Math.cos(this.alpha_bande);\r\n        }\r\n        else\r\n        {\r\n            this.VT = this.VT + this.beta_gliss * Math.cos(this.alpha_bande);\r\n            this.VRr = this.VRr - 2.5 * this.beta_gliss * Math.cos(this.alpha_bande);\r\n        }\r\n        return;\r\n    }\r\n\r\n    choc_adh = (param1) => {\r\n        var _loc_2 = NaN;\r\n        var _loc_3 = NaN;\r\n        var _loc_4 = NaN;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_7 = NaN;\r\n        var _loc_8 = NaN;\r\n        var _loc_9 = NaN;\r\n        var _loc_10 = 0;\r\n        if (Math.abs(this.VT) < 1e-005)\r\n        {\r\n            _loc_2 = 90;\r\n        }\r\n        else\r\n        {\r\n            _loc_2 = 180 / Math.PI * Math.atan(this.VN0 / this.VT);\r\n        }\r\n        this.effet = 100 * this.R / 2 * this.VRr / Math.sqrt(this.VN0 * this.VN0 + this.VT * this.VT);\r\n        if (this.effet <= -1.5)\r\n        {\r\n            this.effet = -1.499;\r\n        }\r\n        else if (this.effet > 1.5)\r\n        {\r\n            this.effet = 1.499;\r\n        }\r\n        if (Math.abs(this.VT) < 1e-005)\r\n        {\r\n            if (this.effet > 0)\r\n            {\r\n                _loc_3 = this.sorties[9 * 3 + 1] + (this.sorties[9 * 3 + 2] - this.sorties[9 * 3 + 1]) * (this.effet / 1.5);\r\n            }\r\n            else\r\n            {\r\n                _loc_3 = this.sorties[9 * 3] + (this.sorties[9 * 3 + 1] - this.sorties[9 * 3]) * (this.effet + 1.5) / 1.5;\r\n            }\r\n        }\r\n        else\r\n        {\r\n            _loc_2 = 180 / Math.PI * Math.atan(this.VN0 / this.VT);\r\n            _loc_10 = parseInt(_loc_2 / 10);\r\n            if (this.effet > 0)\r\n            {\r\n                _loc_4 = this.sorties[3 * _loc_10 + 1] + (this.sorties[3 * _loc_10 + 2] - this.sorties[3 * _loc_10 + 1]) * (this.effet / 1.5);\r\n            }\r\n            else\r\n            {\r\n                _loc_4 = this.sorties[3 * _loc_10 + 0] + (this.sorties[3 * _loc_10 + 1] - this.sorties[3 * _loc_10 + 0]) * (this.effet + 1.5) / 1.5;\r\n            }\r\n            if (this.effet > 0)\r\n            {\r\n                _loc_5 = this.sorties[3 * (_loc_10 + 1) + 1] + (this.sorties[3 * (_loc_10 + 1) + 2] - this.sorties[3 * (_loc_10 + 1) + 1]) * (this.effet / 1.5);\r\n            }\r\n            else\r\n            {\r\n                _loc_5 = this.sorties[3 * (_loc_10 + 1) + 0] + (this.sorties[3 * (_loc_10 + 1) + 1] - this.sorties[3 * (_loc_10 + 1) + 0]) * (this.effet + 1.5) / 1.5;\r\n            }\r\n            _loc_3 = _loc_4 + (_loc_5 - _loc_4) / 10 * (_loc_2 - 10 * _loc_10);\r\n        }\r\n        if (Math.abs(_loc_3 - 90) < 1e-005)\r\n        {\r\n            this.VT = 0;\r\n        }\r\n        else if (_loc_3 < 90)\r\n        {\r\n            this.VT = this.VN / Math.tan(_loc_3 / 180 * Math.PI);\r\n        }\r\n        else\r\n        {\r\n            this.VT = (-this.VN) * Math.tan((_loc_3 - 90) / 180 * Math.PI);\r\n        }\r\n        if (Math.abs(this.VT) < 1e-005)\r\n        {\r\n            if (this.effet > 0)\r\n            {\r\n                this.e_s = this.eff_s[9 * 3 + 1] + (this.eff_s[9 * 3 + 2] - this.eff_s[9 * 3 + 1]) * (this.effet / 1.5);\r\n            }\r\n            else\r\n            {\r\n                this.e_s = this.eff_s[9 * 3 + 0] + (this.eff_s[9 * 3 + 1] - this.eff_s[9 * 3 + 0]) * (this.effet + 1.5) / 1.5;\r\n            }\r\n        }\r\n        else\r\n        {\r\n            if (this.effet > 0)\r\n            {\r\n                _loc_6 = this.eff_s[3 * _loc_10 + 1] + (this.eff_s[3 * _loc_10 + 2] - this.eff_s[3 * _loc_10 + 1]) * (this.effet / 1.5);\r\n                _loc_7 = this.eff_s[3 * (_loc_10 + 1) + 1] + (this.eff_s[3 * (_loc_10 + 1) + 2] - this.eff_s[3 * (_loc_10 + 1) + 1]) * (this.effet / 1.5);\r\n            }\r\n            else\r\n            {\r\n                _loc_6 = this.eff_s[3 * _loc_10 + 0] + (this.eff_s[3 * _loc_10 + 1] - this.eff_s[3 * _loc_10 + 0]) * (this.effet + 1.5) / 1.5;\r\n                _loc_7 = this.eff_s[3 * (_loc_10 + 1) + 0] + (this.eff_s[3 * (_loc_10 + 1) + 1] - this.eff_s[3 * (_loc_10 + 1) + 0]) * (this.effet + 1.5) / 1.5;\r\n            }\r\n            this.e_s = _loc_6 + (_loc_7 - _loc_6) / 10 * (_loc_2 - 10 * _loc_10);\r\n        }\r\n        _loc_9 = (5 * this.VN + 2 * this.VRq) / 7;\r\n        _loc_8 = (5 * this.VT - 2 * this.VRp) / 7;\r\n        this.VRr = 0.02 * this.e_s / this.R * Math.sqrt(_loc_9 * _loc_9 + _loc_8 * _loc_8);\r\n        return;\r\n    }\r\n\r\n    recup_pars = (param1) => {\r\n        if (this.X[param1] > this.XMAX && this.Vx[param1] > 0)\r\n        {\r\n            this.Vx[param1] = -this.VN;\r\n            this.Rq[param1] = -this.VRq;\r\n            if (this.Vy[param1] > 0)\r\n            {\r\n                this.Vy[param1] = this.VT;\r\n                this.Rp[param1] = this.VRp;\r\n                this.Rr[param1] = -this.VRr;\r\n            }\r\n            else\r\n            {\r\n                this.Vy[param1] = -this.VT;\r\n                this.Rp[param1] = -this.VRp;\r\n                this.Rr[param1] = this.VRr;\r\n            }\r\n        }\r\n        if (this.X[param1] < this.XMIN && this.Vx[param1] < 0)\r\n        {\r\n            this.Vx[param1] = this.VN;\r\n            this.Rq[param1] = this.VRq;\r\n            if (this.Vy[param1] > 0)\r\n            {\r\n                this.Vy[param1] = this.VT;\r\n                this.Rp[param1] = this.VRp;\r\n                this.Rr[param1] = this.VRr;\r\n            }\r\n            else\r\n            {\r\n                this.Vy[param1] = -this.VT;\r\n                this.Rp[param1] = -this.VRp;\r\n                this.Rr[param1] = -this.VRr;\r\n            }\r\n        }\r\n        if (this.Y[param1] < this.YMIN && this.Vy[param1] < 0)\r\n        {\r\n            this.Vy[param1] = this.VN;\r\n            this.Rp[param1] = -this.VRq;\r\n            if (this.Vx[param1] > 0)\r\n            {\r\n                this.Vx[param1] = this.VT;\r\n                this.Rq[param1] = -this.VRp;\r\n                this.Rr[param1] = -this.VRr;\r\n            }\r\n            else\r\n            {\r\n                this.Vx[param1] = -this.VT;\r\n                this.Rq[param1] = this.VRp;\r\n                this.Rr[param1] = this.VRr;\r\n            }\r\n        }\r\n        if (this.Y[param1] > this.YMAX && this.Vy[param1] > 0)\r\n        {\r\n            this.Vy[param1] = -this.VN;\r\n            this.Rp[param1] = this.VRq;\r\n            if (this.Vx[param1] > 0)\r\n            {\r\n                this.Vx[param1] = this.VT;\r\n                this.Rq[param1] = -this.VRp;\r\n                this.Rr[param1] = this.VRr;\r\n            }\r\n            else\r\n            {\r\n                this.Vx[param1] = -this.VT;\r\n                this.Rq[param1] = this.VRp;\r\n                this.Rr[param1] = -this.VRr;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    init_pars = (param1) => {\r\n        if (this.X[param1] > this.XMAX && this.Vx[param1] > 0)\r\n        {\r\n            this.VN = -this.Vx[param1];\r\n            this.VRq = -this.Rq[param1];\r\n            if (this.Vy[param1] > 0)\r\n            {\r\n                this.VT = this.Vy[param1];\r\n                this.VRp = this.Rp[param1];\r\n                this.VRr = -this.Rr[param1];\r\n            }\r\n            else\r\n            {\r\n                this.VT = -this.Vy[param1];\r\n                this.VRp = -this.Rp[param1];\r\n                this.VRr = this.Rr[param1];\r\n            }\r\n        }\r\n        if (this.X[param1] < this.XMIN && this.Vx[param1] < 0)\r\n        {\r\n            this.VN = this.Vx[param1];\r\n            this.VRq = this.Rq[param1];\r\n            if (this.Vy[param1] > 0)\r\n            {\r\n                this.VT = this.Vy[param1];\r\n                this.VRp = this.Rp[param1];\r\n                this.VRr = this.Rr[param1];\r\n            }\r\n            else\r\n            {\r\n                this.VT = -this.Vy[param1];\r\n                this.VRp = -this.Rp[param1];\r\n                this.VRr = -this.Rr[param1];\r\n            }\r\n        }\r\n        if (this.Y[param1] < this.YMIN && this.Vy[param1] < 0)\r\n        {\r\n            this.VN = this.Vy[param1];\r\n            this.VRq = -this.Rp[param1];\r\n            if (this.Vx[param1] > 0)\r\n            {\r\n                this.VT = this.Vx[param1];\r\n                this.VRp = -this.Rq[param1];\r\n                this.VRr = -this.Rr[param1];\r\n            }\r\n            else\r\n            {\r\n                this.VT = -this.Vx[param1];\r\n                this.VRp = this.Rq[param1];\r\n                this.VRr = this.Rr[param1];\r\n            }\r\n        }\r\n        if (this.Y[param1] > this.YMAX && this.Vy[param1] > 0)\r\n        {\r\n            this.VN = -this.Vy[param1];\r\n            this.VRq = this.Rp[param1];\r\n            if (this.Vx[param1] > 0)\r\n            {\r\n                this.VT = this.Vx[param1];\r\n                this.VRp = -this.Rq[param1];\r\n                this.VRr = this.Rr[param1];\r\n            }\r\n            else\r\n            {\r\n                this.VT = -this.Vx[param1];\r\n                this.VRp = this.Rq[param1];\r\n                this.VRr = -this.Rr[param1];\r\n            }\r\n        }\r\n        return;\r\n    }// end function\r\n\r\n    add_clef = (param1) => {\r\n        var _loc_2 = 0;\r\n        var _loc_3 = this.nb_max_clefs * param1 + this.nb_clefs[param1];\r\n        this.evts[_loc_3] = new evt();\r\n        this.evts[_loc_3].X = this.X[param1];\r\n        this.evts[_loc_3].Y = this.Y[param1];\r\n        this.evts[_loc_3].RAp = this.RAp[param1];\r\n        this.evts[_loc_3].RAq = this.RAq[param1];\r\n        this.evts[_loc_3].RAr = this.RAr[param1];\r\n        this.evts[_loc_3].time = this.date * this.pas;\r\n        var _loc_4 = this.nb_clefs;\r\n        var _loc_5 = param1;\r\n        var _loc_6 = _loc_4[param1] + 1;\r\n        _loc_4[_loc_5] = _loc_6;\r\n        this.X0[param1] = this.X[param1];\r\n        this.Y0[param1] = this.Y[param1];\r\n        this.RAp0[param1] = this.RAp[param1];\r\n        this.RAq0[param1] = this.RAq[param1];\r\n        this.RAr0[param1] = this.RAr[param1];\r\n        return;\r\n    }// end function\r\n\r\n    choc_billes = (param1) => {\r\n        var _loc_3 = 0;\r\n        var _loc_4 = 0;\r\n        var _loc_6 = false;\r\n        var _loc_7 = NaN;\r\n        var _loc_8 = NaN;\r\n        var _loc_9 = NaN;\r\n        var _loc_10 = NaN;\r\n        var _loc_11 = NaN;\r\n        var _loc_12 = NaN;\r\n        var _loc_13 = NaN;\r\n        var _loc_14 = NaN;\r\n        var _loc_15 = NaN;\r\n        var _loc_16 = NaN;\r\n        var _loc_17 = NaN;\r\n        var _loc_18 = NaN;\r\n        var _loc_19 = NaN;\r\n        var _loc_20 = NaN;\r\n        var _loc_21 = NaN;\r\n        var _loc_22 = NaN;\r\n        var _loc_23 = NaN;\r\n        var _loc_24 = NaN;\r\n        var _loc_25 = NaN;\r\n        var _loc_26 = NaN;\r\n        var _loc_27 = NaN;\r\n        var _loc_28 = 0;\r\n        var _loc_2 = false;\r\n        var _loc_5 = [];\r\n        _loc_3 = 0;\r\n        while (_loc_3 < 3)\r\n        {\r\n            \r\n            _loc_5[_loc_3] = false;\r\n            _loc_3++;\r\n        }\r\n        _loc_3 = 0;\r\n        while (_loc_3 < 3)\r\n        {\r\n            \r\n            if (!_loc_5[_loc_3])\r\n            {\r\n                _loc_6 = false;\r\n                _loc_4 = (_loc_3 + 1) % 3;\r\n                _loc_7 = (this.X[_loc_3] - this.X[_loc_4]) * (this.X[_loc_3] - this.X[_loc_4]) + (this.Y[_loc_3] - this.Y[_loc_4]) * (this.Y[_loc_3] - this.Y[_loc_4]);\r\n                if (_loc_7 < this.D * this.D && (this.etat[_loc_3] != this.ARRET || this.etat[_loc_4] != this.ARRET))\r\n                {\r\n                    if ((this.Vx[_loc_3] - this.Vx[_loc_4]) * (this.X[_loc_4] - this.X[_loc_3]) + (this.Vy[_loc_3] - this.Vy[_loc_4]) * (this.Y[_loc_4] - this.Y[_loc_3]) > 0)\r\n                    {\r\n                        _loc_6 = true;\r\n                        _loc_2 = true;\r\n                        if (!this.choc12 && !this.choc13 && _loc_3 == 0)\r\n                        {\r\n                            this.first_bille_choquee = _loc_4;\r\n                        }\r\n                        if (_loc_3 == 0 && _loc_4 == 1)\r\n                        {\r\n                            this.choc12 = true;\r\n                        }\r\n                        if (_loc_3 == 2 && _loc_4 == 0)\r\n                        {\r\n                            this.choc13 = true;\r\n                        }\r\n                        param1[0] = _loc_3;\r\n                        param1[1] = _loc_4;\r\n                    }\r\n                }\r\n                if (!_loc_6)\r\n                {\r\n                    _loc_4 = (_loc_3 + 2) % 3;\r\n                    _loc_7 = (this.X[_loc_3] - this.X[_loc_4]) * (this.X[_loc_3] - this.X[_loc_4]) + (this.Y[_loc_3] - this.Y[_loc_4]) * (this.Y[_loc_3] - this.Y[_loc_4]);\r\n                    if (_loc_7 < this.D * this.D && (this.etat[_loc_3] != this.ARRET || this.etat[_loc_4] != this.ARRET))\r\n                    {\r\n                        if ((this.Vx[_loc_3] - this.Vx[_loc_4]) * (this.X[_loc_4] - this.X[_loc_3]) + (this.Vy[_loc_3] - this.Vy[_loc_4]) * (this.Y[_loc_4] - this.Y[_loc_3]) > 0)\r\n                        {\r\n                            _loc_6 = true;\r\n                            _loc_2 = true;\r\n                            if (!this.choc12 && !this.choc13 && _loc_3 == 0)\r\n                            {\r\n                                this.first_bille_choquee = _loc_4;\r\n                            }\r\n                            if (_loc_3 == 1 && _loc_4 == 0)\r\n                            {\r\n                                this.choc12 = true;\r\n                            }\r\n                            if (_loc_3 == 0 && _loc_4 == 2)\r\n                            {\r\n                                this.choc13 = true;\r\n                            }\r\n                            param1[0] = _loc_3;\r\n                            param1[1] = _loc_4;\r\n                        }\r\n                    }\r\n                }\r\n                if (_loc_6)\r\n                {\r\n                    this.add_clef(_loc_3);\r\n                    this.add_clef(_loc_4);\r\n                    _loc_5[_loc_3] = true;\r\n                    if (this.etat[_loc_3] == this.RSG)\r\n                    {\r\n                        this.Rp[_loc_3] = -this.Vy[_loc_3];\r\n                        this.Rq[_loc_3] = this.Vx[_loc_3];\r\n                    }\r\n                    if (this.etat[_loc_3] == this.QCQ)\r\n                    {\r\n                        this.Rp[_loc_3] = -this.Vy[_loc_3] + this.VQy[_loc_3];\r\n                        this.Rq[_loc_3] = this.Vx[_loc_3] - this.VQx[_loc_3];\r\n                    }\r\n                    if (this.etat[_loc_3] == this.ARRET)\r\n                    {\r\n                        this.Rp[_loc_3] = 0;\r\n                        this.Rq[_loc_3] = 0;\r\n                    }\r\n                    _loc_5[_loc_4] = true;\r\n                    if (this.etat[_loc_4] == this.RSG)\r\n                    {\r\n                        this.Rp[_loc_4] = -this.Vy[_loc_4];\r\n                        this.Rq[_loc_4] = this.Vx[_loc_4];\r\n                    }\r\n                    if (this.etat[_loc_4] == this.QCQ)\r\n                    {\r\n                        this.Rp[_loc_4] = -this.Vy[_loc_4] + this.VQy[_loc_4];\r\n                        this.Rq[_loc_4] = this.Vx[_loc_4] - this.VQx[_loc_4];\r\n                    }\r\n                    if (this.etat[_loc_4] == this.ARRET)\r\n                    {\r\n                        this.Rp[_loc_4] = 0;\r\n                        this.Rq[_loc_4] = 0;\r\n                    }\r\n                    _loc_17 = this.Vx[_loc_3] * (this.X[_loc_4] - this.X[_loc_3]) + this.Vy[_loc_3] * (this.Y[_loc_4] - this.Y[_loc_3]);\r\n                    _loc_9 = _loc_17 * (this.X[_loc_4] - this.X[_loc_3]) / _loc_7;\r\n                    _loc_10 = _loc_17 * (this.Y[_loc_4] - this.Y[_loc_3]) / _loc_7;\r\n                    _loc_11 = this.Vx[_loc_3] - _loc_9;\r\n                    _loc_12 = this.Vy[_loc_3] - _loc_10;\r\n                    _loc_18 = this.Vx[_loc_4] * (this.X[_loc_3] - this.X[_loc_4]) + this.Vy[_loc_4] * (this.Y[_loc_3] - this.Y[_loc_4]);\r\n                    _loc_13 = _loc_18 * (this.X[_loc_3] - this.X[_loc_4]) / _loc_7;\r\n                    _loc_14 = _loc_18 * (this.Y[_loc_3] - this.Y[_loc_4]) / _loc_7;\r\n                    _loc_15 = this.Vx[_loc_4] - _loc_13;\r\n                    _loc_16 = this.Vy[_loc_4] - _loc_14;\r\n                    _loc_20 = _loc_9 - _loc_13;\r\n                    _loc_21 = _loc_10 - _loc_14;\r\n                    this.intens = (_loc_20 * _loc_20 + _loc_21 * _loc_21) / 5;\r\n                    if (this.intens > 1)\r\n                    {\r\n                        this.intens = 1;\r\n                    }\r\n                    this.evts_son[this.nb_sons] = new son();\r\n                    this.evts_son[this.nb_sons].played = false;\r\n                    this.evts_son[this.nb_sons].temps = this.date * this.pas;\r\n                    this.evts_son[this.nb_sons].intensite = this.intens;\r\n                    this.evts_son[this.nb_sons].type_choc = 2;\r\n                    var _loc_29 = this;\r\n                    var _loc_30 = this.nb_sons + 1;\r\n                    _loc_29.nb_sons = _loc_30;\r\n                    _loc_19 = _loc_9;\r\n                    _loc_9 = _loc_13;\r\n                    _loc_13 = _loc_19;\r\n                    _loc_13 = _loc_13 * this.RendementChoc;\r\n                    _loc_9 = _loc_9 * this.RendementChoc;\r\n                    _loc_19 = _loc_10;\r\n                    _loc_10 = _loc_14;\r\n                    _loc_14 = _loc_19;\r\n                    _loc_14 = _loc_14 * this.RendementChoc;\r\n                    _loc_10 = _loc_10 * this.RendementChoc;\r\n                    this.Vx[_loc_3] = _loc_9 + _loc_11;\r\n                    this.Vy[_loc_3] = _loc_10 + _loc_12;\r\n                    this.VQx[_loc_3] = this.Vx[_loc_3] - this.Rq[_loc_3];\r\n                    this.VQy[_loc_3] = this.Vy[_loc_3] + this.Rp[_loc_3];\r\n                    if (this.etat[_loc_4] == this.ARRET)\r\n                    {\r\n                        this.Vx[_loc_4] = this.Vx[_loc_4] * 0.94;\r\n                        this.Vy[_loc_4] = this.Vy[_loc_4] * 0.94;\r\n                        _loc_8 = Math.sqrt(_loc_7);\r\n                        _loc_17 = _loc_17 / _loc_8;\r\n                        _loc_17 = Math.abs(_loc_17);\r\n                        _loc_26 = this.fbille * _loc_17;\r\n                        _loc_22 = Math.abs(this.Rp[_loc_3] * (this.Y[_loc_4] - this.Y[_loc_3]) - this.Rq[_loc_3] * (this.X[_loc_4] - this.X[_loc_3])) / _loc_8;\r\n                        _loc_24 = (this.Vx[_loc_3] * (this.Y[_loc_4] - this.Y[_loc_3]) - this.Vy[_loc_3] * (this.X[_loc_4] - this.X[_loc_3])) / _loc_8;\r\n                        _loc_25 = _loc_24 - this.Rr[_loc_3];\r\n                        if (Math.abs(_loc_25) < 1e-005)\r\n                        {\r\n                            _loc_23 = Math.PI / 2;\r\n                        }\r\n                        else\r\n                        {\r\n                            _loc_23 = Math.abs(Math.atan(_loc_22 / _loc_25));\r\n                        }\r\n                        if (_loc_25 > 0)\r\n                        {\r\n                            _loc_28 = 1;\r\n                        }\r\n                        else\r\n                        {\r\n                            _loc_28 = -1;\r\n                        }\r\n                        _loc_27 = _loc_28 * _loc_26 * Math.cos(_loc_23);\r\n                        this.Rr[_loc_4] = 2.5 * _loc_27;\r\n                        this.Rr[_loc_3] = this.Rr[_loc_3] - 2.5 * _loc_27;\r\n                        _loc_15 = _loc_27 * (this.Y[_loc_4] - this.Y[_loc_3]) / _loc_8;\r\n                        _loc_16 = (-_loc_27) * (this.X[_loc_4] - this.X[_loc_3]) / _loc_8;\r\n                    }\r\n                    this.Vx[_loc_4] = _loc_13 + _loc_15;\r\n                    this.Vy[_loc_4] = _loc_14 + _loc_16;\r\n                    this.VQx[_loc_4] = this.Vx[_loc_4] - this.Rq[_loc_4];\r\n                    this.VQy[_loc_4] = this.Vy[_loc_4] + this.Rp[_loc_4];\r\n                    this.etat[_loc_4] = this.QCQ;\r\n                    this.etat[_loc_3] = this.QCQ;\r\n                }\r\n            }\r\n            _loc_3++;\r\n        }\r\n        return _loc_2;\r\n    }// end function\r\n}","export default class parametres {\r\n    noba;\r\n    NBILLES;\r\n    quant;\r\n    RApInit = [];\r\n    RArInit = [];\r\n    larg_billard;\r\n    RAqInit = [];\r\n    betaQ;\r\n    el;\r\n    Xinit = [];\r\n    Yinit = [];\r\n    er;\r\n    HBande = 0.035;\r\n    long_billard;\r\n    alphaQ;\r\n    Vqueue;\r\n    bille_visee;\r\n\r\n    constructor (param1, param2) {\r\n        var _loc_3 = 0;\r\n        this.NBILLES = 3;\r\n        this.long_billard = param1;\r\n        this.larg_billard = param2;\r\n        this.Xinit = [];\r\n        this.Yinit = [];\r\n        this.RApInit = [];\r\n        this.RAqInit = [];\r\n        this.RArInit = [];\r\n        _loc_3 = 0;\r\n        while (_loc_3 < 3)\r\n        {\r\n            \r\n            this.RApInit[_loc_3] = 0;\r\n            this.RAqInit[_loc_3] = 0;\r\n            this.RArInit[_loc_3] = 0;\r\n            _loc_3++;\r\n        }\r\n        this.Xinit[0] = -0.71;\r\n        this.Yinit[0] = -0.1775;\r\n        this.Xinit[1] = -0.71;\r\n        this.Yinit[1] = 0;\r\n        this.Xinit[2] = 0.71;\r\n        this.Yinit[2] = 0;\r\n        this.Vqueue = 0.08;\r\n        this.el = 0;\r\n        this.er = 0.012;\r\n        this.alphaQ = 0;\r\n        this.betaQ = 0 * Math.PI / 4;\r\n        this.Vqueue = 3.19731;\r\n        this.el = 0.0056;\r\n        this.er = 0.004;\r\n        this.alphaQ = 0.033916;\r\n        this.betaQ = 3.28339;\r\n        this.Xinit[0] = 0;\r\n        this.Yinit[0] = 0;\r\n        this.Xinit[1] = -0.051;\r\n        this.Yinit[1] = 0.05;\r\n        this.Xinit[2] = 0.05;\r\n        this.Yinit[2] = 0.05;\r\n        this.Vqueue = 0.4;\r\n        this.el = 0;\r\n        this.er = 0;\r\n        this.alphaQ = 0.033916;\r\n        this.betaQ = -7 * Math.PI / 8;\r\n        return;\r\n    }// end function\r\n\r\n    direction_beta = (param1, param2, param3) => {\r\n        var _loc_4 = NaN;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_7 = 0.03;\r\n        _loc_6 = Math.sqrt((this.Xinit[0] - param2) * (this.Xinit[0] - param2) + (this.Yinit[0] - param3) * (this.Yinit[0] - param3));\r\n        param1 = param1 * (2 * _loc_7);\r\n        _loc_4 = Math.asin(param1 / _loc_6);\r\n        _loc_5 = this.atanjimi(param3 - this.Yinit[0], param2 - this.Xinit[0]);\r\n        if (_loc_5 - _loc_4 > Math.PI)\r\n        {\r\n            return _loc_5 - _loc_4 - 2 * Math.PI;\r\n        }\r\n        if (_loc_5 - _loc_4 < -Math.PI)\r\n        {\r\n            return _loc_5 - _loc_4 + 2 * Math.PI;\r\n        }\r\n        return _loc_5 - _loc_4;\r\n    }// end function\r\n\r\n    ToucheBandeX = (param1) => {\r\n        var _loc_2 = NaN;\r\n        var _loc_3 = NaN;\r\n        var _loc_4 = NaN;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_8 = NaN;\r\n        var _loc_9 = NaN;\r\n        var _loc_10 = NaN;\r\n        var _loc_11 = NaN;\r\n        var _loc_12 = NaN;\r\n        var _loc_13 = NaN;\r\n        var _loc_14 = NaN;\r\n        var _loc_15 = NaN;\r\n        var _loc_16 = NaN;\r\n        var _loc_17 = NaN;\r\n        var _loc_18 = NaN;\r\n        var _loc_7 = 0.03;\r\n        var _loc_19 = 1e-005;\r\n        var _loc_20 = 1.4;\r\n        var _loc_21 = 0.006;\r\n        var _loc_22 = 0.015;\r\n        while (this.betaQ < 0)\r\n        {\r\n            \r\n            this.betaQ = this.betaQ + 2 * Math.PI;\r\n        }\r\n        while (this.betaQ >= 2 * Math.PI)\r\n        {\r\n            \r\n            this.betaQ = this.betaQ - 2 * Math.PI;\r\n        }\r\n        _loc_14 = this.betaQ;\r\n        _loc_13 = param1;\r\n        _loc_17 = Math.cos(_loc_14);\r\n        _loc_18 = Math.sin(_loc_14);\r\n        _loc_15 = Math.cos(_loc_13);\r\n        _loc_16 = Math.sin(_loc_13);\r\n        _loc_12 = Math.sqrt(_loc_7 * _loc_7 - this.er * this.er - this.el * this.el);\r\n        _loc_9 = (_loc_12 * _loc_15 - this.er * _loc_16) * _loc_17 - this.el * _loc_18;\r\n        _loc_10 = _loc_12 * _loc_16 + this.er * _loc_15;\r\n        _loc_11 = (_loc_12 * _loc_15 - this.er * _loc_16) * _loc_18 + this.el * _loc_17;\r\n        _loc_2 = this.Xinit[0] + _loc_9;\r\n        _loc_3 = _loc_7 + _loc_10;\r\n        _loc_4 = this.Yinit[0] + _loc_11;\r\n        _loc_6 = this.long_billard / 2;\r\n        if (Math.abs(_loc_17) < _loc_19)\r\n        {\r\n            return false;\r\n        }\r\n        if (_loc_14 > Math.PI / 2 && _loc_14 < 3 * Math.PI / 2)\r\n        {\r\n            _loc_17 = -_loc_17;\r\n            _loc_2 = -_loc_2;\r\n        }\r\n        _loc_8 = (_loc_6 - _loc_2) / _loc_17;\r\n        if (_loc_8 > _loc_20)\r\n        {\r\n            return false;\r\n        }\r\n        _loc_5 = _loc_21 + (_loc_22 - _loc_21) / _loc_20 * _loc_8 / _loc_15;\r\n        if (_loc_8 * _loc_16 / _loc_15 + _loc_3 > this.HBande + _loc_5 / _loc_15)\r\n        {\r\n            return false;\r\n        }\r\n        return true;\r\n    }// end function\r\n\r\n    atanjimi = (param1, param2) => {\r\n        var _loc_3 = NaN;\r\n        if (Math.abs(param2) < 1e-006)\r\n        {\r\n            if (param1 > 0)\r\n            {\r\n                return Math.PI / 2;\r\n            }\r\n            return (-Math.PI) / 2;\r\n        }\r\n        _loc_3 = Math.atan(param1 / param2);\r\n        if (param2 > 0)\r\n        {\r\n            return _loc_3;\r\n        }\r\n        if (param1 < 0)\r\n        {\r\n            return _loc_3 - Math.PI;\r\n        }\r\n        return _loc_3 + Math.PI;\r\n    }// end function\r\n\r\n    Quantite = () => {\r\n        var _loc_1 = 0;\r\n        var _loc_2 = NaN;\r\n        var _loc_3 = [];\r\n        var _loc_4 = [];\r\n        var _loc_5 = 0.03;\r\n        _loc_2 = this.betaQ + Math.PI;\r\n        _loc_1 = 1;\r\n        while (_loc_1 < this.NBILLES)\r\n        {\r\n            \r\n            _loc_3[_loc_1] = false;\r\n            if ((this.Xinit[_loc_1] - this.Xinit[0]) * Math.cos(_loc_2) + (this.Yinit[_loc_1] - this.Yinit[0]) * Math.sin(_loc_2) > 0)\r\n            {\r\n                _loc_4[_loc_1] = (this.Yinit[_loc_1] - this.Yinit[0]) * Math.cos(_loc_2) - (this.Xinit[_loc_1] - this.Xinit[0]) * Math.sin(_loc_2);\r\n                if (_loc_4[_loc_1] < 2 * _loc_5 && _loc_4[_loc_1] > -2 * _loc_5)\r\n                {\r\n                    _loc_3[_loc_1] = true;\r\n                }\r\n            }\r\n            _loc_1++;\r\n        }\r\n        this.bille_visee = -1;\r\n        var _loc_6 = 100;\r\n        _loc_1 = 1;\r\n        while (_loc_1 < this.NBILLES)\r\n        {\r\n            \r\n            if (_loc_3[_loc_1])\r\n            {\r\n                if ((this.Xinit[_loc_1] - this.Xinit[0]) * (this.Xinit[_loc_1] - this.Xinit[0]) + (this.Yinit[_loc_1] - this.Yinit[0]) * (this.Yinit[_loc_1] - this.Yinit[0]) < _loc_6)\r\n                {\r\n                    this.bille_visee = _loc_1;\r\n                    _loc_6 = (this.Xinit[_loc_1] - this.Xinit[0]) * (this.Xinit[_loc_1] - this.Xinit[0]) + (this.Yinit[_loc_1] - this.Yinit[0]) * (this.Yinit[_loc_1] - this.Yinit[0]);\r\n                }\r\n            }\r\n            _loc_1++;\r\n        }\r\n        if (this.bille_visee != -1)\r\n        {\r\n            this.noba = true;\r\n            this.quant = _loc_4[this.bille_visee] / 2 / _loc_5;\r\n        }\r\n        else\r\n        {\r\n            this.noba = false;\r\n            this.quant = 0;\r\n        }\r\n        return this.quant;\r\n    }// end function\r\n\r\n    ToucheBandeZ = (param1) => {\r\n        var _loc_2 = NaN;\r\n        var _loc_3 = NaN;\r\n        var _loc_4 = NaN;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_7 = NaN;\r\n        var _loc_9 = NaN;\r\n        var _loc_10 = NaN;\r\n        var _loc_11 = NaN;\r\n        var _loc_12 = NaN;\r\n        var _loc_13 = NaN;\r\n        var _loc_14 = NaN;\r\n        var _loc_15 = NaN;\r\n        var _loc_16 = NaN;\r\n        var _loc_17 = NaN;\r\n        var _loc_18 = NaN;\r\n        var _loc_19 = NaN;\r\n        var _loc_8 = 0.03;\r\n        var _loc_20 = 1e-005;\r\n        var _loc_21 = 1.4;\r\n        var _loc_22 = 0.006;\r\n        var _loc_23 = 0.015;\r\n        while (this.betaQ < 0)\r\n        {\r\n            \r\n            this.betaQ = this.betaQ + 2 * Math.PI;\r\n        }\r\n        while (this.betaQ >= 2 * Math.PI)\r\n        {\r\n            \r\n            this.betaQ = this.betaQ - 2 * Math.PI;\r\n        }\r\n        _loc_15 = this.betaQ;\r\n        _loc_14 = param1;\r\n        _loc_18 = Math.cos(_loc_15);\r\n        _loc_19 = Math.sin(_loc_15);\r\n        _loc_16 = Math.cos(_loc_14);\r\n        _loc_17 = Math.sin(_loc_14);\r\n        _loc_13 = Math.sqrt(_loc_8 * _loc_8 - this.er * this.er - this.el * this.el);\r\n        _loc_10 = (_loc_13 * _loc_16 - this.er * _loc_17) * _loc_18 - this.el * _loc_19;\r\n        _loc_11 = _loc_13 * _loc_17 + this.er * _loc_16;\r\n        _loc_12 = (_loc_13 * _loc_16 - this.er * _loc_17) * _loc_19 + this.el * _loc_18;\r\n        _loc_2 = this.Xinit[0] + _loc_10;\r\n        _loc_3 = _loc_8 + _loc_11;\r\n        _loc_4 = this.Yinit[0] + _loc_12;\r\n        _loc_7 = this.larg_billard / 2;\r\n        if (Math.abs(_loc_19) < _loc_20)\r\n        {\r\n            return false;\r\n        }\r\n        if (_loc_15 > Math.PI)\r\n        {\r\n            _loc_19 = -_loc_19;\r\n            _loc_4 = -_loc_4;\r\n        }\r\n        _loc_9 = (_loc_7 - _loc_4) / _loc_19;\r\n        if (_loc_9 > _loc_21)\r\n        {\r\n            return false;\r\n        }\r\n        _loc_5 = _loc_22 + (_loc_23 - _loc_22) / _loc_21 * _loc_9 / _loc_16;\r\n        if (_loc_9 * _loc_17 / _loc_16 + _loc_3 > this.HBande + _loc_5 / _loc_16)\r\n        {\r\n            return false;\r\n        }\r\n        return true;\r\n    }// end function\r\n\r\n    AlphaQmin = () => {\r\n        var _loc_1 = 0;\r\n        while (this.ToucheBandeZ(_loc_1) || this.ToucheBandeX(_loc_1) || this.ToucheBille(_loc_1))\r\n        {\r\n            \r\n            _loc_1 = _loc_1 + Math.PI / 90;\r\n        }\r\n        return _loc_1;\r\n    }// end function\r\n\r\n    ToucheBille = (param1) => {\r\n        var _loc_2 = NaN;\r\n        var _loc_3 = NaN;\r\n        var _loc_4 = NaN;\r\n        var _loc_5 = NaN;\r\n        var _loc_6 = NaN;\r\n        var _loc_8 = NaN;\r\n        var _loc_9 = NaN;\r\n        var _loc_10 = NaN;\r\n        var _loc_11 = NaN;\r\n        var _loc_14 = NaN;\r\n        var _loc_15 = NaN;\r\n        var _loc_16 = NaN;\r\n        var _loc_22 = 0;\r\n        var _loc_7 = 0.03;\r\n        var _loc_12 = 0.002;\r\n        var _loc_13 = 0.032;\r\n        var _loc_17 = 1.4;\r\n        var _loc_18 = 0.006;\r\n        var _loc_19 = 0.015;\r\n        var _loc_20 = param1;\r\n        var _loc_21 = this.betaQ;\r\n        _loc_22 = 1;\r\n        while (_loc_22 < this.NBILLES)\r\n        {\r\n            \r\n            _loc_2 = this.Xinit[0] + _loc_13 * Math.cos(_loc_21) * Math.cos(_loc_20) - this.el * Math.sin(_loc_21) - this.er * Math.sin(_loc_20) * Math.cos(_loc_21);\r\n            _loc_3 = 0.03 + _loc_13 * Math.sin(_loc_20) + this.er * Math.cos(_loc_20);\r\n            _loc_4 = this.Yinit[0] + _loc_13 * Math.sin(_loc_21) * Math.cos(_loc_20) + this.el * Math.cos(_loc_21) - this.er * Math.sin(_loc_20) * Math.sin(_loc_21);\r\n            _loc_8 = this.Xinit[_loc_22];\r\n            _loc_9 = 0.03;\r\n            _loc_10 = this.Yinit[_loc_22];\r\n            _loc_6 = 0;\r\n            while (_loc_6 < _loc_17)\r\n            {\r\n                \r\n                _loc_5 = _loc_18 + (_loc_19 - _loc_18) / _loc_17 * _loc_6;\r\n                _loc_14 = _loc_2 + _loc_6 * Math.cos(_loc_20) * Math.cos(_loc_21);\r\n                _loc_15 = _loc_3 + _loc_6 * Math.sin(_loc_20);\r\n                _loc_16 = _loc_4 + _loc_6 * Math.cos(_loc_20) * Math.sin(_loc_21);\r\n                _loc_11 = (_loc_14 - _loc_8) * (_loc_14 - _loc_8) + (_loc_15 - _loc_9) * (_loc_15 - _loc_9) + (_loc_16 - _loc_10) * (_loc_16 - _loc_10);\r\n                if (_loc_11 < (_loc_7 + _loc_5 + _loc_12) * (_loc_7 + _loc_5 + _loc_12))\r\n                {\r\n                    return true;\r\n                }\r\n                _loc_6 = _loc_6 + 0.01;\r\n            }\r\n            _loc_22++;\r\n        }\r\n        return false;\r\n    }\r\n}","import Simul from './simul';\r\nimport parametres from './parametres';\r\nimport sequence from './sequence';\r\n\r\nexport default class CBillard {\r\n    bitmap_Bandes_260;\r\n    ampl_recul_max;\r\n    mode_jeu = 2;\r\n    temps_recul;\r\n    queue;\r\n    calculs_faits;\r\n    largeur;\r\n    trajets;\r\n    seq_origine;\r\n    canal_bande0;\r\n    canal_bande1;\r\n    bitmap_Bandes_310;\r\n    RAp0;\r\n    alphamin;\r\n    tous_trajets;\r\n    type;\r\n    t0;\r\n    bitmap_Bandes_280;\r\n    new_seq;\r\n    dq0;\r\n    grille;\r\n    ymax;\r\n    son_queue_pique;\r\n    RAq0;\r\n    lines_cadre47;\r\n    Rb;\r\n    R;\r\n    Ampl_queue;\r\n    seq;\r\n    son_bille_bande;\r\n    muet;\r\n    bitmap_Billard_260;\r\n    Ech;\r\n    ctrl;\r\n    RAr0;\r\n    son_queue_plat;\r\n    ind_last_clef;\r\n    taille_billard;\r\n    ombre;\r\n    jouer_bande0;\r\n    ralenti = 1;\r\n    canal_bille0;\r\n    bille_visee;\r\n    dq;\r\n    bitmap_Billard_310;\r\n    ecl;\r\n    canal_bille1;\r\n    trajet_bille_joueur;\r\n    Params;\r\n    bitmap_Billard_280;\r\n    trans;\r\n    longueur;\r\n    lines_cadre71;\r\n    date;\r\n    Vqmax;\r\n    largeur_bandes = 0.28;\r\n    nb_sons_played;\r\n    jouer_bille0;\r\n    aff_trajets;\r\n    ligne_visee;\r\n    lines_free;\r\n    canal_queue;\r\n    son_bille_bille;\r\n    t_debut;\r\n    trajet_bille_visee;\r\n    cont_billard;\r\n    Simulateur;\r\n    xmax;\r\n    billes;\r\n    myTimer;\r\n\r\n    constructor (param1, param2, param3, param4) {\r\n        var _loc_5 = 0;\r\n        this.Ech = param3;\r\n        this.R = 0.03;\r\n        this.Rb = 36;\r\n        this.type = 0;\r\n        this.taille(param1);\r\n        this.Params = new parametres((this.xmax + this.R) * 2, (this.ymax + this.R) * 2);\r\n\r\n        var _loc_17 = 0;\r\n        this.ombre = [];\r\n        this.aff_trajets = false;\r\n        this.tous_trajets = true;\r\n        this.trajet_bille_joueur = false;\r\n        this.trajet_bille_visee = false;\r\n        // this.trajets = new Shape();\r\n        // this.cont_billard.addChild(this.trajets);\r\n        this.billes = [];\r\n\r\n        this.bille_visee = 1;\r\n        this.ecl = [];\r\n        // var _loc_15 = new Cecl(0, 0);\r\n        this.dq0 = 1.5 * this.R * this.Ech;\r\n        this.alphamin = true;\r\n        this.Vqmax = 3.5;\r\n        this.Simulateur = new Simul(this.xmax, this.ymax);\r\n        this.ind_last_clef = [];\r\n        _loc_5 = 0;\r\n        while (_loc_5 < 3)\r\n        {\r\n            \r\n            this.ind_last_clef[_loc_5] = this.Simulateur.nb_max_clefs * _loc_5;\r\n            _loc_5++;\r\n        }\r\n        this.calculs_faits = false;\r\n        // this.myTimer = new Timer(5);\r\n        // this.myTimer.addEventListener(\"timer\", this.timerHandler);\r\n        this.ampl_recul_max = 0.1;\r\n        this.RAp0 = [];\r\n        this.RAq0 = [];\r\n        this.RAr0 = [];\r\n        _loc_5 = 0;\r\n        while (_loc_5 < 3)\r\n        {\r\n            \r\n            this.RAp0[_loc_5] = 0;\r\n            this.RAq0[_loc_5] = 0;\r\n            this.RAr0[_loc_5] = 0;\r\n            _loc_5++;\r\n        }\r\n        this.alphamin = false;\r\n        console.log(this)\r\n        return;\r\n    }// end function\r\n\r\n    change_billard = (param1) => {\r\n        this.arret_son();\r\n        this.myTimer.stop();\r\n        if (param1 == 1)\r\n        {\r\n            this.taille(280);\r\n            var _loc_2 = false;\r\n            this.bitmap_Bandes_310.visible = false;\r\n            this.bitmap_Billard_310.visible = _loc_2;\r\n            var _loc_2 = true;\r\n            this.bitmap_Bandes_280.visible = true;\r\n            this.bitmap_Billard_280.visible = _loc_2;\r\n            var _loc_2 = false;\r\n            this.bitmap_Bandes_260.visible = false;\r\n            this.bitmap_Billard_260.visible = _loc_2;\r\n        }\r\n        else if (param1 == 2)\r\n        {\r\n            this.taille(260);\r\n            var _loc_2 = false;\r\n            this.bitmap_Bandes_310.visible = false;\r\n            this.bitmap_Billard_310.visible = _loc_2;\r\n            var _loc_2 = false;\r\n            this.bitmap_Bandes_280.visible = false;\r\n            this.bitmap_Billard_280.visible = _loc_2;\r\n            var _loc_2 = true;\r\n            this.bitmap_Bandes_260.visible = true;\r\n            this.bitmap_Billard_260.visible = _loc_2;\r\n        }\r\n        else if (param1 == 0)\r\n        {\r\n            this.taille(310);\r\n            var _loc_2 = true;\r\n            this.bitmap_Bandes_310.visible = true;\r\n            this.bitmap_Billard_310.visible = _loc_2;\r\n            var _loc_2 = false;\r\n            this.bitmap_Bandes_280.visible = false;\r\n            this.bitmap_Billard_280.visible = _loc_2;\r\n            var _loc_2 = false;\r\n            this.bitmap_Bandes_260.visible = false;\r\n            this.bitmap_Billard_260.visible = _loc_2;\r\n        }\r\n        this.ctrl.XC = this.Ech * this.longueur / 2;\r\n        this.ctrl.YC = this.Ech * this.largeur / 2;\r\n        this.Params.long_billard = (this.xmax + this.R) * 2;\r\n        this.Params.larg_billard = (this.ymax + this.R) * 2;\r\n        if (this.Simulateur != null)\r\n        {\r\n            this.Simulateur.XMAX = this.xmax;\r\n            this.Simulateur.YMAX = this.ymax;\r\n            this.Simulateur.XMIN = -this.xmax;\r\n            this.Simulateur.YMIN = -this.ymax;\r\n        }\r\n        this.tracer_grille();\r\n        this.tracer_lines();\r\n        this.Placer_billes_hasard();\r\n        this.Params.Vqueue = 1;\r\n        this.init_point();\r\n        return;\r\n    }// end function\r\n\r\n    arret_son = () => {}\r\n\r\n    init_point = () => {\r\n        this.arret_son();\r\n        this.myTimer.stop();\r\n        this.afficher_billes();\r\n        this.ctrl.aff_parametres();\r\n        this.placer_queue(this.dq0);\r\n        this.queue.visible = true;\r\n        this.calculs_faits = false;\r\n        this.aff_trajets = false;\r\n        this.trajets.graphics.clear();\r\n        this.tracer_ligne_visee();\r\n        this.ligne_visee.visible = true;\r\n        return;\r\n    }// end function\r\n\r\n    update_modejeu = (param1) => {\r\n        this.mode_jeu = param1;\r\n        this.arret_son();\r\n        // this.myTimer.stop();\r\n        if (param1 == 0)\r\n        {\r\n            this.Vqmax = 3.5;\r\n        }\r\n        if (param1 == 1)\r\n        {\r\n            this.Vqmax = 3.5;\r\n        }\r\n        if (param1 == 2)\r\n        {\r\n            this.Vqmax = 4.2;\r\n        }\r\n        if (param1 == 3)\r\n        {\r\n            this.Vqmax = 3.5;\r\n        }\r\n        if (param1 == 4)\r\n        {\r\n            this.Vqmax = 3.5;\r\n        }\r\n        if (param1 == 5)\r\n        {\r\n            this.Vqmax = 5.4;\r\n        }\r\n        return;\r\n    }// end function\r\n    Simuler = (param1, param2) => {\r\n        var _loc_2 = 0;\r\n        this.ralenti = param1;\r\n        // this.ligne_visee.visible = false;\r\n        this.arret_son();\r\n        return this.Simulateur.Calcul(param2);\r\n    }\r\n\r\n    taille = (param1) => {\r\n        this.taille_billard = param1;\r\n        if (param1 == 310)\r\n        {\r\n            this.longueur = 3.12;\r\n        }\r\n        if (param1 == 280)\r\n        {\r\n            this.longueur = 2.82;\r\n        }\r\n        if (param1 == 260)\r\n        {\r\n            this.longueur = 2.62;\r\n        }\r\n        this.xmax = (this.longueur - this.largeur_bandes) / 2 - 0.03;\r\n        this.ymax = (this.longueur - this.largeur_bandes) / 4 - 0.03;\r\n        this.largeur = 2 * (this.ymax + 0.03) + this.largeur_bandes;\r\n        return;\r\n    }// end function\r\n}","import * as BABYLON from 'babylonjs';\r\nimport {\r\n    TABLE_LENGTH,\r\n    BALL_SIZE,\r\n\r\n    fileTableModel,\r\n    fileBatModel,\r\n\r\n} from '../constants';\r\n\r\nimport CBillard from './OriginSimulatorEngine/cBillard';\r\n\r\nexport default class SceneManager {\r\n    constructor (\r\n        size,\r\n        modelStorePath,\r\n        currentView,\r\n        ballPositions,\r\n        controlOptions\r\n    ) {\r\n        this.scene = undefined;\r\n        this.canvas = undefined;\r\n\r\n        this.size = size;\r\n\r\n        this.ballRadius = 400 * BALL_SIZE / (this.size * 100);\r\n\r\n        this.modelStorePath = modelStorePath;\r\n\r\n        this.initBallPosition = ballPositions;\r\n        this.ballPositions = {\r\n            posCueBallWhite: {\r\n                x: TABLE_LENGTH * ballPositions.posCueBallWhite.x / size,\r\n                z: TABLE_LENGTH * ballPositions.posCueBallWhite.z / size\r\n            },\r\n            posCueBallYellow: {\r\n                x: TABLE_LENGTH * ballPositions.posCueBallYellow.x / size,\r\n                z: TABLE_LENGTH * ballPositions.posCueBallYellow.z / size\r\n            },\r\n            posTargetBall: {\r\n                x: TABLE_LENGTH * ballPositions.posTargetBall.x / size,\r\n                z: TABLE_LENGTH * ballPositions.posTargetBall.z / size\r\n            }\r\n        };\r\n\r\n        this.currentView = currentView;\r\n\r\n        this.cameras = {\r\n            arcCam: undefined,\r\n            topCam: undefined\r\n        };\r\n\r\n        this.objects = {\r\n            table: undefined,\r\n            bat: undefined,\r\n            cueBallWhite: undefined,\r\n            cueBallYellow: undefined,\r\n            targetBall: undefined,\r\n            batContactLine: undefined,\r\n            batLookatPoint: undefined,\r\n            directionLine: undefined,\r\n        };\r\n\r\n        this.controlOptions = controlOptions;\r\n\r\n        this.grids = [];\r\n\r\n        this.pathCueWhite = undefined;\r\n        this.pathCueYellow = undefined;\r\n        this.pathTargetBall = undefined;\r\n\r\n        this.billard = new CBillard(\r\n            310,\r\n            undefined,\r\n            300,\r\n        );\r\n        \r\n        this.timerCount = 0;\r\n\r\n        this.RAp0 = [0, 0, 0]\r\n        this.RAq0 = [0, 0, 0]\r\n        this.RAr0 = [0, 0, 0]\r\n    }\r\n\r\n    drawBallPath = (value) => {\r\n        let res = this.pathData\r\n\r\n        if(!res || res.length == 0) return;\r\n        if(this.pathCueWhite){\r\n            this.pathCueWhite.dispose()\r\n        } \r\n        \r\n        if(this.pathCueYellow){\r\n            this.pathCueYellow.dispose()\r\n        }\r\n\r\n        if(this.pathTargetBall){\r\n            this.pathTargetBall.dispose()\r\n        } \r\n        \r\n        if (value) {\r\n            var whiteBallPoints = [];\r\n            for (var i = 0; i < 10000; i++) {\r\n                if (res[i]) {\r\n                    whiteBallPoints.push(new BABYLON.Vector3(\r\n                        TABLE_LENGTH * res[i].X / this.size,\r\n                        this.ballRadius / 2,\r\n                        TABLE_LENGTH * res[i].Y / this.size\r\n                    ))\r\n                }\r\n            }\r\n            this.pathCueWhite = BABYLON.MeshBuilder.CreateLines(\r\n                'lines',\r\n                {\r\n                    points: whiteBallPoints\r\n                }, \r\n                this.scene\r\n            );\r\n\r\n            var yellowBallPoints = [];\r\n            var colorYellow = [];\r\n            for (i = 10000; i < 20000; i++) {\r\n                if (res[i]) {\r\n                    yellowBallPoints.push(new BABYLON.Vector3(\r\n                        TABLE_LENGTH * res[i].X / this.size,\r\n                        this.ballRadius / 2,\r\n                        TABLE_LENGTH * res[i].Y / this.size\r\n                    ));\r\n                    colorYellow.push(new BABYLON.Color4(0.8, 0.8, 0, 1));\r\n                }\r\n            }\r\n\r\n            this.pathCueYellow = BABYLON.MeshBuilder.CreateLines(\r\n                'lines',\r\n                {\r\n                    points: yellowBallPoints,\r\n                    colors: colorYellow\r\n                }, \r\n                this.scene\r\n            );\r\n\r\n            var redBallPoints = [];\r\n            var colorRed = [];\r\n\r\n            for (i = 20000; i < 30000; i++) {\r\n                if (res[i]) {\r\n                    redBallPoints.push(new BABYLON.Vector3(\r\n                        TABLE_LENGTH * res[i].X / this.size,\r\n                        this.ballRadius / 2,\r\n                        TABLE_LENGTH * res[i].Y / this.size\r\n                    ));\r\n                    colorRed.push(new BABYLON.Color4(0.8, 0, 0, 1));\r\n                }\r\n            }\r\n\r\n            this.pathTargetBall = BABYLON.MeshBuilder.CreateLines(\r\n                'lines',\r\n                {\r\n                    points: redBallPoints,\r\n                    colors: colorRed\r\n                }, \r\n                this.scene\r\n            );\r\n        }        \r\n    }\r\n\r\n    configCameras = () => {\r\n        const _self = this;\r\n        _self.cameras.arcCam = new BABYLON.ArcRotateCamera(\"Camera-Arc\", 4.44, 1.05, 300, BABYLON.Vector3.Zero(), _self.scene);\r\n        _self.cameras.arcCam.attachControl(_self.canvas);\r\n        _self.cameras.arcCam.upperBetaLimit = 1.5;\r\n        _self.cameras.arcCam.wheelPrecision = 0.2;\r\n        \r\n        _self.cameras.arcCam.upperRadiusLimit = 500;\r\n        _self.cameras.arcCam.lowerRadiusLimit = 100;\r\n        \r\n        _self.cameras.topCam = new BABYLON.ArcRotateCamera(\"Camera-Top\", -Math.PI/2, 0, 330, BABYLON.Vector3.Zero(), _self.scene);\r\n\r\n        _self.cameras.topCam.upperBetaLimit = 0;\r\n        _self.cameras.topCam.lowerBetaLimit = 0;\r\n\r\n        _self.cameras.topCam.upperAlphaLimit = -Math.PI/2;\r\n        _self.cameras.topCam.lowerAlphaLimit = -Math.PI/2;\r\n\r\n        _self.cameras.topCam.upperRadiusLimit = 330;\r\n        _self.cameras.topCam.lowerRadiusLimit = 330;\r\n\r\n        _self.cameras.topCam.mode = BABYLON.Camera.ORTHOGRAPHIC_CAMERA;\r\n        _self.cameras.topCam.orthoTop = 130;\r\n        _self.cameras.topCam.orthoBottom = -130;\r\n        _self.cameras.topCam.orthoLeft = -240;\r\n        _self.cameras.topCam.orthoRight = 240;\r\n\r\n        _self.changeView(_self.currentView);\r\n    }\r\n\r\n    loadModels = () => {\r\n        const _self = this;\r\n        const { modelStorePath } = this;\r\n\r\n        BABYLON.SceneLoader.ImportMesh(\"\", modelStorePath, fileBatModel, _self.scene, function (newMeshes) {\r\n            _self.objects.bat = newMeshes[0];\r\n            _self.objects.bat.position.y = 50;\r\n            _self.objects.bat.position.z = 90;\r\n\r\n            _self.objects.batLookatPoint = new BABYLON.MeshBuilder.CreateSphere(\r\n                'look-at',\r\n                {\r\n                    diameter: 4\r\n                },\r\n                _self.scene\r\n            )\r\n            \r\n            // _self.objects.batLookatPoint.parent = _self.objects.bat;\r\n            _self.objects.batLookatPoint.position.y = 30;\r\n            _self.objects.batLookatPoint.visibility = false;\r\n            \r\n            BABYLON.SceneLoader.ImportMesh(\"\", modelStorePath, fileTableModel, _self.scene, function (newMeshes) {\r\n                _self.objects.table = newMeshes;\r\n                for(var obj of newMeshes){\r\n                    if(obj.name === 'carpet'){\r\n                        // assign bump\r\n                        obj.material.bumpTexture = new BABYLON.Texture(modelStorePath+'carpet-bump.png', _self.scene);\r\n                        // end assign bump\r\n                    }\r\n                }\r\n                \r\n                _self.configCueBalls();\r\n                _self.updateBat(_self.controlOptions);\r\n            });\r\n        });\r\n    }\r\n\r\n    updateControlOptions = (data) => {\r\n        this.controlOptions = data;\r\n        this.updateBat(data);\r\n    }\r\n\r\n    updateBat = (data) => {\r\n        const {\r\n            cueLine,\r\n            cueAngle,\r\n            sideEnglish,\r\n            topSpin,\r\n        } = data;\r\n        const {size, ballRadius} = this;\r\n        const {bat, batLookatPoint, directionLine, cueBallWhite} = this.objects;\r\n\r\n        let deltaSideEnglish = TABLE_LENGTH * sideEnglish / size;\r\n        let deltaTopSpin = TABLE_LENGTH * topSpin / size;\r\n\r\n        bat.position.x = cueBallWhite.position.x\r\n                         - deltaSideEnglish * Math.sin(cueLine)\r\n                         - deltaTopSpin * Math.sin(cueAngle) * Math.cos(cueLine);\r\n        bat.position.z = cueBallWhite.position.z\r\n                         + deltaSideEnglish * Math.cos(cueLine)\r\n                         - deltaTopSpin * Math.sin(cueAngle) * Math.sin(cueLine);\r\n        bat.position.y = ballRadius/2\r\n                         + deltaTopSpin * Math.cos(cueAngle);\r\n        \r\n        bat.rotation = new BABYLON.Vector3(\r\n            0,\r\n            -cueLine,\r\n            Math.PI/2 + cueAngle\r\n        );\r\n\r\n        // update look at point\r\n        var lookAtPoint = Object.assign({}, bat.position);\r\n        lookAtPoint.y += 40 * Math.sin(cueAngle);\r\n        lookAtPoint.x += 40 * Math.cos(cueAngle) * Math.cos(cueLine);\r\n        lookAtPoint.z += 40 * Math.cos(cueAngle) * Math.sin(cueLine);\r\n        batLookatPoint.position = lookAtPoint;\r\n        batLookatPoint.lookAt(bat.position);\r\n        // end update look at point\r\n\r\n        // update direction line\r\n        directionLine.position.x = cueBallWhite.position.x;\r\n        directionLine.position.z = cueBallWhite.position.z;\r\n        directionLine.position.y = ballRadius/2;\r\n\r\n        directionLine.rotation.y = Math.PI - cueLine;\r\n        // end update direction line\r\n    }\r\n\r\n    generateReflectionMaterial = (root, others) => {\r\n        let {scene} = this;\r\n\t\t\r\n\t\tvar probe = new BABYLON.ReflectionProbe(\"satelliteProbe\" + root.name, 512, scene);\r\n\t\tfor (var index = 0; index < others.length; index++) {\r\n\t\t\tprobe.renderList.push(others[index]);\t\t\t\r\n\t\t}\r\n\t\t\r\n        root.material.reflectionTexture = probe.cubeTexture;\r\n        root.material.reflectivityColor = new BABYLON.Color3(0.2, 0.2, 0.2);\r\n\t\t\r\n\t\troot.material.reflectionFresnelParameters = new BABYLON.FresnelParameters();\r\n        root.material.reflectionFresnelParameters.bias = 0;\r\n\t\tprobe.attachToMesh(root);\r\n    }\r\n    \r\n    configCueBalls = () => {\r\n        const _self = this;\r\n        const {\r\n            modelStorePath,\r\n            ballRadius\r\n        } = this;\r\n\r\n        const { table } = this.objects;\r\n        const {arcCam} = this.cameras;\r\n        let carpet, rail;\r\n        for(var obj of table) {\r\n            if (obj.name === 'carpet') {\r\n                carpet = obj;\r\n            } else if (obj.name === 'carpet-side') {\r\n                rail = obj;\r\n            }\r\n        }\r\n        let {\r\n            posCueBallWhite,\r\n            posCueBallYellow,\r\n            posTargetBall\r\n        } = this.ballPositions;\r\n\r\n        _self.objects.cueBallWhite = BABYLON.Mesh.CreateSphere(\"cue-ball-white\", 16, ballRadius, _self.scene);\r\n        _self.objects.cueBallWhite.position.y = ballRadius/2;\r\n        _self.objects.cueBallWhite.position.x = posCueBallWhite.x;\r\n        _self.objects.cueBallWhite.position.z = posCueBallWhite.z;\r\n        // arcCam.setTarget(_self.objects.cueBallWhite);\r\n\r\n        var matCueBallWhite = new BABYLON.StandardMaterial(\"redMat\", _self.scene);\r\n        matCueBallWhite.diffuseTexture = new BABYLON.Texture(modelStorePath + \"cueball-white.jpg\", _self.scene);\r\n        _self.objects.cueBallWhite.material = matCueBallWhite;\r\n\r\n        _self.objects.cueBallYellow = BABYLON.Mesh.CreateSphere(\"cue-ball-yellow\", 16, ballRadius, _self.scene);\r\n        _self.objects.cueBallYellow.position.y = ballRadius/2;\r\n        _self.objects.cueBallYellow.position.x = posCueBallYellow.x;\r\n        _self.objects.cueBallYellow.position.z = posCueBallYellow.z;\r\n\r\n        var matCueBallYellow = new BABYLON.StandardMaterial(\"redMat\", _self.scene);\r\n        matCueBallYellow.diffuseTexture = new BABYLON.Texture(modelStorePath + \"cueball-yellow.jpg\", _self.scene);\r\n        _self.objects.cueBallYellow.material = matCueBallYellow;\r\n\r\n        _self.objects.targetBall = BABYLON.Mesh.CreateSphere(\"cue-ball-red\", 16, ballRadius, _self.scene);\r\n        _self.objects.targetBall.position.y = ballRadius/2;\r\n        _self.objects.targetBall.position.x = posTargetBall.x;\r\n        _self.objects.targetBall.position.z = posTargetBall.z;\r\n\r\n        var matTargetBall = new BABYLON.StandardMaterial(\"redMat\", _self.scene);\r\n        matTargetBall.diffuseTexture = new BABYLON.Texture(modelStorePath + \"targetball.jpg\", _self.scene);\r\n        _self.objects.targetBall.material = matTargetBall;\r\n\r\n        _self.generateReflectionMaterial(_self.objects.cueBallWhite, [_self.objects.cueBallYellow, _self.objects.targetBall, _self.objects.bat, carpet, rail]);\r\n        _self.generateReflectionMaterial(_self.objects.cueBallYellow, [_self.objects.cueBallWhite, _self.objects.targetBall, _self.objects.bat, carpet, rail]);\r\n        _self.generateReflectionMaterial(_self.objects.targetBall, [_self.objects.cueBallWhite, _self.objects.cueBallYellow, _self.objects.bat, carpet, rail]);\r\n\r\n        //contact points\r\n        _self.objects.ray = new BABYLON.Ray();\r\n        _self.objects.rayHelper = new BABYLON.RayHelper(_self.objects.ray);\r\n        var localMeshDirection = new BABYLON.Vector3(0, 0, 1);\r\n        // _self.cameras.arcCam.setTarget(_self.objects.batLookatPoint)\r\n        \r\n        _self.objects.rayHelper.attachToMesh(_self.objects.batLookatPoint, localMeshDirection);\r\n        // _self.objects.rayHelper.show(_self.scene);\r\n    }\r\n\r\n    configGrids = () => {\r\n        const _self = this;\r\n        const grayRate = 0.7;\r\n        const color = [new BABYLON.Color4(grayRate,grayRate,grayRate,1), new BABYLON.Color4(grayRate,grayRate,grayRate,1)];\r\n        for (var i = 0; i < 15; i++) {\r\n            let gridPoints = [\r\n                new BABYLON.Vector3(-TABLE_LENGTH*7/16 + i * TABLE_LENGTH/16, 2, -TABLE_LENGTH/4),\r\n                new BABYLON.Vector3(-TABLE_LENGTH*7/16 + i * TABLE_LENGTH/16, 2, TABLE_LENGTH/4)\r\n            ];\r\n            _self.grids.push(BABYLON.MeshBuilder.CreateLines(\"lines\", {points: gridPoints, colors: color}, _self.scene));\r\n        }\r\n        for (i = 0; i < 7; i++) {\r\n            let gridPoints = [\r\n                new BABYLON.Vector3(-TABLE_LENGTH/2, 2, -TABLE_LENGTH*3/16 + i * TABLE_LENGTH/16),\r\n                new BABYLON.Vector3(TABLE_LENGTH/2, 2, -TABLE_LENGTH*3/16 + i * TABLE_LENGTH/16)\r\n            ];\r\n            _self.grids.push(BABYLON.MeshBuilder.CreateLines(\"lines\", {points: gridPoints, colors: color}, _self.scene));\r\n        }\r\n    }\r\n\r\n    toggleGrids = (visible) => {\r\n        const {grids} = this;\r\n        for (var i = 0; i < grids.length; i++) {\r\n            grids[i].visibility = visible;\r\n        }\r\n    }\r\n\r\n    initializeScene = (scene, canvas) => {\r\n        let _self = this;\r\n        _self.scene = scene;\r\n        _self.canvas = canvas;\r\n\r\n        _self.scene.clearColor = new BABYLON.Color3(0.05, 0.05, 0.05);\r\n        _self.objects.directionLine = new BABYLON.MeshBuilder.CreateLines(\r\n            'direction-line',\r\n            {\r\n                points: [\r\n                    new BABYLON.Vector3(0, 0, 0),\r\n                    new BABYLON.Vector3(600, 0, 0)\r\n                ],\r\n                colors: [\r\n                    new BABYLON.Color4(0, 0, 0.8, 1),\r\n                    new BABYLON.Color4(0, 0, 0.8, 1),\r\n                ]\r\n            }\r\n        )\r\n\r\n        new BABYLON.HemisphericLight('light', BABYLON.Vector3.Up(), scene);\r\n\r\n        _self.configCameras();\r\n        _self.loadModels();\r\n        _self.configGrids();\r\n\r\n        _self.scene.getEngine().runRenderLoop(() => {\r\n            if (scene) {\r\n                scene.render();\r\n                _self.animateBalls();\r\n            }\r\n        });\r\n\r\n        canvas.addEventListener(\"pointerdown\", _self.onPointerDown, false);\r\n        canvas.addEventListener(\"pointerup\", _self.onPointerUp, false);\r\n        canvas.addEventListener(\"pointermove\", _self.onPointerMove, false);\r\n    }\r\n\r\n    getGroundPosition = () => {\r\n        let {scene} = this;\r\n        var pickinfo = scene.pick(scene.pointerX, scene.pointerY, function (mesh) { return mesh.name == 'carpet'; });\r\n        if (pickinfo.hit) {\r\n            return pickinfo.pickedPoint;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    onPointerDown = (evt) => {\r\n        let _self = this;\r\n        let {scene, canvas} = this;\r\n        if (evt.button !== 0) {\r\n            return;\r\n        }\r\n\r\n        // check if we are under a mesh\r\n        var pickInfo = scene.pick(scene.pointerX, scene.pointerY, function (mesh) {return (mesh.name === 'cue-ball-white' || mesh.name === 'cue-ball-yellow' || mesh.name === 'cue-ball-red')});\r\n        if (pickInfo.hit) {\r\n            _self.currentMesh = pickInfo.pickedMesh;\r\n            _self.startingPoint = _self.getGroundPosition(evt);\r\n\r\n            if (_self.startingPoint) {\r\n                setTimeout(function () {\r\n                    _self.cameras.arcCam.detachControl(canvas);\r\n                }, 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    onPointerUp = () => {\r\n        let _self = this;\r\n        let {startingPoint, canvas} = this;\r\n        if (startingPoint) {\r\n            _self.cameras.arcCam.attachControl(canvas, true);\r\n            _self.startingPoint = null;\r\n            _self.currentMesh = null;\r\n            return;\r\n        }\r\n    }\r\n\r\n    onPointerMove = (evt) => {\r\n        let _self = this;\r\n        let {startingPoint, currentMesh} = this;\r\n        if (!startingPoint) {\r\n            return;\r\n        }\r\n\r\n        var current = _self.getGroundPosition(evt);\r\n\r\n        if (!current) {\r\n            return;\r\n        }\r\n        \r\n        currentMesh.position = current;\r\n        currentMesh.position.y = _self.ballRadius/2\r\n\r\n        startingPoint = current;\r\n        _self.updateBat(_self.controlOptions);\r\n    }\r\n\r\n    changeView (view) {\r\n        const _self = this;\r\n        \r\n        if (view === '2d') {\r\n            _self.scene.activeCamera = _self.cameras.topCam;\r\n            _self.cameras.arcCam.detachControl(_self.canvas);\r\n            _self.cameras.topCam.attachControl(_self.canvas);\r\n        } else {\r\n            _self.scene.activeCamera = _self.cameras.arcCam;\r\n            _self.cameras.arcCam.attachControl(_self.canvas);\r\n            _self.cameras.topCam.detachControl(_self.canvas);\r\n        }\r\n    }\r\n\r\n    moveAndRotateBall = (obj, t, tmp, ) => {\r\n        let range = 10000;\r\n        let index = -1;\r\n        let _self = this;\r\n        let i;\r\n        for(i = tmp * range ; i < (tmp + 1) * range; i++){\r\n            if(_self.pathData[i])\r\n            {\r\n                if(_self.pathData[i].time < (t - _self.t0)){\r\n                    index = i;\r\n                }\r\n            } else { break;}\r\n        }\r\n        if(index >= 0){\r\n            if (index == i-1) {\r\n                return false;\r\n            }\r\n            let data = _self.pathData[index];\r\n            obj.position.x = TABLE_LENGTH * data.X / _self.size;\r\n            obj.position.z = TABLE_LENGTH * data.Y / _self.size;\r\n\r\n            let RAp = _self.pathData[index].RAp;\r\n            let RAq = _self.pathData[index].RAq;\r\n            let RAr = _self.pathData[index].RAr;\r\n\r\n            const R = 0.03;\r\n            let Rx = (RAp - _self.RAp0[tmp]) / R\r\n            let Ry = (RAq - _self.RAq0[tmp]) / R\r\n            let Rz = (RAr - _self.RAr0[tmp]) / R\r\n\r\n            _self.RAp0[tmp] = RAp\r\n            _self.RAq0[tmp] = RAq\r\n            _self.RAr0[tmp] = RAr\r\n\r\n            obj.rotate(BABYLON.Axis.X, -Rx, BABYLON.Space.WORLD);\r\n            obj.rotate(BABYLON.Axis.Y, -Rz, BABYLON.Space.WORLD);\r\n            obj.rotate(BABYLON.Axis.Z, -Ry, BABYLON.Space.WORLD);\r\n            return true;\r\n        }\r\n    }\r\n    \r\n    animateBalls = () => {\r\n        let _self = this;\r\n        let { cueBallWhite, cueBallYellow, targetBall } = this.objects;\r\n        if(!_self.pathData || _self.pathData.length == 0) return;\r\n        if (_self.t0 == undefined) return;\r\n        let t = new Date().getTime() / 1000;\r\n\r\n        var res1 = this.moveAndRotateBall(cueBallWhite, t, 0);\r\n        var res2 = this.moveAndRotateBall(cueBallYellow, t, 1);\r\n        var res3 = this.moveAndRotateBall(targetBall, t, 2);\r\n        console.log(res1, res2, res3);\r\n        if (res1 == false && res2 == false && res3 == false) _self.pathData = [];\r\n    }\r\n\r\n    playSimulation = () => {\r\n        var _self = this;\r\n        const ballPositions = this.initBallPosition;\r\n        const {controlOptions} = this;\r\n        const {\r\n            cueBallWhite,\r\n            cueBallYellow,\r\n            targetBall\r\n        } = this.objects;\r\n        var res = this.billard.Simuler(\r\n            1,\r\n            {\r\n                Xinit: [\r\n                    _self.size * cueBallWhite.position.x / TABLE_LENGTH,\r\n                    _self.size * cueBallYellow.position.x / TABLE_LENGTH,\r\n                    _self.size * targetBall.position.x / TABLE_LENGTH\r\n                ],\r\n                Yinit: [\r\n                    _self.size * cueBallWhite.position.z / TABLE_LENGTH,\r\n                    _self.size * cueBallYellow.position.z / TABLE_LENGTH,\r\n                    _self.size * targetBall.position.z / TABLE_LENGTH\r\n                ],\r\n                RApInit: [0, 0, 0],\r\n                RAqInit: [0, 0, 0],\r\n                RArInit: [0, 0, 0],\r\n                el: controlOptions.sideEnglish,\r\n                er: controlOptions.topSpin,\r\n                alphaQ: controlOptions.cueAngle,\r\n                betaQ: controlOptions.cueLine,\r\n                Vqueue:controlOptions.speed,\r\n            }\r\n        );\r\n        console.log(res)\r\n\r\n        if(!res || res.length == 0) return;\r\n        \r\n        this.pathData = res;\r\n\r\n        this.t0 = new Date().getTime() / 1000;\r\n    }\r\n}","// import { EventType } from \"./eventtype\"\r\n// import { Controller } from \"../controller/controller\"\r\n\r\nexport class GameEvent {\r\n  constructor(){}\r\n  // type\r\n  applyToController(controller){}\r\n}\r\n","export const EventType = {\r\n  BEGIN: 0,\r\n  WATCHAIM: 1,\r\n  AIM: 2,\r\n  HIT: 3,\r\n  STATIONARY: 4,\r\n  CHAT: 5,\r\n  ABORT: 6,\r\n  REPOSITION: 7\r\n}\r\n","import { Vector3 } from \"three\"\r\n\r\nexport const zero = new Vector3(0, 0, 0)\r\nexport const up = new Vector3(0, 0, 1)\r\n\r\nexport function vec(v) {\r\n  return new Vector3(v.x, v.y, v.z)\r\n}\r\n\r\nexport function upCross(v) {\r\n  return up.clone().cross(v)\r\n}\r\n\r\nexport function norm(v) {\r\n  return v.clone().normalize()\r\n}\r\n\r\nexport function passesThroughZero(v, dv) {\r\n  return (\r\n    v\r\n      .clone()\r\n      .add(dv)\r\n      .dot(v) <= 0\r\n  )\r\n}\r\n","import { GameEvent } from \"./gameevent\"\r\nimport { Controller } from \"../controller/controller\"\r\nimport { Vector3 } from \"three\"\r\nimport { vec } from \"../utils/utils\"\r\n\r\nexport class AimEvent {\r\n  pos = new Vector3(1, 0, 0)\r\n  dir = new Vector3(1, 0, 0)\r\n  verticalOffset = 0\r\n  sideOffset = 0\r\n  angle = 0\r\n  power = 0\r\n\r\n  constructor() {\r\n    // console.log(EventType)\r\n    // this.type = EventType.AIM\r\n  }\r\n\r\n  applyToController(controller) {\r\n    return controller.handleAim(this)\r\n  }\r\n\r\n  static fromJson(json) {\r\n    let event = new AimEvent()\r\n    event.pos = vec(json.pos)\r\n    event.dir = vec(json.dir)\r\n    event.angle = json.angle\r\n    event.verticalOffset = json.verticalOffset\r\n    event.sideOffset = json.sideOffset\r\n    event.power = json.power\r\n    return event\r\n  }\r\n\r\n  copy() {\r\n    let event = AimEvent.fromJson(this)\r\n    return event\r\n  }\r\n}\r\n","export class Input {\r\n  t\r\n  key\r\n\r\n  constructor(t, key) {\r\n    this.t = t\r\n    this.key = key\r\n  }\r\n}\r\n","import { GameEvent } from \"./gameevent\"\r\nimport { EventType } from \"./eventtype\"\r\nimport { Controller } from \"../controller/controller\"\r\n\r\nexport class StationaryEvent extends GameEvent {\r\n  constructor() {\r\n    super()\r\n    this.type = EventType.STATIONARY\r\n  }\r\n\r\n  applyToController(controller) {\r\n    return controller.handleStationary(this)\r\n  }\r\n\r\n  static fromJson(_) {\r\n    let event = new StationaryEvent()\r\n    return event\r\n  }\r\n}\r\n","export const mu = 0.006\r\nexport const g = 9.8\r\nexport const rho = 0.4\r\nexport const m = 0.1\r\nexport const Mz = ((mu * m * g * 2) / 3) * rho\r\nexport const Mxy = (7 / (5 * Math.sqrt(2))) * mu * m * g\r\nexport const e = 0.8\r\n","import { Vector3 } from \"three\"\r\nimport { norm, upCross, up } from \"../../utils/utils\"\r\nimport { mu, g, m, e, Mz, Mxy } from \"./constants\"\r\n\r\nexport function surfaceVelocity(v, w) {\r\n  return v\r\n    .clone()\r\n    .add(upCross(w))\r\n    .setZ(0)\r\n}\r\n\r\nexport function sliding(v, w, dv, dw) {\r\n  let va = surfaceVelocity(v, w)\r\n  dv.copy(norm(va).multiplyScalar(-mu * g))\r\n  dw.copy(norm(upCross(va)).multiplyScalar((5 / 2) * mu * g))\r\n  dw.setZ(-(5 / 2) * Mz * Math.sign(w.z))\r\n}\r\n\r\nexport function slidingFull(v, w, dv, dw) {\r\n  let va = new Vector3(v.x - w.y, v.y + w.x, 0)\r\n  dv.set(-mu * g * norm(va).x, -mu * g * norm(va).y, 0)\r\n  dw.set(\r\n    (-5 / 2) * mu * g * norm(va).y,\r\n    (5 / 2) * mu * g * norm(va).x,\r\n    -(5 / 2) * Mz * Math.sign(w.z)\r\n  )\r\n}\r\n\r\nexport function rollingFull(w, dv, dw) {\r\n  let mag = new Vector3(w.x, w.y, 0).length()\r\n  let k = ((5 / 7) * Mxy) / mag\r\n  dv.set(-k * w.y, k * w.x, 0)\r\n  dw.set(-k * w.x, -k * w.y, -k * w.z)\r\n}\r\n\r\nexport function forceRoll(v, w) {\r\n  v.sub(surfaceVelocity(v, w).multiplyScalar(0.5))\r\n  w.copy(upCross(v))\r\n}\r\n\r\nlet sin_a = Math.sin(9.25 / 32.5)\r\nlet cos_a = Math.cos(9.25 / 32.5)\r\n\r\nlet sin_a2 = sin_a * sin_a\r\nlet cos_a2 = cos_a * cos_a\r\n\r\nexport function rotateApplyUnrotate(theta, v, w, dv, dw, f) {\r\n  let vr = v.clone().applyAxisAngle(up, theta)\r\n  let wr = w.clone().applyAxisAngle(up, theta)\r\n  f(vr, wr, dv, dw)\r\n  dv.applyAxisAngle(up, -theta)\r\n  dw.applyAxisAngle(up, -theta)\r\n}\r\n\r\nfunction s0(v, w) {\r\n  return new Vector3(\r\n    v.x * sin_a - v.z * cos_a + w.y,\r\n    -v.y - w.z * cos_a + w.x * sin_a\r\n  )\r\n}\r\n\r\nfunction c0(v) {\r\n  return v.x * cos_a - v.z * cos_a\r\n}\r\n\r\nlet A = 7 / (2 * m)\r\nlet B = 1 / m\r\n\r\nfunction Pzs(s0) {\r\n  return s0.length() / A\r\n}\r\n\r\nfunction Pze(c0) {\r\n  return ((1 + e) * c0) / B\r\n}\r\n\r\nexport function isCushionXGrip(v, w) {\r\n  return Pze(c0(v)) <= Pzs(s0(v, w))\r\n}\r\n\r\nexport function bounceWithoutSlipX(v, w, dv, dw) {\r\n  dv.set(\r\n    -v.x * ((2 / 7) * sin_a2 + (1 + e) * cos_a2) - (2 / 7) * w.y * sin_a,\r\n    (5 / 7) * v.y + (2 / 7) * (w.x * sin_a - w.z * cos_a) - v.y,\r\n    0\r\n  )\r\n\r\n  let s = s0(v, w)\r\n  let k = (5 * s.y) / (2 * m * A)\r\n\r\n  dw.set(\r\n    k * sin_a,\r\n    (5 / (2 * m)) *\r\n      (-s.x / A + ((sin_a * c0(v) * (1 + e)) / B) * (cos_a - sin_a)),\r\n    k * cos_a\r\n  )\r\n}\r\n\r\nexport function bounceWithOmegaZ(v, w, dv, dw) {\r\n  dv.set(-v.x * 1.9, -w.z, 0)\r\n  dw.set(0, 0, 0)\r\n}\r\n","import {\r\n  ArrowHelper,\r\n  IcosahedronGeometry,\r\n  Matrix4,\r\n  Mesh,\r\n  MeshPhongMaterial,\r\n  Line,\r\n  LineBasicMaterial,\r\n  Geometry\r\n} from \"three\"\r\nimport { norm, up, zero } from \"../utils/utils\"\r\n\r\nexport class BallMesh {\r\n  mesh\r\n  arrow\r\n\r\n  constructor() {\r\n    this.scene = undefined;\r\n    this.lineColor = [0xffffff, 0xff0000, 0x00ff00,0xffff00, 0x00ffff, 0xff00ff][parseInt(Math.random() * 1000) % 6];\r\n    this.initialiseMesh()\r\n    this.current = {x: 0, y: 0, z: 0}\r\n    this.t0 = new Date().getTime()\r\n  }\r\n\r\n  updatePosition(pos) {\r\n    let current = this.mesh.position;\r\n\r\n    if ((current.x != pos.x || current.y != pos.y || current.z != pos.z)) {\r\n      let t = new Date().getTime();\r\n      console.log(t - this.t0)\r\n      if((t - this.t0) >= 0.005){\r\n        this.t0 = t;\r\n        var material = new LineBasicMaterial({\r\n          color: this.lineColor,\r\n          linewidth: 10\r\n        });\r\n        \r\n        var geometry = new Geometry();\r\n        geometry.vertices.push(\r\n          Object.assign({}, current),\r\n          Object.assign({}, pos)\r\n        );\r\n        \r\n        var line = new Line( geometry, material );\r\n        this.mesh.parent.add( line );\r\n      }\r\n    }\r\n    this.mesh.position.copy(pos)\r\n  }\r\n\r\n  updateRotation(rvel, t) {\r\n    let angle = (rvel.length() * t * Math.PI) / 2\r\n    let m = new Matrix4().identity().makeRotationAxis(norm(rvel), angle)\r\n    this.mesh.geometry.applyMatrix(m)\r\n    this.arrow.setDirection(norm(rvel))\r\n    this.arrow.position.copy(this.mesh.position)\r\n    this.arrow.setLength(rvel.length() * 1 + 0.4)\r\n  }\r\n\r\n  initialiseMesh() {\r\n    var geometry = new IcosahedronGeometry(0.5, 1)\r\n    var material = new MeshPhongMaterial({\r\n      color: this.lineColor,\r\n      emissive: 0.4,\r\n    })\r\n    this.mesh = new Mesh(geometry, material)\r\n    this.mesh.castShadow = true\r\n    this.mesh.receiveShadow = true\r\n    this.mesh.name = \"ball\"\r\n    this.arrow = new ArrowHelper(up, zero, 2, 0xcc0000)\r\n  }\r\n\r\n  addToScene(scene) {\r\n    console.log('add to scene', scene)\r\n    scene.add(this.mesh)\r\n    scene.add(this.arrow)\r\n  }\r\n}\r\n","import { Vector3 } from \"three\"\r\nimport { zero, vec, passesThroughZero } from \"../utils/utils\"\r\nimport {\r\n  sliding,\r\n  surfaceVelocity,\r\n  rollingFull,\r\n  forceRoll\r\n} from \"./physics/physics\"\r\nimport { BallMesh } from \"../view/ballmesh\"\r\n\r\nexport const State = {\r\n  Stationary: \"Stationary\",\r\n  Rolling: \"Rolling\",\r\n  Sliding: \"Sliding\",\r\n  Falling: \"Falling\",\r\n  InPocket: \"InPocket\"\r\n}\r\n\r\nexport class Ball {\r\n  pos\r\n  vel = zero.clone()\r\n  rvel = zero.clone()\r\n  state = State.Stationary\r\n\r\n  mesh\r\n\r\n  transition = 0.05\r\n\r\n  constructor(pos) {\r\n    this.pos = pos.clone()\r\n    this.mesh = new BallMesh()\r\n  }\r\n\r\n  update(t) {\r\n    this.updatePosition(t)\r\n    this.updateVelocity(t)\r\n    this.mesh.updateRotation(this.rvel, t)\r\n  }\r\n\r\n  updatePosition(t) {\r\n    this.pos.addScaledVector(this.vel, t)\r\n    this.mesh.updatePosition(this.pos)\r\n  }\r\n\r\n  updateVelocity(t) {\r\n    if (this.inMotion()) {\r\n      if (this.isRolling()) {\r\n        this.updateVelocityRolling(t)\r\n      } else {\r\n        this.updateVelocitySliding(t)\r\n      }\r\n    }\r\n  }\r\n\r\n  updateVelocityRolling(t) {\r\n    forceRoll(this.vel, this.rvel)\r\n    let dv = new Vector3()\r\n    let dw = new Vector3()\r\n    rollingFull(this.rvel, dv, dw)\r\n    dv.multiplyScalar(t)\r\n    dw.multiplyScalar(t)\r\n    if (passesThroughZero(this.rvel, dw) || passesThroughZero(this.vel, dv)) {\r\n      this.setStationary()\r\n    } else {\r\n      this.vel.add(dv)\r\n      this.rvel.add(dw)\r\n      this.state = State.Rolling\r\n    }\r\n  }\r\n\r\n  updateVelocitySliding(t) {\r\n    let dv = new Vector3()\r\n    let dw = new Vector3()\r\n    sliding(this.vel, this.rvel, dv, dw)\r\n    dv.multiplyScalar(t)\r\n    dw.multiplyScalar(t)\r\n    if (passesThroughZero(this.rvel, dw) && passesThroughZero(this.vel, dv)) {\r\n      this.setStationary()\r\n    } else {\r\n      this.vel.add(dv)\r\n      this.rvel.add(dw)\r\n      this.state = State.Sliding\r\n    }\r\n  }\r\n\r\n  setStationary() {\r\n    this.vel.copy(zero)\r\n    this.rvel.copy(zero)\r\n    this.state = State.Stationary\r\n  }\r\n\r\n  isRolling() {\r\n    return (\r\n      surfaceVelocity(this.vel, this.rvel).length() < this.transition &&\r\n      this.vel.length() != 0\r\n    )\r\n  }\r\n\r\n  onTable() {\r\n    return this.state != State.Falling\r\n  }\r\n\r\n  inMotion() {\r\n    return this.onTable() && (this.vel.length() != 0 || this.rvel.length() != 0)\r\n  }\r\n\r\n  futurePosition(t) {\r\n    return this.pos.clone().addScaledVector(this.vel, t)\r\n  }\r\n\r\n  serialise() {\r\n    return { pos: this.pos, vel: this.vel, rvel: this.rvel, state: this.state }\r\n  }\r\n\r\n  static fromSerialised(data) {\r\n    return Ball.updateFromSerialised(new Ball(vec(data.pos)), data)\r\n  }\r\n\r\n  static updateFromSerialised(b, data) {\r\n    b.pos.copy(data.pos)\r\n    b.vel.copy(vec(data.vel))\r\n    b.rvel.copy(vec(data.rvel))\r\n    b.state = data.state\r\n    return b\r\n  }\r\n}\r\n","import { Ball } from \"../ball\"\r\nimport { TableGeometry } from \"../../view/tablegeometry\"\r\nimport { Cushion } from \"./cushion\"\r\nimport { Vector3 } from \"three\"\r\n\r\nexport class Knuckle {\r\n  pos;\r\n  radius;\r\n\r\n  constructor(pos, radius) {\r\n    this.pos = pos\r\n    this.radius = radius\r\n  }\r\n\r\n  static willBounce(knuckle, futurePosition) {\r\n    return futurePosition.distanceTo(knuckle.pos) < 0.5 + knuckle.radius\r\n  }\r\n\r\n  bounce(ball) {\r\n    const kb = ball.pos\r\n      .clone()\r\n      .sub(this.pos)\r\n      .normalize()\r\n    let velDotCenters = kb.dot(ball.vel)\r\n    ball.vel.addScaledVector(kb, -2 * Cushion.elasticity * velDotCenters)\r\n  }\r\n\r\n  static willBounceAny(ball, t) {\r\n    let futurePosition = ball.futurePosition(t)\r\n    return (\r\n      ball.onTable() &&\r\n      TableGeometry.knuckles.find(k => Knuckle.willBounce(k, futurePosition))\r\n    )\r\n  }\r\n}\r\n","import { Ball, State } from \"../ball\"\r\nimport { TableGeometry } from \"../../view/tablegeometry\"\r\nimport { Vector3 } from \"three\"\r\n\r\nexport class Pocket {\r\n  pos;\r\n  radius;\r\n\r\n  constructor(pos, radius) {\r\n    this.pos = pos\r\n    this.radius = radius\r\n  }\r\n\r\n  static willFall(pocket, futurePosition) {\r\n    return futurePosition.distanceTo(pocket.pos) < 0.5 + pocket.radius\r\n  }\r\n\r\n  fall(ball, t) {\r\n    const kb = ball.pos\r\n      .clone()\r\n      .sub(this.pos)\r\n      .normalize()\r\n    ball.vel.addScaledVector(kb, 1 * t)\r\n    ball.vel.z = -1\r\n    ball.state = State.Falling\r\n  }\r\n\r\n  static willFallAny(ball, t) {\r\n    let futurePosition = ball.futurePosition(t)\r\n    return (\r\n      ball.onTable() &&\r\n      TableGeometry.pocketCenters.find(p => Pocket.willFall(p, futurePosition))\r\n    )\r\n  }\r\n}\r\n","import { Vector3, Matrix4 } from \"three\"\r\nimport { Mesh, CylinderGeometry, BoxGeometry, MeshPhongMaterial } from \"three\"\r\nimport { Knuckle } from \"../model/physics/knuckle\"\r\nimport { Pocket } from \"../model/physics/pocket\"\r\n\r\nexport class TableGeometry {\r\n  static tableX = (21 * 2) / 3\r\n  static tableY = (11 * 2) / 3\r\n  static X = TableGeometry.tableX + 0.5\r\n  static Y = TableGeometry.tableY + 0.5\r\n  static PX = TableGeometry.tableX + 1.6\r\n  static PY = TableGeometry.tableY + 1.6\r\n  static knuckleInset = 0\r\n  static knuckleRadius = 0.5\r\n  static middleKnuckleInset = 0\r\n  static middleKnuckleRadius = 0.5\r\n  static cornerRadius = 1.0\r\n  static middleRadius = 0.4\r\n  static pockets = {\r\n    pocketNW: {\r\n      pocket: new Pocket(\r\n        new Vector3(-TableGeometry.PX, TableGeometry.PY, 0),\r\n        TableGeometry.cornerRadius\r\n      ),\r\n      knuckleNE: new Knuckle(\r\n        new Vector3(\r\n          -TableGeometry.X + TableGeometry.knuckleInset,\r\n          TableGeometry.Y + TableGeometry.knuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      ),\r\n      knuckleSW: new Knuckle(\r\n        new Vector3(\r\n          -TableGeometry.X - TableGeometry.knuckleRadius,\r\n          TableGeometry.Y - TableGeometry.knuckleInset,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      )\r\n    },\r\n    pocketN: {\r\n      pocket: new Pocket(\r\n        new Vector3(0, TableGeometry.PY, 0),\r\n        TableGeometry.middleRadius\r\n      ),\r\n      knuckleNE: new Knuckle(\r\n        new Vector3(\r\n          TableGeometry.knuckleInset,\r\n          TableGeometry.Y + TableGeometry.middleKnuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      ),\r\n      knuckleNW: new Knuckle(\r\n        new Vector3(\r\n          -TableGeometry.middleKnuckleInset,\r\n          TableGeometry.Y + TableGeometry.middleKnuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      )\r\n    },\r\n    pocketS: {\r\n      pocket: new Pocket(\r\n        new Vector3(0, -TableGeometry.PY, 0),\r\n        TableGeometry.middleRadius\r\n      ),\r\n      knuckleSE: new Knuckle(\r\n        new Vector3(\r\n          TableGeometry.knuckleInset,\r\n          -TableGeometry.Y - TableGeometry.middleKnuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      ),\r\n      knuckleSW: new Knuckle(\r\n        new Vector3(\r\n          -TableGeometry.middleKnuckleInset,\r\n          -TableGeometry.Y - TableGeometry.middleKnuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      )\r\n    },\r\n    pocketNE: {\r\n      pocket: new Pocket(\r\n        new Vector3(TableGeometry.PX, TableGeometry.PY, 0),\r\n        TableGeometry.cornerRadius\r\n      ),\r\n      knuckleNW: new Knuckle(\r\n        new Vector3(\r\n          TableGeometry.X - TableGeometry.knuckleInset,\r\n          TableGeometry.Y + TableGeometry.knuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      ),\r\n      knuckleSE: new Knuckle(\r\n        new Vector3(\r\n          TableGeometry.X + TableGeometry.knuckleRadius,\r\n          TableGeometry.Y - TableGeometry.knuckleInset,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      )\r\n    },\r\n    pocketSE: {\r\n      pocket: new Pocket(\r\n        new Vector3(TableGeometry.PX, -TableGeometry.PY, 0),\r\n        TableGeometry.cornerRadius\r\n      ),\r\n      knuckleNE: new Knuckle(\r\n        new Vector3(\r\n          TableGeometry.X + TableGeometry.knuckleRadius,\r\n          -TableGeometry.Y + TableGeometry.knuckleInset,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      ),\r\n      knuckleSW: new Knuckle(\r\n        new Vector3(\r\n          TableGeometry.X - TableGeometry.knuckleInset,\r\n          -TableGeometry.Y - TableGeometry.knuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      )\r\n    },\r\n    pocketSW: {\r\n      pocket: new Pocket(\r\n        new Vector3(-TableGeometry.PX, -TableGeometry.PY, 0),\r\n        TableGeometry.cornerRadius\r\n      ),\r\n      knuckleSE: new Knuckle(\r\n        new Vector3(\r\n          -TableGeometry.X + TableGeometry.knuckleInset,\r\n          -TableGeometry.Y - TableGeometry.knuckleRadius,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      ),\r\n      knuckleNW: new Knuckle(\r\n        new Vector3(\r\n          -TableGeometry.X - TableGeometry.knuckleRadius,\r\n          -TableGeometry.Y + TableGeometry.knuckleInset,\r\n          0\r\n        ),\r\n        TableGeometry.knuckleRadius\r\n      )\r\n    }\r\n  }\r\n\r\n  static knuckles = [\r\n    TableGeometry.pockets.pocketNW.knuckleNE,\r\n    TableGeometry.pockets.pocketNW.knuckleSW,\r\n    TableGeometry.pockets.pocketN.knuckleNW,\r\n    TableGeometry.pockets.pocketN.knuckleNE,\r\n    TableGeometry.pockets.pocketS.knuckleSW,\r\n    TableGeometry.pockets.pocketS.knuckleSE,\r\n    TableGeometry.pockets.pocketNE.knuckleNW,\r\n    TableGeometry.pockets.pocketNE.knuckleSE,\r\n    TableGeometry.pockets.pocketSE.knuckleNE,\r\n    TableGeometry.pockets.pocketSE.knuckleSW,\r\n    TableGeometry.pockets.pocketSW.knuckleSE,\r\n    TableGeometry.pockets.pocketSW.knuckleNW\r\n  ]\r\n\r\n  static pocketCenters = [\r\n    TableGeometry.pockets.pocketNW.pocket,\r\n    TableGeometry.pockets.pocketSW.pocket,\r\n    TableGeometry.pockets.pocketN.pocket,\r\n    TableGeometry.pockets.pocketS.pocket,\r\n    TableGeometry.pockets.pocketNE.pocket,\r\n    TableGeometry.pockets.pocketSE.pocket\r\n  ]\r\n\r\n  static addToScene(scene) {\r\n    // TableGeometry.knuckles.forEach(k => TableGeometry.knuckleCylinder(k, scene))\r\n    TableGeometry.addCushions(scene)\r\n    //    TableGeometry.addPockets(scene)\r\n  }\r\n\r\n  static material = new MeshPhongMaterial({\r\n    color: 0x111111,\r\n    wireframe: false,\r\n    flatShading: true\r\n  })\r\n\r\n  // static knuckleCylinder(knuckle, scene) {\r\n  //   let k = TableGeometry.cylinder(knuckle.pos, knuckle.radius, 0.75, scene)\r\n  //   k.position.setZ(0.25)\r\n  // }\r\n\r\n  static pocketCylinder(pocket, scene) {\r\n    TableGeometry.cylinder(\r\n      pocket.pos.clone().setZ(-0.5),\r\n      pocket.radius,\r\n      0.1,\r\n      scene\r\n    )\r\n  }\r\n\r\n  static cylinder(pos, radius, depth, scene) {\r\n    var geometry = new CylinderGeometry(radius, radius, depth, 16)\r\n    var mesh = new Mesh(geometry, TableGeometry.material)\r\n    mesh.position.copy(pos)\r\n    mesh.geometry.applyMatrix(\r\n      new Matrix4()\r\n        .identity()\r\n        .makeRotationAxis(new Vector3(1, 0, 0), Math.PI / 2)\r\n    )\r\n    scene.add(mesh)\r\n    return mesh\r\n  }\r\n\r\n  static addPockets(scene) {\r\n    TableGeometry.pocketCenters.forEach(p =>\r\n      TableGeometry.pocketCylinder(p, scene)\r\n    )\r\n  }\r\n\r\n  static addCushions(scene) {\r\n    let th = 12\r\n    TableGeometry.plane(\r\n      new Vector3(0, 0, -0.5 - th / 2),\r\n      2 * TableGeometry.X,\r\n      2 * TableGeometry.Y,\r\n      th,\r\n      scene\r\n    )\r\n\r\n    let d = 1\r\n    let h = 0.75\r\n    let e = -0.25 / 2\r\n    let lengthN = Math.abs(\r\n      TableGeometry.pockets.pocketNW.knuckleNE.pos.x -\r\n        TableGeometry.pockets.pocketN.knuckleNW.pos.x\r\n    )\r\n    let lengthE = Math.abs(\r\n      TableGeometry.pockets.pocketNW.knuckleSW.pos.y -\r\n        TableGeometry.pockets.pocketSW.knuckleNW.pos.y\r\n    )\r\n\r\n    TableGeometry.plane(\r\n      new Vector3(TableGeometry.X + d / 2, 0, e),\r\n      d,\r\n      lengthE,\r\n      h,\r\n      scene\r\n    )\r\n    TableGeometry.plane(\r\n      new Vector3(-TableGeometry.X - d / 2, 0, e),\r\n      d,\r\n      lengthE,\r\n      h,\r\n      scene\r\n    )\r\n\r\n    TableGeometry.plane(\r\n      new Vector3(-TableGeometry.X / 2, TableGeometry.Y + d / 2, e),\r\n      lengthN,\r\n      d,\r\n      h,\r\n      scene\r\n    )\r\n    TableGeometry.plane(\r\n      new Vector3(-TableGeometry.X / 2, -TableGeometry.Y - d / 2, e),\r\n      lengthN,\r\n      d,\r\n      h,\r\n      scene\r\n    )\r\n\r\n    TableGeometry.plane(\r\n      new Vector3(TableGeometry.X / 2, TableGeometry.Y + d / 2, e),\r\n      lengthN,\r\n      d,\r\n      h,\r\n      scene\r\n    )\r\n    TableGeometry.plane(\r\n      new Vector3(TableGeometry.X / 2, -TableGeometry.Y - d / 2, e),\r\n      lengthN,\r\n      d,\r\n      h,\r\n      scene\r\n    )\r\n  }\r\n\r\n  static plane(pos, x, y, z, scene) {\r\n    var geometry = new BoxGeometry(x, y, z)\r\n    var mesh = new Mesh(geometry, TableGeometry.material)\r\n    mesh.receiveShadow = true\r\n    mesh.position.copy(pos)\r\n    scene.add(mesh)\r\n  }\r\n}\r\n","import { Ball } from \"../ball\"\r\nimport { TableGeometry } from \"../../view/tablegeometry\"\r\nimport { rotateApplyUnrotate, bounceWithoutSlipX } from \"./physics\"\r\nimport { Vector3 } from \"three\"\r\n\r\nexport class Cushion {\r\n  static elasticity = 0.8\r\n\r\n  static willBounce(ball, t) {\r\n    let futurePosition = ball.futurePosition(t)\r\n\r\n    return (\r\n      ball.onTable() &&\r\n      (Cushion.willBounceLongSegment(\r\n        TableGeometry.pockets.pocketNW.knuckleNE.pos.x,\r\n        TableGeometry.pockets.pocketN.knuckleNW.pos.x,\r\n        futurePosition\r\n      ) ||\r\n        Cushion.willBounceLongSegment(\r\n          TableGeometry.pockets.pocketN.knuckleNE.pos.x,\r\n          TableGeometry.pockets.pocketNE.knuckleNW.pos.x,\r\n          futurePosition\r\n        ) ||\r\n        Cushion.willBounceShortSegment(\r\n          TableGeometry.pockets.pocketNW.knuckleSW.pos.y,\r\n          TableGeometry.pockets.pocketSW.knuckleNW.pos.y,\r\n          futurePosition\r\n        ))\r\n    )\r\n  }\r\n\r\n  static willBounceLongSegment(\r\n    left,\r\n    right,\r\n    futurePosition\r\n  ) {\r\n    return (\r\n      futurePosition.x > left &&\r\n      futurePosition.x < right &&\r\n      Math.abs(futurePosition.y) > TableGeometry.tableY\r\n    )\r\n  }\r\n\r\n  static willBounceShortSegment(\r\n    top,\r\n    bottom,\r\n    futurePosition\r\n  ) {\r\n    return (\r\n      futurePosition.y > bottom &&\r\n      futurePosition.y < top &&\r\n      Math.abs(futurePosition.x) > TableGeometry.tableX\r\n    )\r\n  }\r\n\r\n  static bounce(ball, t) {\r\n    let futurePosition = ball.futurePosition(t)\r\n    if (futurePosition.x > TableGeometry.tableX) {\r\n      Cushion.bounceIn(0, ball)\r\n    }\r\n    if (futurePosition.x < -TableGeometry.tableX) {\r\n      Cushion.bounceIn(Math.PI, ball)\r\n    }\r\n    if (futurePosition.y > TableGeometry.tableY) {\r\n      Cushion.bounceIn(-Math.PI / 2, ball)\r\n    }\r\n    if (futurePosition.y < -TableGeometry.tableY) {\r\n      Cushion.bounceIn(Math.PI / 2, ball)\r\n    }\r\n  }\r\n\r\n  static bounceIn(rotation, ball) {\r\n    let dv = new Vector3()\r\n    let dw = new Vector3()\r\n    rotateApplyUnrotate(\r\n      rotation,\r\n      ball.vel,\r\n      ball.rvel,\r\n      dv,\r\n      dw,\r\n      bounceWithoutSlipX\r\n    )\r\n    ball.vel.add(dv)\r\n    ball.rvel.add(dw)\r\n  }\r\n}\r\n","import { Ball } from \"../ball\"\r\nimport { norm } from \"../../utils/utils\"\r\n\r\nexport class Collision {\r\n  static willCollide(a, b, t) {\r\n    return (\r\n      a.onTable() &&\r\n      b.onTable() &&\r\n      a.futurePosition(t).distanceTo(b.futurePosition(t)) < 1\r\n    )\r\n  }\r\n\r\n  static collide(a, b) {\r\n    Collision.updateVelocities(a, b)\r\n  }\r\n\r\n  static updateVelocities(a, b) {\r\n    const ab = norm(b.pos.clone().sub(a.pos))\r\n    let aDotCenters = ab.dot(a.vel)\r\n    let bDotCenters = ab.dot(b.vel)\r\n    a.vel.addScaledVector(ab, bDotCenters).addScaledVector(ab, -aDotCenters)\r\n    b.vel.addScaledVector(ab, aDotCenters).addScaledVector(ab, -bDotCenters)\r\n  }\r\n}\r\n","import { TableGeometry } from \"./tablegeometry\"\r\nimport { Table } from \"../model/table\"\r\nimport {\r\n  Math as Math2,\r\n  Matrix4,\r\n  Mesh,\r\n  CylinderGeometry,\r\n  MeshPhongMaterial,\r\n  Raycaster,\r\n  Vector3\r\n} from \"three\"\r\nimport { up, upCross } from \"../utils/utils\"\r\nimport { AimEvent } from \"../events/aimevent\"\r\n\r\nexport class Cue {\r\n  mesh\r\n  limit = 0.4\r\n  maxPower = 5.0\r\n\r\n  aim = new AimEvent()\r\n\r\n  length = TableGeometry.tableX * 1\r\n\r\n  static material = new MeshPhongMaterial({\r\n    color: 0x885577,\r\n    wireframe: false,\r\n    flatShading: false\r\n  })\r\n\r\n  constructor() {\r\n    this.initialise(0.05, 0.15, this.length)\r\n  }\r\n\r\n  initialise(tip, but, length) {\r\n    var geometry = new CylinderGeometry(tip, but, length, 16)\r\n    this.mesh = new Mesh(geometry, Cue.material)\r\n    this.mesh.castShadow = true\r\n    this.mesh.geometry\r\n      .applyMatrix(\r\n        new Matrix4()\r\n          .identity()\r\n          .makeRotationAxis(new Vector3(1.0, 0.0, 0.0), -0.1)\r\n      )\r\n      .applyMatrix(new Matrix4().identity().makeRotationAxis(up, -Math.PI / 2))\r\n      .applyMatrix(\r\n        new Matrix4().identity().makeTranslation(-length / 2 - 1, 0, 1)\r\n      )\r\n    this.mesh.rotation.z = this.aim.angle\r\n  }\r\n\r\n  rotateAim(angle) {\r\n    this.aim.angle += angle\r\n    this.aim.dir.applyAxisAngle(up, angle)\r\n    this.mesh.rotation.z = this.aim.angle\r\n  }\r\n\r\n  adjustHeight(delta) {\r\n    this.aim.verticalOffset = Math2.clamp(\r\n      this.aim.verticalOffset + delta,\r\n      -this.limit,\r\n      this.limit\r\n    )\r\n    this.mesh.position.z = this.aim.verticalOffset\r\n  }\r\n\r\n  adjustSide(delta) {\r\n    this.aim.sideOffset = Math2.clamp(\r\n      this.aim.sideOffset + delta,\r\n      -this.limit,\r\n      this.limit\r\n    )\r\n  }\r\n\r\n  adjustPower(delta) {\r\n    this.aim.power = Math.min(this.maxPower, this.aim.power + delta)\r\n  }\r\n\r\n  moveTo(pos) {\r\n    this.aim.pos.copy(pos)\r\n    this.mesh.rotation.z = this.aim.angle\r\n    let offset = upCross(this.aim.dir)\r\n      .multiplyScalar(this.aim.sideOffset)\r\n      .setZ(this.aim.verticalOffset)\r\n    let swing = this.aim.dir.clone().multiplyScalar(-this.aim.power / 2)\r\n    this.mesh.position.copy(\r\n      pos\r\n        .clone()\r\n        .add(offset)\r\n        .add(swing)\r\n    )\r\n  }\r\n\r\n  update(_) {\r\n    this.moveTo(this.aim.pos)\r\n  }\r\n\r\n  intersectsAnything(table) {\r\n    let origin = table.balls[0].pos\r\n      .clone()\r\n      .addScaledVector(this.aim.dir, -this.length / 2)\r\n    origin.z = this.aim.verticalOffset\r\n    let direction = this.aim.dir.clone().normalize()\r\n    let raycaster = new Raycaster(origin, direction, 0, this.length / 2 - 0.6)\r\n    let intersections = raycaster.intersectObjects(\r\n      table.balls.map(b => b.mesh.mesh)\r\n    )\r\n    return intersections.length > 0\r\n  }\r\n}\r\n","import { Cushion } from \"./physics/cushion\"\r\nimport { Collision } from \"./physics/collision\"\r\nimport { Knuckle } from \"./physics/knuckle\"\r\nimport { Pocket } from \"./physics/pocket\"\r\nimport { Cue } from \"../view/cue\"\r\nimport { Ball } from \"./ball\"\r\nimport { AimEvent } from \"../events/aimevent\"\r\n\r\nexport class Table {\r\n  balls = []\r\n  cue = new Cue()\r\n  pairs\r\n  outcome = []\r\n\r\n  constructor(balls) {\r\n    this.initialiseBalls(balls)\r\n  }\r\n\r\n  initialiseBalls(balls) {\r\n    this.balls = balls\r\n    this.pairs = []\r\n    this.balls.forEach(a => {\r\n      this.balls.forEach(b => {\r\n        if (a != b) {\r\n          this.pairs.push({ a: a, b: b })\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  advance(t) {\r\n    let depth = 0\r\n    while (!this.prepareAdvanceAll(t)) {\r\n      if (depth++ > 100) {\r\n        throw new Error(\"Depth exceeded resolving collisions\")\r\n      }\r\n    }\r\n    this.balls.forEach(a => {\r\n      a.update(t)\r\n    })\r\n  }\r\n\r\n  prepareAdvanceAll(t) {\r\n    return !this.pairs.some(pair => !this.prepareAdvancePair(pair.a, pair.b, t))\r\n  }\r\n\r\n  prepareAdvancePair(a, b, t) {\r\n    if (Collision.willCollide(a, b, t)) {\r\n      Collision.collide(a, b)\r\n      this.outcome.push({ type: \"collision\", a: a, b: b })\r\n      return false\r\n    }\r\n    if (Cushion.willBounce(a, t)) {\r\n      Cushion.bounce(a, t)\r\n      this.outcome.push({ type: \"cushion\", a: a })\r\n      return false\r\n    }\r\n    let k = Knuckle.willBounceAny(a, t)\r\n    if (k) {\r\n      k.bounce(a)\r\n      this.outcome.push({ type: \"cushion\", a: a })\r\n      return false\r\n    }\r\n    let p = Pocket.willFallAny(a, t)\r\n    if (p) {\r\n      p.fall(a, t)\r\n      this.outcome.push({ type: \"pot\", a: a })\r\n      return false\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  allStationary() {\r\n    return this.balls.every(b => !b.inMotion() || !b.onTable())\r\n  }\r\n\r\n  serialise() {\r\n    return {\r\n      balls: this.balls.map(b => b.serialise()),\r\n      aim: this.cue.aim.copy()\r\n    }\r\n  }\r\n\r\n  static fromSerialised(data) {\r\n    let table = new Table(data.balls.map(b => Ball.fromSerialised(b)))\r\n    table.cue.aim = AimEvent.fromJson(data.aim)\r\n    return table\r\n  }\r\n\r\n  updateFromSerialised(data) {\r\n    this.balls.forEach((b, i) => Ball.updateFromSerialised(b, data.balls[i]))\r\n    this.cue.aim = AimEvent.fromJson(data.aim)\r\n  }\r\n}\r\n","import { PerspectiveCamera, Vector3 } from \"three\"\r\nimport { up, zero } from \"../utils/utils\"\r\nimport { AimEvent } from \"../events/aimevent\"\r\n\r\nexport class Camera {\r\n  constructor(aspectRatio) {\r\n    this.camera = new PerspectiveCamera(40, aspectRatio, 0.1, 10000000)\r\n  }\r\n\r\n  camera;\r\n  mode = this.topView\r\n\r\n  topViewPoint = new Vector3(0, -0.1, 30)\r\n\r\n  update(_, aim) {\r\n    this.mode(aim)\r\n  }\r\n\r\n  topView(_) {\r\n    this.camera.position.lerp(this.topViewPoint, 0.1)\r\n    this.camera.up = up\r\n    this.camera.lookAt(zero)\r\n  }\r\n\r\n  aimView(aim) {\r\n    this.camera.position.lerp(this.topViewPoint, 0.1)\r\n    this.camera.up = up\r\n    this.camera.lookAt(zero)\r\n    // this.camera.position.lerp(\r\n    //   aim.pos.clone().addScaledVector(aim.dir, -9),\r\n    //   0.07\r\n    // )\r\n    // this.camera.position.z = 2.7\r\n    // this.camera.up = up\r\n    // this.camera.lookAt(aim.pos)\r\n  }\r\n\r\n  afterHitView(cueBallPos) {\r\n    this.camera.position.addScaledVector(up, 0.01)\r\n    this.camera.up = up\r\n    this.camera.lookAt(cueBallPos)\r\n  }\r\n}\r\n","import {\r\n  AmbientLight,\r\n  DirectionalLight,\r\n  PCFSoftShadowMap,\r\n  Scene,\r\n  WebGLRenderer\r\n} from \"three\"\r\nimport { Camera } from \"./camera\"\r\nimport { TableGeometry } from \"./tablegeometry\"\r\nimport { AimEvent } from \"../events/aimevent\"\r\n\r\nexport class View {\r\n  scene = new Scene()\r\n  renderer;\r\n  camera;\r\n\r\n  constructor(element) {\r\n    if (element !== undefined) {\r\n      this.renderer = new WebGLRenderer()\r\n      this.initialiseScene(element, element.offsetWidth, element.offsetHeight)\r\n      this.addCamera(element.offsetWidth, element.offsetHeight)\r\n    } else {\r\n      this.addCamera(1, 1)\r\n    }\r\n    this.addLights()\r\n    this.addTable()\r\n  }\r\n\r\n  update(t, aim) {\r\n    this.camera.update(t, aim)\r\n  }\r\n\r\n  render() {\r\n    this.renderer.render(this.scene, this.camera.camera)\r\n  }\r\n\r\n  initialiseScene(element, width, height) {\r\n    this.renderer.setSize(width, height)\r\n    this.renderer.shadowMap.enabled = true\r\n    this.renderer.shadowMap.type = PCFSoftShadowMap\r\n    element.appendChild(this.renderer.domElement)\r\n  }\r\n\r\n  addCamera(width, height) {\r\n    this.camera = new Camera(width / height)\r\n  }\r\n\r\n  addLights() {\r\n    let s = 1.3\r\n    let light = new DirectionalLight(0xffffff, 1.0)\r\n    light.position.set(0.1, -0.01, 10)\r\n    light.shadow.camera.near = 4\r\n    light.shadow.camera.far = 12\r\n    light.shadow.camera.right = TableGeometry.X * s\r\n    light.shadow.camera.left = -TableGeometry.X * s\r\n    light.shadow.camera.top = TableGeometry.Y * s\r\n    light.shadow.camera.bottom = -TableGeometry.Y * s\r\n    light.shadow.mapSize.width = 1024\r\n    light.shadow.mapSize.height = 1024\r\n    light.castShadow = true\r\n    this.scene.add(light)\r\n    this.scene.add(new AmbientLight(0x505050, 1.0))\r\n  }\r\n\r\n  addTable() {\r\n    TableGeometry.addToScene(this.scene)\r\n  }\r\n\r\n  addMesh(mesh) {\r\n    this.scene.add(mesh)\r\n  }\r\n}\r\n","import { Ball } from \"../model/ball\"\r\nimport { TableGeometry } from \"../view/tablegeometry\"\r\nimport { Vector3 } from \"three\"\r\n\r\nexport class Rack {\r\n  static noise = 0.02\r\n  static gap = 1.0 + 2 * Rack.noise\r\n  static up = new Vector3(0, 0, -1)\r\n\r\n  static jitter(pos) {\r\n    return pos\r\n      .clone()\r\n      .add(\r\n        new Vector3(\r\n          Rack.noise * (Math.random() - 0.5),\r\n          Rack.noise * (Math.random() - 0.5),\r\n          0\r\n        )\r\n      )\r\n  }\r\n\r\n  static cueBall() {\r\n    return new Ball(new Vector3(-11, 0.0, 0))\r\n  }\r\n\r\n  static diamond() {\r\n    let across = new Vector3(0, Rack.gap, 0)\r\n    let diagonal = across.clone().applyAxisAngle(Rack.up, (Math.PI * 1) / 3)\r\n    let pos = new Vector3(TableGeometry.tableX / 2, 0, 0)\r\n    let diamond = []\r\n    \r\n    diamond.push(Rack.cueBall())\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.add(diagonal)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.sub(across)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.add(diagonal)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.sub(across)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.add(across)\r\n    pos.add(across)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.add(diagonal).sub(across)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.sub(across)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    pos.add(diagonal)\r\n    diamond.push(new Ball(Rack.jitter(pos)))\r\n    return diamond\r\n  }\r\n\r\n  static cushion3() {\r\n    let across = new Vector3(0, Rack.gap, 0)\r\n    let diagonal = across.clone().applyAxisAngle(Rack.up, (Math.PI * 1) / 3)\r\n    let pos = new Vector3(TableGeometry.tableX / 2, 0, 0)\r\n    let cushion3 = []\r\n    \r\n    cushion3.push(Rack.cueBall())\r\n\r\n    cushion3.push(new Ball(Rack.jitter(pos)))\r\n    \r\n    pos.add(diagonal).sub(across)\r\n    cushion3.push(new Ball(Rack.jitter(pos)))\r\n    return cushion3\r\n  }\r\n}\r\n","import { Input } from \"../events/input\"\r\nimport { GameEvent } from \"../events/gameevent\"\r\nimport { StationaryEvent } from \"../events/stationaryevent\"\r\nimport { Controller } from \"./controller\"\r\nimport { Table } from \"../model/table\"\r\nimport { View } from \"../view/view\"\r\nimport { Init } from \"./init\"\r\nimport { Rack } from \"../utils/rack\"\r\n\r\n/**\r\n * Model, View, Controller container.\r\n */\r\nexport class Container {\r\n  table\r\n  view\r\n  controller\r\n\r\n  inputQueue = []\r\n  eventQueue = []\r\n\r\n  last = performance.now()\r\n  step = 0.01\r\n\r\n  broadcast;\r\n  log;\r\n\r\n  constructor(element, log) {\r\n    this.log = log\r\n    this.table = new Table(Rack.cushion3())\r\n    this.view = new View(element)\r\n    this.table.balls.forEach(b => this.view.addMesh(b.mesh.mesh))\r\n    this.view.addMesh(this.table.cue.mesh)\r\n    this.updateController(new Init(this))\r\n  }\r\n\r\n  sendEvent() {\r\n  }\r\n\r\n  advance(elapsed) {\r\n    let steps = Math.max(15, Math.floor(elapsed / this.step))\r\n    let stateBefore = this.table.allStationary()\r\n    for (var i = 0; i < steps; i++) {\r\n      this.table.advance(this.step)\r\n    }\r\n    this.view.update(steps * this.step, this.table.cue.aim)\r\n    this.table.cue.update(steps * this.step)\r\n    if (!stateBefore && this.table.allStationary()) {\r\n      // transitioned to all all stationary\r\n      this.eventQueue.push(new StationaryEvent())\r\n    }\r\n  }\r\n\r\n  processEvents() {\r\n    let input = this.inputQueue.shift()\r\n    input && this.updateController(this.controller.handleInput(input))\r\n    let event = this.eventQueue.shift()\r\n    event && this.updateController(event.applyToController(this.controller))\r\n  }\r\n\r\n  animate(timestamp) {\r\n    this.advance((timestamp - this.last) / 1000.0)\r\n    this.view.render()\r\n    this.last = timestamp\r\n\r\n    this.processEvents()\r\n\r\n    requestAnimationFrame(t => {\r\n      this.animate(t)\r\n    })\r\n  }\r\n\r\n  updateController(controller) {\r\n    if (controller != this.controller) {\r\n      this.log(\"Transition to \" + controller.constructor.name)\r\n    }\r\n    this.controller = controller\r\n  }\r\n}\r\n","import { BeginEvent } from \"../events/beginevent\"\r\nimport { AimEvent } from \"../events/aimevent\"\r\nimport { HitEvent } from \"../events/hitevent\"\r\nimport { Input } from \"../events/input\"\r\nimport { AbortEvent } from \"../events/abortevent\"\r\nimport { WatchEvent } from \"../events/watchevent\"\r\nimport { StationaryEvent } from \"../events/stationaryevent\"\r\nimport { Container } from \"./container\"\r\n\r\nexport { BeginEvent, AimEvent, HitEvent, Input, AbortEvent, StationaryEvent }\r\n\r\n/**\r\n * Controller manages the state of the system reacting input and network events in the animation loop.\r\n */\r\nexport class Controller {\r\n  container\r\n\r\n  constructor(container) {\r\n    this.container = container\r\n  }\r\n\r\n  handleInput(_) {\r\n    return this\r\n  }\r\n  handleBegin(_) {\r\n    return this\r\n  }\r\n  handleAim(_) {\r\n    return this\r\n  }\r\n  handleHit(_) {\r\n    return this\r\n  }\r\n  handleAbort(_) {\r\n    return this\r\n  }\r\n  handleWatch(_) {\r\n    return this\r\n  }\r\n  handleStationary(_: StationaryEvent) {\r\n    return this\r\n  }\r\n}\r\n","import { GameEvent } from \"./gameevent\"\r\nimport { EventType } from \"./eventtype\"\r\nimport { Controller } from \"../controller/controller\"\r\n\r\nexport class BeginEvent extends GameEvent {\r\n  constructor() {\r\n    super()\r\n    this.type = EventType.BEGIN\r\n  }\r\n\r\n  applyToController(controller) {\r\n    return controller.handleBegin(this)\r\n  }\r\n}\r\n","import { Controller } from \"./controller\"\r\n\r\nexport class End extends Controller {}\r\n","import { Controller } from \"./controller\"\r\nimport { AbortEvent } from \"../events/abortevent\"\r\nimport { AimEvent } from \"../events/aimevent\"\r\nimport { HitEvent } from \"../events/hitevent\"\r\nimport { End } from \"./end\"\r\nimport { PlayShot } from \"./playshot\"\r\n\r\nexport class WatchAim extends Controller {\r\n  scale = 0.000001\r\n\r\n  constructor(container) {\r\n    super(container)\r\n    this.container.table.cue.moveTo(this.container.table.balls[0].pos)\r\n    this.container.view.camera.mode = this.container.view.camera.topView\r\n  }\r\n\r\n  handleAim(event) {\r\n    this.container.table.cue.aim = event\r\n    return this\r\n  }\r\n\r\n  handleHit(event) {\r\n    this.container.table.updateFromSerialised(event.json)\r\n    return new PlayShot(this.container, true)\r\n  }\r\n\r\n  handleAbort(_) {\r\n    return new End(this.container)\r\n  }\r\n}\r\n","import { Controller } from \"./controller\"\r\nimport { AbortEvent } from \"../events/abortevent\"\r\n// import { WatchEvent } from \"../events/watchevent\"\r\nimport { Aim } from \"./aim\"\r\nimport { End } from \"./end\"\r\nimport { upCross } from \"../utils/utils\"\r\nimport { WatchAim } from \"./watchaim\"\r\n\r\n/**\r\n * PlayShot starts balls rolling using cue state.\r\n *\r\n */\r\nexport class PlayShot extends Controller {\r\n  isWatch\r\n  allStationary = false\r\n  pendingState\r\n\r\n  constructor(container, isWatch) {\r\n    super(container)\r\n    this.isWatch = isWatch\r\n    this.container.table.outcome = []\r\n    this.hit()\r\n  }\r\n\r\n  handleAim(_) {\r\n    if (this.allStationary) {\r\n      this.container.log(\"all stationary so transition to Aim now\")\r\n      return new Aim(this.container)\r\n    }\r\n    this.container.log(\"pending transition to Aim\")\r\n    this.pendingState = new Aim(this.container)\r\n    return this\r\n  }\r\n\r\n  handleWatch(_) {\r\n    if (this.allStationary) {\r\n      this.container.log(\"all stationary so transition to WatchAim now\")\r\n      return new WatchAim(this.container)\r\n    }\r\n    this.container.log(\"pending transition to WatchAim\")\r\n    this.pendingState = new WatchAim(this.container)\r\n    return this\r\n  }\r\n\r\n  handleStationary(_) {\r\n    this.allStationary = true\r\n    // this.container.log(\"stationary event\")\r\n    // if (this.isWatch) {\r\n    //   if (this.pendingState) {\r\n    //     this.container.log(\"go to pending state now\")\r\n    //     return this.pendingState\r\n    //   }\r\n    //   this.container.log(\"no pending state\")\r\n    //   return this\r\n    // }\r\n    // if (this.container.table.outcome.some(x => x.type == \"pot\")) {\r\n    //   this.container.log(\"pot! transition to Aim\")\r\n    //   // this.container.sendEvent(new WatchEvent(this.container.table.serialise()))\r\n    //   return new Aim(this.container)\r\n    // }\r\n    // // if no pot switch to other player\r\n    // this.container.log(\"no pot\")\r\n    // // this.container.sendEvent(this.container.table.cue.aim)\r\n    // // return new WatchAim(this.container)\r\n    return new Aim(this.container)\r\n  }\r\n\r\n  handleAbort(_) {\r\n    return new End(this.container)\r\n  }\r\n\r\n  hit() {\r\n    let table = this.container.table\r\n    let aim = table.cue.aim\r\n    console.log(aim);\r\n    table.balls[0].vel.copy(aim.dir.clone().multiplyScalar(aim.power))\r\n    console.log(upCross(aim.dir))\r\n    let rvel = upCross(aim.dir).multiplyScalar(\r\n      (aim.power * aim.verticalOffset * 5) / 2\r\n    )\r\n    rvel.z = (-aim.sideOffset * 5) / 2\r\n    table.balls[0].rvel.copy(rvel)\r\n    table.cue.aim.power = 0\r\n  }\r\n}\r\n","import { Controller, Input, AbortEvent } from \"./controller\"\r\nimport { PlayShot } from \"./playshot\"\r\nimport { End } from \"./end\"\r\n\r\n/**\r\n * Aim using input events.\r\n *\r\n * Transitions to PlayShot.\r\n * Game events are ignored besides chat and abort messages.\r\n */\r\nexport class Aim extends Controller {\r\n  scale = 0.001\r\n\r\n  constructor(container) {\r\n    super(container)\r\n    this.container.table.cue.moveTo(this.container.table.balls[0].pos)\r\n    this.container.table.cue.aim.power = 0\r\n    this.container.view.camera.mode = this.container.view.camera.aimView\r\n  }\r\n\r\n  handleInput(input) {\r\n    switch (input.key) {\r\n      case \"ArrowLeft\":\r\n        this.container.table.cue.rotateAim(-input.t * this.scale)\r\n        break\r\n      case \"ArrowRight\":\r\n        this.container.table.cue.rotateAim(input.t * this.scale)\r\n        break\r\n      case \"ArrowDown\":\r\n        this.container.table.cue.adjustHeight(-input.t * this.scale)\r\n        break\r\n      case \"ArrowUp\":\r\n        this.container.table.cue.adjustHeight(input.t * this.scale)\r\n        break\r\n      case \"ShiftArrowLeft\":\r\n        this.container.table.cue.adjustSide(input.t * this.scale)\r\n        break\r\n      case \"ShiftArrowRight\":\r\n        this.container.table.cue.adjustSide(-input.t * this.scale)\r\n        break\r\n      case \"Space\":\r\n        this.container.table.cue.adjustPower(input.t * this.scale * 3)\r\n        break\r\n      case \"SpaceUp\":\r\n        return this.hit()\r\n      default:\r\n        return this\r\n    }\r\n    return this\r\n  }\r\n\r\n  hit() {\r\n    return new PlayShot(this.container, false)\r\n  }\r\n\r\n  handleAbort(_) {\r\n    return new End(this.container)\r\n  }\r\n}\r\n","import { BeginEvent } from \"../events/beginevent\"\r\nimport { WatchEvent } from \"../events/watchevent\"\r\nimport { Controller } from \"./controller\"\r\nimport { Aim } from \"./aim\"\r\nimport { WatchAim } from \"./watchaim\"\r\nimport { AbortEvent } from \"../events/abortevent\"\r\nimport { End } from \"./end\"\r\n\r\n/**\r\n * Initial state of controller.\r\n *\r\n * Transitions into active player and watcher.\r\n */\r\nexport class Init extends Controller {\r\n  handleBegin(_) {\r\n    // this.container.sendEvent(new WatchEvent(this.container.table.serialise()))\r\n    return new Aim(this.container)\r\n  }\r\n\r\n  handleAbort(_) {\r\n    return new End(this.container)\r\n  }\r\n\r\n  handleWatch(event) {\r\n    this.container.table.updateFromSerialised(event.json)\r\n    return new WatchAim(this.container)\r\n  }\r\n}\r\n","import { Input } from \"./input\"\r\n\r\n/**\r\n * Maintains a map of pressed keys.\r\n *\r\n * Produces events while key is pressed.\r\n */\r\nexport class Keyboard {\r\n  pressed = {}\r\n  released = {}\r\n\r\n  getEvents(t) {\r\n    let keys = Object.keys(this.pressed)\r\n      .filter(key => !/.*Shift.*/.test(key))\r\n      .filter(key => !/.*Control.*/.test(key))\r\n    let shift = Object.keys(this.pressed).some(key => /.*Shift.*/.test(key))\r\n    let control = Object.keys(this.pressed).some(key => /.*Control.*/.test(key))\r\n    let result = keys.map(\r\n      key => new Input(control ? t / 3 : t, shift ? \"Shift\" + key : key)\r\n    )\r\n    Object.keys(this.released).forEach(key =>\r\n      result.push(new Input(t, key + \"Up\"))\r\n    )\r\n    this.released = {}\r\n    return result\r\n  }\r\n\r\n  constructor() {\r\n    this.addHandlers()\r\n  }\r\n\r\n  keydown = e => {\r\n    e = e || window.event\r\n    this.pressed[e.code] = true\r\n    e.stopImmediatePropagation()\r\n  }\r\n\r\n  keyup = e => {\r\n    e = e || window.event\r\n    delete this.pressed[e.code]\r\n    this.released[e.code] = true\r\n    e.stopImmediatePropagation()\r\n  }\r\n\r\n  addHandlers() {\r\n    document.addEventListener(\"keydown\", this.keydown)\r\n    document.addEventListener(\"keyup\", this.keyup)\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nimport { Engine, Scene } from 'react-babylonjs';\r\n\r\nimport './styles.css';\r\n\r\nimport SceneManager from './sceneManager';\r\nimport { Container, BeginEvent, Keyboard } from './simulator';\r\n\r\nclass SimulatorEngine extends React.Component {\r\n    constructor (props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            showPath: false,\r\n        }\r\n\r\n        this.board = new SceneManager(\r\n            this.props.size,\r\n            this.props.modelStorePath,\r\n            this.props.currentView,\r\n            {\r\n                posCueBallWhite: {\r\n                    x: this.props.posCueBallWhite.x,\r\n                    z: this.props.posCueBallWhite.z\r\n                },\r\n                posCueBallYellow: {\r\n                    x: this.props.posCueBallYellow.x,\r\n                    z: this.props.posCueBallYellow.z\r\n                },\r\n                posTargetBall: {\r\n                    x: this.props.posTargetBall.x,\r\n                    z: this.props.posTargetBall.z\r\n                }\r\n            },\r\n            {\r\n                cueLine: this.props.cueLine,\r\n                cueAngle: this.props.cueAngle,\r\n                sideEnglish: this.props.sideEnglish,\r\n                topSpin: this.props.topSpin,\r\n                speed: this.props.speed,\r\n            }\r\n        );\r\n\r\n        this.simulatorDom = new React.createRef();\r\n    }\r\n\r\n    meshPicked = ( mesh ) => {\r\n        // console.log('mesh picked', mesh);\r\n    }\r\n\r\n    drawBallPath = (value) => {\r\n        this.board.drawBallPath(value);\r\n    }\r\n\r\n    onSceneMount = ( e ) => {\r\n        const { canvas, scene } = e;\r\n        this.board.initializeScene(scene, canvas);\r\n    }\r\n\r\n    changeView (option) {\r\n        this.board.changeView(option);\r\n    }\r\n\r\n    toggleGrids = (visible) => {\r\n        this.board.toggleGrids(visible);\r\n    }\r\n\r\n    playSimulation = () => {\r\n        this.board.playSimulation();\r\n    }\r\n\r\n    updateControlOptions = (data) => {\r\n        this.board.updateControlOptions(data);\r\n    }\r\n\r\n    componentDidMount = () => {\r\n        console.log(this.simulatorDom.current);\r\n        var controller1 = new Container(\r\n            this.simulatorDom.current,\r\n            text => {})\r\n\r\n        controller1.eventQueue.push(new BeginEvent())\r\n\r\n        var keyboard = new Keyboard()\r\n\r\n        var lastTime = performance.now()\r\n\r\n        function sampleInputs() {\r\n            var t = performance.now() - lastTime\r\n            lastTime = performance.now()\r\n            var inputs = keyboard.getEvents(t)\r\n            inputs.forEach(i => controller1.inputQueue.push(i))\r\n            requestAnimationFrame(t => {\r\n                sampleInputs()\r\n            })\r\n        }\r\n        sampleInputs()\r\n        controller1.animate(performance.now())\r\n    }\r\n    render () {\r\n        return (\r\n            <div ref={this.simulatorDom} style={{height:'100%', width:'100%', display:'block'}}></div>\r\n            // <Engine canvasId=\"carom-simulator-canvas\">\r\n            //     <Scene\r\n            //         onMeshPicked={this.meshPicked}\r\n            //         onSceneMount={this.onSceneMount}\r\n            //     />\r\n            // </Engine>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SimulatorEngine;","import React from 'react'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faMinus, faPlus } from '@fortawesome/free-solid-svg-icons'\r\n\r\nimport './slider.css';\r\n\r\nexport default class InputSlider extends React.Component {\r\n    constructor (props) {\r\n        super(props);\r\n        this.state = {\r\n            value: this.props.value?this.props.value:0\r\n        }\r\n    }\r\n\r\n    componentWillReceiveProps = (props) => {\r\n        const {value} = props;\r\n        this.setState({value:value});\r\n    }\r\n\r\n    updateValue = (value) => {\r\n        this.setState({value:value})\r\n        this.props.onUpdate(this.props.itemKey, value);\r\n    }\r\n\r\n    onChangeValue = (evt) => {\r\n        const value = evt.target.value;\r\n        this.updateValue(value);\r\n    }\r\n\r\n    onMinusPressed = () => {\r\n        var currentValue = this.state.value;\r\n        let { min, step } = this.props;\r\n        if (step === undefined) step = 0.1;\r\n        step *= 10;\r\n        currentValue = (currentValue*10 - step)/10;\r\n        if (currentValue <  min) currentValue = min;\r\n        this.updateValue(currentValue);\r\n    }\r\n\r\n    onPlusPressed = () => {\r\n        var currentValue = this.state.value;\r\n        let { max, step } = this.props;\r\n        if (step === undefined) step = 0.1;\r\n        step *= 10;\r\n        currentValue = (currentValue*10 + step)/10;\r\n        if (currentValue > max) currentValue = max;\r\n        this.updateValue(currentValue);\r\n    }\r\n\r\n    render () {\r\n        const {\r\n            value,\r\n        } = this.state;\r\n\r\n        let {\r\n            containerClass,\r\n            label,\r\n            min,\r\n            max,\r\n            unitDom,\r\n            step\r\n        } = this.props\r\n        if (step === undefined) step = 0.1;\r\n        return (\r\n            <div className={containerClass}>\r\n                <div style={{display:'flex'}}>\r\n                    <FontAwesomeIcon\r\n                        icon={faMinus}\r\n                        className=\"btn-change-value\"\r\n                        onClick={this.onMinusPressed}\r\n                    />\r\n                    <span style={{flex:1, textAlign:'center'}}>\r\n                        {label}\r\n                        <span> : {value}{unitDom}</span>\r\n                    </span>\r\n                    <FontAwesomeIcon\r\n                        icon={faPlus}\r\n                        className=\"btn-change-value\"\r\n                        onClick={this.onPlusPressed}\r\n                    />\r\n                </div>\r\n                <input\r\n                    type=\"range\"\r\n                    min={min}\r\n                    max={max}\r\n                    value={value}\r\n                    className=\"slider\"\r\n                    step={step}\r\n                    onChange={this.onChangeValue}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\n\r\nimport ViewSelector from './viewSelector';\r\nimport SimulatorEngine from './simulatorEngine';\r\nimport ControllerCollection from './controller';\r\n\r\nimport './styles.css';\r\n\r\nimport {\r\n    INDEX_SIZE,\r\n    INDEX_WHITE_X,\r\n    INDEX_WHITE_Y,\r\n    INDEX_YELLOW_X,\r\n    INDEX_YELLOW_Y,\r\n    INDEX_TARGET_X,\r\n    INDEX_TARGET_Y,\r\n    INDEX_CUELINE,\r\n    INDEX_CUEANGLE,\r\n    INDEX_SIDEENGLISH,\r\n    INDEX_TOPSPIN,\r\n    INDEX_SPEED\r\n} from './constants';\r\n\r\nclass CaromSimulator extends React.Component {\r\n    constructor () {\r\n        super();\r\n\r\n        this.state = {\r\n            currentView : '2d',\r\n            showGrid : true,\r\n            showPath: false,\r\n            size: 310,\r\n            cueLine: 30,\r\n            cueAngle: 5,\r\n            sideEnglish: -8.7,\r\n            topSpin: 7.5,\r\n            speed: 380,\r\n            posCueBallWhite: {},\r\n            posCueBallYellow: {},\r\n            posTargetBall: {}\r\n        }\r\n        this.simulator = React.createRef();\r\n    }\r\n    componentWillMount = () => {\r\n        this.updateSimulateInfo();\r\n    }\r\n    updateSimulateInfo = () => {\r\n        var info = [\r\n            'Santiago  Soto Sanchez',\r\n            '...',\r\n            '0',\r\n            '310',\r\n            '2',\r\n            '1',\r\n            '1.1661666666666661',\r\n            '0.6288333333333332',\r\n            '0.8181666666666672',\r\n            '0.5041666666666665',\r\n            '-0.6036666666666667',\r\n            '-0.003833333333333161',\r\n            '4.015999999999998',\r\n            '0.520497057626843',\r\n            '0.21066799020683835',\r\n            '-0.0013500000000002585',\r\n            '-0.0146999999999997',\r\n        ];\r\n        let size = 2.8;\r\n\r\n        let cueLine = parseFloat(info[INDEX_CUELINE]);\r\n\r\n        let cueAngle = parseFloat(info[INDEX_CUEANGLE]);\r\n\r\n        let sideEnglish = parseFloat(info[INDEX_SIDEENGLISH]);\r\n\r\n        let topSpin = parseFloat(info[INDEX_TOPSPIN]);\r\n\r\n        let speed = parseFloat(info[INDEX_SPEED]);\r\n\r\n        let posCueBallWhite = {\r\n            x: parseFloat(info[INDEX_WHITE_X]),\r\n            z: parseFloat(info[INDEX_WHITE_Y])\r\n        }\r\n\r\n        let posCueBallYellow = {\r\n            x: parseFloat(info[INDEX_YELLOW_X]),\r\n            z: parseFloat(info[INDEX_YELLOW_Y])\r\n        }\r\n\r\n        let posTargetBall = {\r\n            x: parseFloat(info[INDEX_TARGET_X]),\r\n            z: parseFloat(info[INDEX_TARGET_Y])\r\n        }\r\n\r\n        let tmp = {\r\n            size: size,\r\n            cueLine: cueLine,\r\n            cueAngle: cueAngle,\r\n            sideEnglish: sideEnglish,\r\n            topSpin: topSpin,\r\n            speed: speed,\r\n            posCueBallWhite: posCueBallWhite,\r\n            posCueBallYellow: posCueBallYellow,\r\n            posTargetBall: posTargetBall\r\n        }\r\n\r\n        this.setState(tmp)\r\n    }\r\n\r\n    viewSelectorItemClicked = (item) => {\r\n        this.setState({currentView: item});\r\n        this.simulator.current.changeView(item);\r\n    }\r\n\r\n    onToggleShowGrid = (value) => {\r\n        this.setState({showGrid: value})\r\n        this.simulator.current.toggleGrids(value);\r\n    }\r\n\r\n    onToggleShowPath = (value) => {\r\n        this.setState({showPath: value})\r\n        this.simulator.current.drawBallPath(value);\r\n    }\r\n\r\n    onPlayPressed = () => {\r\n        this.simulator.current.playSimulation();\r\n    }\r\n\r\n    onControlOptionsUpdated = (data) => {\r\n        this.simulator.current.updateControlOptions(data);\r\n    }\r\n\r\n    componentDidMount = () => {\r\n    }\r\n\r\n    render () {\r\n        const {\r\n            currentView,\r\n\r\n            showGrid,\r\n            showPath,\r\n\r\n            size,\r\n            cueLine,\r\n            cueAngle,\r\n            sideEnglish,\r\n            topSpin,\r\n            speed,\r\n\r\n            posCueBallWhite,\r\n            posCueBallYellow,\r\n            posTargetBall,\r\n        } = this.state;\r\n        return (\r\n            <div className=\"simulator-container\">\r\n                {/* <ViewSelector\r\n                    currentView={currentView}\r\n                    viewSelectorItemClicked={this.viewSelectorItemClicked}\r\n                /> */}\r\n                <SimulatorEngine\r\n                    modelStorePath={this.props.modelStorePath}\r\n                    ref={this.simulator}\r\n\r\n                    size={size}\r\n                    currentView={currentView}\r\n                    cueLine = {cueLine}\r\n                    cueAngle = {cueAngle}\r\n                    sideEnglish = {sideEnglish}\r\n                    topSpin = {topSpin}\r\n                    speed = {speed}\r\n\r\n                    posCueBallWhite = {posCueBallWhite}\r\n                    posCueBallYellow = {posCueBallYellow}\r\n                    posTargetBall = {posTargetBall}\r\n                />\r\n                {/* <ControllerCollection\r\n                    showGrid={showGrid}\r\n                    showPath={showPath}\r\n                    cueLine = {cueLine}\r\n                    cueAngle = {cueAngle}\r\n                    sideEnglish = {sideEnglish}\r\n                    topSpin = {topSpin}\r\n                    speed = {speed}\r\n\r\n                    onControlOptionsUpdated={this.onControlOptionsUpdated}\r\n\r\n                    onToggleShowGrid={this.onToggleShowGrid}\r\n                    onToggleShowPath = {this.onToggleShowPath}\r\n                    onPlayPressed = {this.onPlayPressed}\r\n                /> */}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default CaromSimulator;","import React from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport {\r\n    faTh,\r\n    faCrosshairs,\r\n    faVolumeMute,\r\n    faBackward,\r\n    faForward,\r\n    faStop,\r\n    faPlay\r\n} from '@fortawesome/free-solid-svg-icons'\r\n\r\nimport InputSlider from './slider';\r\nimport './style.css';\r\n\r\nexport default class ControllerCollection extends React.Component {\r\n    constructor (props) {\r\n        super(props);\r\n        this.state = {\r\n            cueLine: Math.round(1800 * this.props.cueLine / Math.PI) / 10,\r\n            cueAngle: Math.round(1800 * this.props.cueAngle / Math.PI) / 10,\r\n            sideEnglish: Math.round(this.props.sideEnglish * 10000) / 10,\r\n            topSpin: Math.round(this.props.topSpin * 10000) / 10,\r\n            speed: Math.round(this.props.speed * 100)\r\n        }\r\n    }\r\n\r\n    onInputSliderUpdated = (key, value) => {\r\n        let tmp = Object.assign({}, this.state);\r\n        tmp[key] = parseFloat(value);\r\n        this.setState(tmp);\r\n        let eventValues = Object.assign({}, tmp);\r\n\r\n        eventValues.cueLine = Math.PI * tmp.cueLine / 180;\r\n        eventValues.cueAngle = Math.PI * tmp.cueAngle / 180;\r\n        eventValues.sideEnglish /= 1000;\r\n        eventValues.topSpin /= 1000;\r\n        eventValues.speed /= 100;\r\n        this.props.onControlOptionsUpdated(eventValues);\r\n    }\r\n\r\n    render () {\r\n        const {cueLine, cueAngle, sideEnglish, topSpin, speed} = this.state;\r\n        const {showGrid, showPath} = this.props;\r\n        var btnGridClass = \"toggle-btn\";\r\n        var btnShowPathClass = \"toggle-btn\";\r\n        var btnMuteClass = \"toggle-btn\";\r\n\r\n        if (showGrid === true) btnGridClass += \" active\";\r\n        if (showPath === true) btnShowPathClass += \" active\";\r\n        return (\r\n            <div>\r\n                <div className=\"common-controller-container\">\r\n                    <FontAwesomeIcon\r\n                        className={btnGridClass}\r\n                        icon={faTh}\r\n                        onClick={() => {this.props.onToggleShowGrid(!showGrid)}}\r\n                    />\r\n\r\n                    <FontAwesomeIcon\r\n                        className={btnShowPathClass}\r\n                        icon={faCrosshairs}\r\n                        onClick={() => {this.props.onToggleShowPath(!showPath)}}\r\n                    />\r\n\r\n                    <FontAwesomeIcon\r\n                        className={btnMuteClass}\r\n                        icon={faVolumeMute}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <InputSlider\r\n                        label=\"Cue Line\"\r\n                        containerClass=\"slider-container\"\r\n                        min={0}\r\n                        max={360}\r\n                        value={cueLine}\r\n                        unitDom={<sup>o</sup>}\r\n                        itemKey=\"cueLine\"\r\n                        onUpdate={this.onInputSliderUpdated}\r\n                    />\r\n                    <InputSlider\r\n                        label=\"Cue Angle\"\r\n                        containerClass=\"slider-container\"\r\n                        min={2}\r\n                        max={89}\r\n                        value={cueAngle}\r\n                        unitDom={<sup>o</sup>}\r\n                        itemKey=\"cueAngle\"\r\n                        onUpdate={this.onInputSliderUpdated}\r\n                    />\r\n                    <br/>\r\n                    <InputSlider\r\n                        label=\"Side English\"\r\n                        containerClass=\"slider-container\"\r\n                        min={-15.1}\r\n                        max={15.1}\r\n                        value={sideEnglish}\r\n                        unitDom={<span>mm</span>}\r\n                        itemKey=\"sideEnglish\"\r\n                        onUpdate={this.onInputSliderUpdated}\r\n                    />\r\n                    <InputSlider\r\n                        label=\"Top Spin\"\r\n                        containerClass=\"slider-container\"\r\n                        min={-15.1}\r\n                        max={15.1}\r\n                        value={topSpin}\r\n                        unitDom={<span>mm</span>}\r\n                        itemKey=\"topSpin\"\r\n                        onUpdate={this.onInputSliderUpdated}\r\n                    />\r\n                    <InputSlider\r\n                        label=\"Speed\"\r\n                        containerClass=\"slider-container\"\r\n                        min={0}\r\n                        max={450}\r\n                        value={speed}\r\n                        step={1}\r\n                        unitDom={<span>cm/s</span>}\r\n                        itemKey=\"speed\"\r\n                        onUpdate={this.onInputSliderUpdated}\r\n                    />\r\n                </div>\r\n                <div className=\"play-controller-container\">\r\n                    <FontAwesomeIcon\r\n                        className=\"play-controller\"\r\n                        icon={faBackward}\r\n                    />\r\n                    <FontAwesomeIcon\r\n                        className=\"play-controller\"\r\n                        icon={faStop}\r\n                    />\r\n                    <FontAwesomeIcon\r\n                        className=\"play-controller\"\r\n                        icon={faPlay}\r\n                        onClick={this.props.onPlayPressed}\r\n                    />\r\n                    <FontAwesomeIcon\r\n                        className=\"play-controller\"\r\n                        icon={faForward}\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\nimport './App.css';\n\nimport { CaromSimulator } from './lib/kozoom-3d-simulator';\n\nfunction App() {\n  return (\n    <div className=\"simulator-container\">\n      <CaromSimulator\n        modelStorePath=\"./models/\"\n      />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}